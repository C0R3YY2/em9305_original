<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AES Cipher Block Chaining mode (CBC) &mdash; EM9305 CryptoLib 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="AES Counter mode(CTR)" href="AES_CTR.html" />
    <link rel="prev" title="AES Electronic Code Book mode (ECB)" href="AES_ECB.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="index.html" class="icon icon-home"> EM9305 CryptoLib
            <img src="_static/logoEM.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Architecture.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AES.html">AES (one block)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CryptoContainer.html">AES Crypto Containers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="AESModes.html">AES modes and MAC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AES_ECB.html">AES Electronic Code Book mode (ECB)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AES Cipher Block Chaining mode (CBC)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bibliography">Bibliography</a></li>
<li class="toctree-l3"><a class="reference internal" href="#goal-of-the-document">Goal of the document</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-cipher-block-chaining-mode-cbc">The Cipher Block Chaining mode (CBC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#underlying-aes">Underlying AES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis">APIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enumerations">Enumerations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#aes-type">AES Type</a></li>
<li class="toctree-l5"><a class="reference internal" href="#aes-key-size-in-bits">AES Key size in bits</a></li>
<li class="toctree-l5"><a class="reference internal" href="#explicit-key-or-key-container">Explicit key or key container</a></li>
<li class="toctree-l5"><a class="reference internal" href="#error-status">Error status</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aes-cbc-initctx">AES_CBC_InitCtx</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#goal-of-the-function">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#prototype">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#return-values">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-cbc-encrypt">AES_CBC_Encrypt</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id1">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id2">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id3">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id4">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-cbc-decrypt">AES_CBC_Decrypt</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id5">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id7">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id8">Return values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performances">Performances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#library-location">Library location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-size">Code size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ram">RAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack">Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-time">Execution time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AES_CTR.html">AES Counter mode(CTR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CMAC.html">AES CMAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CCM.html">AES CCM</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_GCM.html">AES GCM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PRNG.html">PRNG (Pseudo Random Number Generation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ECC_FUNCTIONS.html">ECC Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="HASH_FUNCTIONS.html">Hash functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EM9305 CryptoLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="AESModes.html">AES modes and MAC</a> &raquo;</li>
      <li>AES Cipher Block Chaining mode (CBC)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aes-cipher-block-chaining-mode-cbc">
<span id="aes-cbc-label"></span><h1>AES Cipher Block Chaining mode (CBC)<a class="headerlink" href="#aes-cipher-block-chaining-mode-cbc" title="Permalink to this headline"></a></h1>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline"></a></h2>
<p>[1] NIST SP 800-38A: Recommendation for Block Cipher Modes of Operation</p>
<p><a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST SP800-38A</a>: <a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf</a></p>
</section>
<section id="goal-of-the-document">
<h2>Goal of the document<a class="headerlink" href="#goal-of-the-document" title="Permalink to this headline"></a></h2>
<p>The goal of this chapter is to describe the functionality of the library <strong>AES CBC</strong>.</p>
<dl class="simple">
<dt>This chapter:</dt><dd><ul class="simple">
<li><p>describes the API, including the prototype, the parameters, the error codes etc…</p></li>
<li><p>provides the performances of the function.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="the-cipher-block-chaining-mode-cbc">
<h2>The Cipher Block Chaining mode (CBC)<a class="headerlink" href="#the-cipher-block-chaining-mode-cbc" title="Permalink to this headline"></a></h2>
<p>This library implements AES CBC algorithm according to the specification NIST SP 800-38A[1].</p>
<blockquote>
<div><ul class="simple">
<li><p>The CBC mode is a mode that encrypts or decrypts messages.</p></li>
<li><p>In encryption in CBC mode combines the plaintext blocks with the previous ciphertext blocks. Combination of blocks is performed with XOR operation.</p></li>
<li><p>The decryption in CBC is the reverse operation of the encryption. It involves combining ciphertext and decrypted blocks with XOR operation.</p></li>
<li><p>The CBC mode requires an initialization vector(IV) of 16 bytes to combine with the first plaintext block.</p></li>
</ul>
</div></blockquote>
<p>Next figure shows the encryption process. Each 16-byte block of plaintext is XORed with previous ciphertext and encrypted using AES in encryption mode.</p>
<img alt="_images/AES_CBC_Enc.png" src="_images/AES_CBC_Enc.png" />
<p>Next figure shows the decryption process. Each 16-byte block of ciphertext is decrypted and then XORed with the previous ciphertext to produce the plaintext block.</p>
<img alt="_images/AES_CBC_Dec.png" src="_images/AES_CBC_Dec.png" />
</section>
<section id="underlying-aes">
<h2>Underlying AES<a class="headerlink" href="#underlying-aes" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>EM9305 embeds:</dt><dd><ul class="simple">
<li><p>A software AES that manages the key sizes (128, 192 and 256).</p></li>
<li><p>A hardware AES that only manages 128-bit key size.</p></li>
</ul>
</dd>
<dt>The hardware AES can be invoked:</dt><dd><ul class="simple">
<li><p>either with a key given explicitly</p></li>
<li><p>or with a key stored in a key container. In this case, the ID of the key is provided to the AES.</p></li>
</ul>
</dd>
</dl>
<p>AES CBC APIs interface both the AES Software and the AES hardware. When AES hardware is used, the APIs allow the use of an explicit key or the use of a key container.</p>
<p>Next figure shows which AES is executed, according to the various options.</p>
<blockquote>
<div><img alt="_images/AES_Select.png" src="_images/AES_Select.png" />
</div></blockquote>
</section>
<section id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Permalink to this headline"></a></h2>
<section id="enumerations">
<h3>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this headline"></a></h3>
<section id="aes-type">
<h4>AES Type<a class="headerlink" href="#aes-type" title="Permalink to this headline"></a></h4>
<p>The underlying algorithm is chosen with the following macro: <a class="reference internal" href="AES.html#aes-hw-sw-label"><span class="std std-ref">AES type</span></a></p>
</section>
<section id="aes-key-size-in-bits">
<h4>AES Key size in bits<a class="headerlink" href="#aes-key-size-in-bits" title="Permalink to this headline"></a></h4>
<p>The key size is chosen with the macro defined here: <a class="reference internal" href="AES.html#aes-key-size-bits-label"><span class="std std-ref">AES Key size in bits</span></a></p>
</section>
<section id="explicit-key-or-key-container">
<h4>Explicit key or key container<a class="headerlink" href="#explicit-key-or-key-container" title="Permalink to this headline"></a></h4>
<p>The choice between a key provided by value or implicitly with a key container ID is given by the following enumeration:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv417AES_CBC_KeyType_t">
<span id="_CPPv317AES_CBC_KeyType_t"></span><span id="_CPPv217AES_CBC_KeyType_t"></span><span class="target" id="group___a_e_s___c_b_c_1ga0b68f6bf8209aeadbbf94d995a055f4a"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_KeyType_t</span></span></span><a class="headerlink" href="#_CPPv417AES_CBC_KeyType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Select if the key is passed by value(explicitly) or if the key is contained in a key container. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17AES_CBC_KeyType_t17AES_CBC_KEY_VALUEE">
<span id="_CPPv3N17AES_CBC_KeyType_t17AES_CBC_KEY_VALUEE"></span><span id="_CPPv2N17AES_CBC_KeyType_t17AES_CBC_KEY_VALUEE"></span><span class="target" id="group___a_e_s___c_b_c_1gga0b68f6bf8209aeadbbf94d995a055f4aa8795b9217b2004e97b4a3bd48ebbbd4a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_KEY_VALUE</span></span></span><a class="headerlink" href="#_CPPv4N17AES_CBC_KeyType_t17AES_CBC_KEY_VALUEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key value is provided explicitly by value. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17AES_CBC_KeyType_t14AES_CBC_KEY_IDE">
<span id="_CPPv3N17AES_CBC_KeyType_t14AES_CBC_KEY_IDE"></span><span id="_CPPv2N17AES_CBC_KeyType_t14AES_CBC_KEY_IDE"></span><span class="target" id="group___a_e_s___c_b_c_1gga0b68f6bf8209aeadbbf94d995a055f4aa467292ea252fa5737d575f795007d5c9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_KEY_ID</span></span></span><a class="headerlink" href="#_CPPv4N17AES_CBC_KeyType_t14AES_CBC_KEY_IDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key value is provided by its ID. The key is in a key container. </p>
</dd></dl>

</dd></dl>

</section>
<section id="error-status">
<h4>Error status<a class="headerlink" href="#error-status" title="Permalink to this headline"></a></h4>
<p>The API error status is given by:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv419AES_CBC_Lib_error_t">
<span id="_CPPv319AES_CBC_Lib_error_t"></span><span id="_CPPv219AES_CBC_Lib_error_t"></span><span class="target" id="group___a_e_s___c_b_c_1ga9516833117f6cd5b1282035a8bbf0f99"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_Lib_error_t</span></span></span><a class="headerlink" href="#_CPPv419AES_CBC_Lib_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Error status words for AES CBC mode. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_CBC_Lib_error_t15AES_CBC_SUCCESSE">
<span id="_CPPv3N19AES_CBC_Lib_error_t15AES_CBC_SUCCESSE"></span><span id="_CPPv2N19AES_CBC_Lib_error_t15AES_CBC_SUCCESSE"></span><span class="target" id="group___a_e_s___c_b_c_1gga9516833117f6cd5b1282035a8bbf0f99a919b458468da1b87e19e42d2d3678264"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_SUCCESS</span></span></span><a class="headerlink" href="#_CPPv4N19AES_CBC_Lib_error_t15AES_CBC_SUCCESSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES CBC computation successful. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_CBC_Lib_error_t30AES_CBC_INCOMPATIBLE_PARAMETERE">
<span id="_CPPv3N19AES_CBC_Lib_error_t30AES_CBC_INCOMPATIBLE_PARAMETERE"></span><span id="_CPPv2N19AES_CBC_Lib_error_t30AES_CBC_INCOMPATIBLE_PARAMETERE"></span><span class="target" id="group___a_e_s___c_b_c_1gga9516833117f6cd5b1282035a8bbf0f99a92158f98d3da927428d4ab1700d7cee8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_INCOMPATIBLE_PARAMETER</span></span></span><a class="headerlink" href="#_CPPv4N19AES_CBC_Lib_error_t30AES_CBC_INCOMPATIBLE_PARAMETERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Incompatible key size with key type and AES type. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_CBC_Lib_error_t24AES_CBC_INCORRECT_LENGTHE">
<span id="_CPPv3N19AES_CBC_Lib_error_t24AES_CBC_INCORRECT_LENGTHE"></span><span id="_CPPv2N19AES_CBC_Lib_error_t24AES_CBC_INCORRECT_LENGTHE"></span><span class="target" id="group___a_e_s___c_b_c_1gga9516833117f6cd5b1282035a8bbf0f99afc61d7eaa6840f21f9de33dcc0e587b9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_INCORRECT_LENGTH</span></span></span><a class="headerlink" href="#_CPPv4N19AES_CBC_Lib_error_t24AES_CBC_INCORRECT_LENGTHE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Incorrect length- Data must be 16 bytes long. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_CBC_Lib_error_t28AES_CBC_INCORRECT_KEY_LENGTHE">
<span id="_CPPv3N19AES_CBC_Lib_error_t28AES_CBC_INCORRECT_KEY_LENGTHE"></span><span id="_CPPv2N19AES_CBC_Lib_error_t28AES_CBC_INCORRECT_KEY_LENGTHE"></span><span class="target" id="group___a_e_s___c_b_c_1gga9516833117f6cd5b1282035a8bbf0f99ae7369fe40b5878725c64dec9ce141d69"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_INCORRECT_KEY_LENGTH</span></span></span><a class="headerlink" href="#_CPPv4N19AES_CBC_Lib_error_t28AES_CBC_INCORRECT_KEY_LENGTHE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key length is incorrect.It shall be 128,192 or 256. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_CBC_Lib_error_t32AES_CBC_INCORRECT_RESULT_POINTERE">
<span id="_CPPv3N19AES_CBC_Lib_error_t32AES_CBC_INCORRECT_RESULT_POINTERE"></span><span id="_CPPv2N19AES_CBC_Lib_error_t32AES_CBC_INCORRECT_RESULT_POINTERE"></span><span class="target" id="group___a_e_s___c_b_c_1gga9516833117f6cd5b1282035a8bbf0f99a041101be29e38fdca583fa4b165ecdba"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_INCORRECT_RESULT_POINTER</span></span></span><a class="headerlink" href="#_CPPv4N19AES_CBC_Lib_error_t32AES_CBC_INCORRECT_RESULT_POINTERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Result pointer is null. </p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="context">
<h3>Context<a class="headerlink" href="#context" title="Permalink to this headline"></a></h3>
<p>A context that contains the key size, the underlying AES , the key type and the key value \ key ID is defined as follows. It also defines the initial value.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv411AES_CBC_CTX">
<span id="_CPPv311AES_CBC_CTX"></span><span id="_CPPv211AES_CBC_CTX"></span><span id="AES_CBC_CTX"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_CTX</span></span></span><a class="headerlink" href="#_CPPv411AES_CBC_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES CBC context </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_CBC_CTX7keySizeE">
<span id="_CPPv3N11AES_CBC_CTX7keySizeE"></span><span id="_CPPv2N11AES_CBC_CTX7keySizeE"></span><span id="AES_CBC_CTX::keySize__AES_key_size_bit_t"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x_1a3a3399db3446bfb480e9c2e28b9c466d"></span><a class="reference internal" href="AES.html#_CPPv418AES_key_size_bit_t" title="AES_key_size_bit_t"><span class="n"><span class="pre">AES_key_size_bit_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keySize</span></span></span><a class="headerlink" href="#_CPPv4N11AES_CBC_CTX7keySizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_CBC_CTX7AESTypeE">
<span id="_CPPv3N11AES_CBC_CTX7AESTypeE"></span><span id="_CPPv2N11AES_CBC_CTX7AESTypeE"></span><span id="AES_CBC_CTX::AESType__AES_Select_t"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x_1a7bd70cee43e62ab8177a41f6896d270f"></span><a class="reference internal" href="AES.html#_CPPv412AES_Select_t" title="AES_Select_t"><span class="n"><span class="pre">AES_Select_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AESType</span></span></span><a class="headerlink" href="#_CPPv4N11AES_CBC_CTX7AESTypeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES Type: Either AES_HARDWARE or AES_SOFTWARE. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_CBC_CTX7keyTypeE">
<span id="_CPPv3N11AES_CBC_CTX7keyTypeE"></span><span id="_CPPv2N11AES_CBC_CTX7keyTypeE"></span><span id="AES_CBC_CTX::keyType__AES_CBC_KeyType_t"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x_1aa52ba69b39d25ecdf05af9a80b5a5bc5"></span><a class="reference internal" href="#_CPPv417AES_CBC_KeyType_t" title="AES_CBC_KeyType_t"><span class="n"><span class="pre">AES_CBC_KeyType_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keyType</span></span></span><a class="headerlink" href="#_CPPv4N11AES_CBC_CTX7keyTypeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key type. Either KEY_ID or KEY_VALUE </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_CBC_CTX3keyE">
<span id="_CPPv3N11AES_CBC_CTX3keyE"></span><span id="_CPPv2N11AES_CBC_CTX3keyE"></span><span id="AES_CBC_CTX::key__uint8_tA"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x_1a2e97c217f2cc160faddc5358874b6e01"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">key</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">32</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_CBC_CTX3keyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The key value or the key index </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_CBC_CTX2IVE">
<span id="_CPPv3N11AES_CBC_CTX2IVE"></span><span id="_CPPv2N11AES_CBC_CTX2IVE"></span><span id="AES_CBC_CTX::IV__uint8_tA"></span><span class="target" id="struct_a_e_s___c_b_c___c_t_x_1a6bf7e85de27d9ffeb2fafbdd9e4e7938"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IV</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_CBC_CTX2IVE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initial value </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="aes-cbc-initctx">
<h3>AES_CBC_InitCtx<a class="headerlink" href="#aes-cbc-initctx" title="Permalink to this headline"></a></h3>
<section id="goal-of-the-function">
<h4>Goal of the function<a class="headerlink" href="#goal-of-the-function" title="Permalink to this headline"></a></h4>
<p>This function initializes an AES context with the different options: key size, underlying AES and key type. It also sets the key and the initial value.</p>
</section>
<section id="prototype">
<h4>Prototype<a class="headerlink" href="#prototype" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415AES_CBC_InitCtxP11AES_CBC_CTX12AES_Select_t17AES_CBC_KeyType_t18AES_key_size_bit_tP7uint8_tP7uint8_t">
<span id="_CPPv315AES_CBC_InitCtxP11AES_CBC_CTX12AES_Select_t17AES_CBC_KeyType_t18AES_key_size_bit_tP7uint8_tP7uint8_t"></span><span id="_CPPv215AES_CBC_InitCtxP11AES_CBC_CTX12AES_Select_t17AES_CBC_KeyType_t18AES_key_size_bit_tP7uint8_tP7uint8_t"></span><span id="AES_CBC_InitCtx__AES_CBC_CTXP.AES_Select_t.AES_CBC_KeyType_t.AES_key_size_bit_t.uint8_tP.uint8_tP"></span><span class="target" id="group___a_e_s___c_b_c_1ga0c8ad0b4890699d985e7bdd622d75495"></span><a class="reference internal" href="#_CPPv419AES_CBC_Lib_error_t" title="AES_CBC_Lib_error_t"><span class="n"><span class="pre">AES_CBC_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_InitCtx</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_CBC_CTX" title="AES_CBC_CTX"><span class="n"><span class="pre">AES_CBC_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <a class="reference internal" href="AES.html#_CPPv412AES_Select_t" title="AES_Select_t"><span class="n"><span class="pre">AES_Select_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">AESSelect</span></span>, <a class="reference internal" href="#_CPPv417AES_CBC_KeyType_t" title="AES_CBC_KeyType_t"><span class="n"><span class="pre">AES_CBC_KeyType_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">keyType</span></span>, <a class="reference internal" href="AES.html#_CPPv418AES_key_size_bit_t" title="AES_key_size_bit_t"><span class="n"><span class="pre">AES_key_size_bit_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">keySize</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">IV</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">key</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415AES_CBC_InitCtxP11AES_CBC_CTX12AES_Select_t17AES_CBC_KeyType_t18AES_key_size_bit_tP7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialize an AES CBC context. Choose the underlying AES, the key type and key size. Set the key value. Set the initial value. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[out]</strong> AES CBC context to set </p></li>
<li><p><strong>AESSelect</strong> – <strong>[in]</strong> The underlying AES: Either AES_HARDWARE or AES_SOFTWARE </p></li>
<li><p><strong>keyType</strong> – <strong>[in]</strong> The type of the key: Either KEY_VALUE for explicitly key value or KEY_ID for a key in a key container </p></li>
<li><p><strong>keySize</strong> – <strong>[in]</strong> The size of the key in bits : AES_KEY_128,AES_KEY_192 or AES_KEY_256 </p></li>
<li><p><strong>IV</strong> – <strong>[in]</strong> The 16-byte initial value </p></li>
<li><p><strong>key</strong> – <strong>[in]</strong> The key value(16 to 32 bytes) or the key ID (first byte)</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_CBC_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_CBC_INCORRECT_KEY_LENGTH</strong> – Incorrect key length </p></li>
<li><p><strong>AES_CBC_INCOMPATIBLE_PARAMETER</strong> – Hardware/software selection is not compatible with the key length </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Ctx</strong> : The AES CBC context to initialize</p></li>
<li><p><strong>AESSelect</strong>: Select the AES hardware or the AES software</p></li>
<li><p><strong>keyType</strong>: Select if the key is given explicitly by value or if it refers by its key container ID.</p></li>
<li><p><strong>keySize</strong>: Key size in bits</p></li>
<li><dl class="simple">
<dt><strong>key</strong>:</dt><dd><ul>
<li><p>When the key is given explicitly: 16, 24 or 32 bytes representing the key value.</p></li>
<li><p>When the key is given by its ID: 1 byte with the key ID.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>IV</strong>: 16-byte initial value</p></li>
</ul>
</section>
<section id="return-values">
<h4>Return values<a class="headerlink" href="#return-values" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_CBC_SUCCESS</p></td>
<td><p>Initialization successful</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_INCORRECT_KEY_LENGTH</p></td>
<td><p>Incorrect key length</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_INCOMPATIBLE_PARAMETER</p></td>
<td><p>Hardware AES is not compatible with this key length</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-cbc-encrypt">
<h3>AES_CBC_Encrypt<a class="headerlink" href="#aes-cbc-encrypt" title="Permalink to this headline"></a></h3>
<section id="id1">
<h4>Goal of the function<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>This function encrypts a message in CBC mode.</p>
</section>
<section id="id2">
<h4>Prototype<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415AES_CBC_EncryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t">
<span id="_CPPv315AES_CBC_EncryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t"></span><span id="_CPPv215AES_CBC_EncryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t"></span><span id="AES_CBC_Encrypt__AES_CBC_CTXP.uint8_tP.uint8_tP.uint32_t"></span><span class="target" id="group___a_e_s___c_b_c_1ga6c3ad909730cd8f99ed0fd9d510411cf"></span><a class="reference internal" href="#_CPPv419AES_CBC_Lib_error_t" title="AES_CBC_Lib_error_t"><span class="n"><span class="pre">AES_CBC_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_Encrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_CBC_CTX" title="AES_CBC_CTX"><span class="n"><span class="pre">AES_CBC_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plainText</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cipherText</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sizeInBytes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415AES_CBC_EncryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrypt data in CBC mode. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES CBC context </p></li>
<li><p><strong>plainText</strong> – <strong>[in]</strong> Pointer on data to encrypt. It should be sizeInBytes long </p></li>
<li><p><strong>cipherText</strong> – <strong>[out]</strong> Pointer on the result. It should be sizeInBytes long </p></li>
<li><p><strong>sizeInBytes</strong> – <strong>[in]</strong> Size of the plaintext=Size of the cipher text in bytes. It must be a multiple of 16.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_CBC_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_CBC_INCORRECT_RESULT_POINTER</strong> – Result pointer not initialized </p></li>
<li><p><strong>AES_CBC_INCORRECT_LENGTH</strong> – Length is not a multiple of 16 </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Ctx</strong> : The AES CBC context</p></li>
<li><p><strong>plainText</strong>: Message to encrypt</p></li>
<li><p><strong>cipherText</strong> : Encrypted message.</p></li>
<li><p><strong>sizeInBytes</strong> : Size of the message to encrypt in bytes.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Since CBC mode acts on block of 16 bytes, <em>sizeInBytes</em> must be a multiple of 16. If the message size is not a multiple of 16, the caller must previously pad the message. The padding scheme is the choice of the user.</p></li>
<li><p>The ciphertext size is the same as the plaintext size.</p></li>
<li><p>Several calls of AES_CBC_Encrypt  can be performed consecutively.</p></li>
<li><p>In addition, several AES CBC computations with different contexts can be interlaced.</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type AES_ENC_ONLY(Encryption). The key must not have been invalidated. In case those conditions are not respected, this function returns an error of AES_Error_t.</p>
</div>
</section>
<section id="id4">
<h4>Return values<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_CBC_SUCCESS</p></td>
<td><p>Successful encryption</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_INCORRECT_RESULT_POINTER</p></td>
<td><p>Ciphertext pointer is not initialized</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_INCORRECT_LENGTH</p></td>
<td><p>The size in bytes of the plaintext is not a multiple of 16</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-cbc-decrypt">
<h3>AES_CBC_Decrypt<a class="headerlink" href="#aes-cbc-decrypt" title="Permalink to this headline"></a></h3>
<section id="id5">
<h4>Goal of the function<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<p>This function decrypts a message in CBC mode.</p>
</section>
<section id="id6">
<h4>Prototype<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415AES_CBC_DecryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t">
<span id="_CPPv315AES_CBC_DecryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t"></span><span id="_CPPv215AES_CBC_DecryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t"></span><span id="AES_CBC_Decrypt__AES_CBC_CTXP.uint8_tP.uint8_tP.uint32_t"></span><span class="target" id="group___a_e_s___c_b_c_1ga12221112037447d20f3328f87799dcc2"></span><a class="reference internal" href="#_CPPv419AES_CBC_Lib_error_t" title="AES_CBC_Lib_error_t"><span class="n"><span class="pre">AES_CBC_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_CBC_Decrypt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_CBC_CTX" title="AES_CBC_CTX"><span class="n"><span class="pre">AES_CBC_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cipherText</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plainText</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sizeInBytes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415AES_CBC_DecryptP11AES_CBC_CTXP7uint8_tP7uint8_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Decrypt data in CBC mode. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES CBC context </p></li>
<li><p><strong>cipherText</strong> – <strong>[in]</strong> Pointer on data to decrypt. It should be sizeInBytes long </p></li>
<li><p><strong>plainText</strong> – <strong>[out]</strong> Pointer on the result. It should be sizeInBytes long </p></li>
<li><p><strong>sizeInBytes</strong> – <strong>[in]</strong> Size of the ciphertext=Size of the plaintext in bytes. It must be a multiple of 16.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_CBC_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_CBC_INCORRECT_RESULT_POINTER</strong> – Result pointer not initialized </p></li>
<li><p><strong>AES_CBC_INCORRECT_LENGTH</strong> – Length is not a multiple of 16 </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Ctx</strong> : The AES CBC context</p></li>
<li><p><strong>cipherText</strong>: Message to decrypt</p></li>
<li><p><strong>plainText</strong> : Decrypted message.</p></li>
<li><p><strong>sizeInBytes</strong> : Size of the message to decrypt in bytes.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Since CBC mode acts on block of 16 bytes, <em>sizeInBytes</em> must be a multiple of 16.</p></li>
<li><p>The last decrypted plaintext may include padding bytes. The user is in charge of removing it when applicable.</p></li>
<li><p>The plaintext size is the same as the ciphertext size.</p></li>
<li><p>Several calls of AES_CBC_Decrypt  can be performed consecutively.</p></li>
<li><p>In addition, several AES CBC computations with different contexts can be interlaced.</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type AES_DEC_ONLY(Decryption). The key must not have been invalidated. In case those conditions are not respected, this function returns an error of AES_Error_t.</p>
</div>
</section>
<section id="id8">
<h4>Return values<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_CBC_SUCCESS</p></td>
<td><p>Successful decrpytion</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_INCORRECT_RESULT_POINTER</p></td>
<td><p>Plaintext pointer is not initialized</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_INCORRECT_LENGTH</p></td>
<td><p>The size in bytes of the ciphertext is not a multiple of 16</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="performances">
<h2>Performances<a class="headerlink" href="#performances" title="Permalink to this headline"></a></h2>
<section id="library-location">
<h3>Library location<a class="headerlink" href="#library-location" title="Permalink to this headline"></a></h3>
<p>The lib is located in ROM.</p>
</section>
<section id="code-size">
<h3>Code size<a class="headerlink" href="#code-size" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>448 bytes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ram">
<h3>RAM<a class="headerlink" href="#ram" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No usage of global RAM except the AES_CBC_CTX</p></td>
</tr>
</tbody>
</table>
</section>
<section id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>144 bytes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="execution-time">
<h3>Execution time<a class="headerlink" href="#execution-time" title="Permalink to this headline"></a></h3>
<p>The execution time clearly depends on the size of the message, the key size and the underlying algorithm. In next table, we provide the figure for one block(16 bytes).</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_CBC_InitCtx</p></td>
<td><p>Any</p></td>
<td><p>Any</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_Encrypt</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_Encrypt</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>114</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_Encrypt</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>141</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_Encrypt</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>159</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_Decrypt</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>TBD</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_Decrypt</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>143</p></td>
</tr>
<tr class="row-odd"><td><p>AES_CBC_Decrypt</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>181</p></td>
</tr>
<tr class="row-even"><td><p>AES_CBC_Decrypt</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>11</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline"></a></h2>
<p>AES CBC lib depends on the AES lib.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>Next code shows basic examples:</dt><dd><ul class="simple">
<li><p>using the AES hardware with an explicit key</p></li>
<li><p>using the AES hardware with key stored in key containers</p></li>
<li><p>using the AES software</p></li>
</ul>
</dd>
</dl>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @file       ExampleAES_CBC.c</span>
<span class="c1">///</span>
<span class="c1">///</span>
<span class="c1">/// @brief   	Example of use of AES CBC</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @copyright Copyright (C) 2022 EM Microelectronic</span>
<span class="c1">/// @cond</span>
<span class="c1">///</span>
<span class="c1">/// All rights reserved.</span>
<span class="c1">///</span>
<span class="c1">/// Redistribution and use in source and binary forms, with or without</span>
<span class="c1">/// modification, are permitted provided that the following conditions are met:</span>
<span class="c1">/// 1. Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer.</span>
<span class="c1">/// 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">/// and/or other materials provided with the distribution.</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1">/// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1">/// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c1">/// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<span class="c1">/// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c1">/// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c1">/// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c1">/// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c1">/// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c1">/// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="c1">/// POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">/// @endcond</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;AES.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hw_aes.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;AES_CBC.h&quot;</span><span class="cp"></span>

<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">ExampleAES_CBC</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">key</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY128</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x33</span><span class="p">,</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w"> </span><span class="mh">0xaa</span><span class="p">,</span><span class="w"> </span><span class="mh">0x51</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa4</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x5c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2d</span><span class="p">,</span><span class="w"> </span><span class="mh">0xbe</span><span class="p">,</span><span class="w"> </span><span class="mh">0x33</span><span class="p">,</span><span class="w"> </span><span class="mh">0xcc</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x96</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xde</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iv</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY128</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x19</span><span class="p">,</span><span class="w"> </span><span class="mh">0x15</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xdf</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x38</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x96</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">plaintext</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x9b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xee</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x26</span><span class="p">,</span><span class="w"> </span><span class="mh">0x57</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xfd</span><span class="p">,</span><span class="w"> </span><span class="mh">0xbb</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x32</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x38</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x36</span><span class="p">,</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x56</span><span class="p">,</span><span class="w"> </span><span class="mh">0xba</span><span class="p">,</span><span class="w"> </span><span class="mh">0x61</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0x47</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd5</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xd5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x41</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x99</span><span class="p">,</span><span class="w"> </span><span class="mh">0xab</span><span class="p">,</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="mh">0xee</span><span class="p">,</span><span class="w"> </span><span class="mh">0x35</span><span class="p">,</span><span class="w"> </span><span class="mh">0x99</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xd5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xae</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc9</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2e</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x51</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5d</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x28</span><span class="p">,</span><span class="w"> </span><span class="mh">0x19</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x52</span><span class="p">,</span><span class="w"> </span><span class="mh">0x50</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xdb</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xcd</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4a</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x45</span><span class="p">,</span><span class="w"> </span><span class="mh">0x77</span><span class="p">,</span><span class="w"> </span><span class="mh">0x26</span><span class="p">,</span><span class="w"> </span><span class="mh">0xde</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x78</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa2</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x8d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0xdb</span><span class="p">,</span><span class="w"> </span><span class="mh">0x56</span><span class="p">,</span><span class="w"> </span><span class="mh">0x52</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xfe</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe5</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">key192</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3b</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x98</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf1</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xfc</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8f</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xdf</span><span class="p">,</span><span class="w"> </span><span class="mh">0x43</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x1f</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x47</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2d</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">iv192</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xea</span><span class="p">,</span><span class="w"> </span><span class="mh">0xae</span><span class="p">,</span><span class="w"> </span><span class="mh">0xca</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="mh">0xdd</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xed</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4d</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0f</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">plaintext192</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xc5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xce</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x13</span><span class="p">,</span><span class="w"> </span><span class="mh">0xbf</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x17</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w"> </span><span class="mh">0xc1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x44</span><span class="p">,</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4e</span><span class="p">,</span><span class="w"> </span><span class="mh">0xba</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xf1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0d</span><span class="p">,</span><span class="w"> </span><span class="mh">0xdc</span><span class="p">,</span><span class="w"> </span><span class="mh">0xac</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x90</span><span class="p">,</span><span class="w"> </span><span class="mh">0x17</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8c</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xbe</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xad</span><span class="p">,</span><span class="w"> </span><span class="mh">0x79</span><span class="p">,</span><span class="w"> </span><span class="mh">0x19</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf1</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x3b</span><span class="p">,</span><span class="w"> </span><span class="mh">0xbe</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x50</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1e</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa0</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ciphertext192</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xed</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x50</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe0</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xc6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x52</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x75</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4f</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xd5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xce</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1f</span><span class="p">,</span><span class="w"> </span><span class="mh">0xed</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb4</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xd1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x47</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x75</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xe6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x75</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x58</span><span class="p">,</span><span class="w"> </span><span class="mh">0x46</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xb3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x51</span><span class="p">,</span><span class="w"> </span><span class="mh">0x81</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf4</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="n">AES_CBC_CTX</span><span class="w"> </span><span class="n">Ctx</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">AES_CBC_Lib_error_t</span><span class="w"> </span><span class="n">sw</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyId</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>

<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// First example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// AES CBC with a 128-bit key in encryption mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We use the AES hardware but not the crypto containers.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We encrypt all the block in a unique call</span>
<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>

<span class="w">	</span><span class="c1">//initialize the context</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HARDWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_CBC_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">key</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//encrypt the data</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Encrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">plaintext</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//check the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Second example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// AES CBC with a 128-bit key in decryption mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We use the AES software</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We decrypt the blocks one by one</span>
<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>

<span class="w">	</span><span class="c1">//initialize the context</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_SOFTWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_CBC_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">key</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//decrypt the first block</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Decrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//decrypt the second block</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Decrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Decrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//check the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Third example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// AES CBC with a 128-bit key in encryption mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We use the AES hardware and the crypto container</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We encrypt all the block in a unique call</span>
<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">//A priori the key has been written previously in a key container.</span>
<span class="w">	</span><span class="c1">//Here we write the key in container 0x07</span>
<span class="w">	</span><span class="n">AES_SetKeyContainer</span><span class="p">((</span><span class="kt">uint32_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HW_ENC_DEC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">keyId</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x07</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//initialize the context</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HARDWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_CBC_KEY_ID</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">keyId</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="c1">//encrypt the data</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Encrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">plaintext</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//check the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// fourth example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// AES CBC with a 128-bit key in decryption mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We use the AES hardware and the crypto container</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We decrypt the blocks in two steps</span>
<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>

<span class="w">	</span><span class="c1">//reinitialize the context</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HARDWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_CBC_KEY_ID</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"> </span><span class="n">iv</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">keyId</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="c1">//decrypt 2 blocks</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Decrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//decrypt 1 block</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Decrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">ciphertext</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">result</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//check the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Fifth example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// AES CBC with a 192-bit key in encryption mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We necessarily use the AES software</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We encrypt in one call</span>
<span class="w">	</span><span class="c1">//-----------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">//initialize the context</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_SOFTWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_CBC_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_192</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">iv192</span><span class="p">,</span><span class="w"> </span><span class="n">key192</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//encrypt the first block</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_CBC_Encrypt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">plaintext192</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_CBC_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//check the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">AES_BLOCK_SIZE_BYTE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ciphertext192</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">else</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AES_ECB.html" class="btn btn-neutral float-left" title="AES Electronic Code Book mode (ECB)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AES_CTR.html" class="btn btn-neutral float-right" title="AES Counter mode(CTR)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, EM.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>