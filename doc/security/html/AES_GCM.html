<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AES GCM &mdash; EM9305 CryptoLib 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PRNG (Pseudo Random Number Generation)" href="PRNG.html" />
    <link rel="prev" title="AES CCM" href="AES_CCM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="index.html" class="icon icon-home"> EM9305 CryptoLib
            <img src="_static/logoEM.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Architecture.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AES.html">AES (one block)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CryptoContainer.html">AES Crypto Containers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="AESModes.html">AES modes and MAC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AES_ECB.html">AES Electronic Code Book mode (ECB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CBC.html">AES Cipher Block Chaining mode (CBC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CTR.html">AES Counter mode(CTR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CMAC.html">AES CMAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="AES_CCM.html">AES CCM</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AES GCM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bibliography">Bibliography</a></li>
<li class="toctree-l3"><a class="reference internal" href="#goal-of-the-document">Goal of the document</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-galois-counter-mode-gcm">The Galois Counter Mode (GCM)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gmac">GMAC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#underlying-aes">Underlying AES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis">APIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enumerations">Enumerations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#aes-type">AES Type</a></li>
<li class="toctree-l5"><a class="reference internal" href="#aes-key-size-in-bits">AES Key size in bits</a></li>
<li class="toctree-l5"><a class="reference internal" href="#explicit-key-or-key-container">Explicit key or key container</a></li>
<li class="toctree-l5"><a class="reference internal" href="#error-status">Error status</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-initctx">AES_GCM_InitCtx</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#goal-of-the-function">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#prototype">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#return-values">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-hash-additional-data">AES_GCM_Hash_Additional_Data</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id1">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id2">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id3">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id4">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-encryptandmac">AES_GCM_EncryptAndMAC</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id5">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id7">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id8">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-decryptandmac">AES_GCM_DecryptAndMAC</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id9">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id10">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id11">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id12">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-gmac">AES_GCM_GMAC</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id13">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id14">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id15">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id16">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#aes-gcm-getmac">AES_GCM_GetMAC</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#id17">Goal of the function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id18">Prototype</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id19">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id20">Return values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performances">Performances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#library-location">Library location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-size">Code size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ram">RAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack">Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-time">Execution time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PRNG.html">PRNG (Pseudo Random Number Generation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ECC_FUNCTIONS.html">ECC Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="HASH_FUNCTIONS.html">Hash functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EM9305 CryptoLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="AESModes.html">AES modes and MAC</a> &raquo;</li>
      <li>AES GCM</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aes-gcm">
<span id="aes-gcm-label"></span><h1>AES GCM<a class="headerlink" href="#aes-gcm" title="Permalink to this headline"></a></h1>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline"></a></h2>
<p>[1] NIST SP 800-38D: Recommendation for Block Cipher Modes of Operation: the GCM Mode for Authentication and Confidentiality</p>
<p><a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">NIST SP800-38D</a>: <a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf</a></p>
</section>
<section id="goal-of-the-document">
<h2>Goal of the document<a class="headerlink" href="#goal-of-the-document" title="Permalink to this headline"></a></h2>
<p>The goal of this chapter is to describe the functionality of the library <strong>AES GCM</strong>.</p>
<dl class="simple">
<dt>This chapter:</dt><dd><ul class="simple">
<li><p>describes the API, including the prototype, the parameters, the error codes etc…</p></li>
<li><p>provides the performances of the function.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="the-galois-counter-mode-gcm">
<h2>The Galois Counter Mode (GCM)<a class="headerlink" href="#the-galois-counter-mode-gcm" title="Permalink to this headline"></a></h2>
<p>This library implements AES GCM algorithm according to the specification NIST SP 800-38D[1].</p>
<p>AES GCM is an AEAD algorithm that it is to say an Authenticated Encryption with Additional Data algorithm.
As the name indicates it, it allows to encrypt a message and compute a MAC on the message which is optionally appended with additional data before the message.</p>
<blockquote>
<div><ul class="simple">
<li><p>The MAC is computed on the additional data and the following message.</p></li>
<li><p>Only the message is encrypted.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Fundamentally AES GCM:</dt><dd><ul class="simple">
<li><p>Encrypt\decrypt data with an AES counter mode.</p></li>
<li><p>MAC the data with Galois Field multiplication (H)</p></li>
<li><p>Data of any size can be encrypted\decrypted and MAC.</p></li>
</ul>
</dd>
</dl>
<p>Because the encryption is performed with a counter mode, the decryption is very similar to encryption. The plaintext and ciphertext are just inversed.</p>
<p>Next figure shows the <strong>Encryption and MAC</strong> mechanism.</p>
<img alt="_images/AES_GCM_ENC.png" src="_images/AES_GCM_ENC.png" />
<dl class="simple">
<dt>It can be seen that:</dt><dd><ul class="simple">
<li><p>the top of the figure corresponds to the encryption of the plaintext with an AES counter mode.</p></li>
<li><p>the bottom of the figure shows the MAC generation with a Galois field multiplication (H).</p></li>
</ul>
</dd>
</dl>
<p>When the IV is 96 bits, the initialization of the counter is mainly performed with the IV. When the IV is not 96 bits long , the IV is firstly hashed until it fits in an AES block. The grey box illustrates this case. The details are given in [1].</p>
<p>The Galois field multiplication involves a subkey. The subkey is generated as the encryption of the null block with the main key K.</p>
<p>The MAC process is completed in XORing the length of the additional data and the length of the data. The result is hashed a last time and XORed with the encryption of the IV.
The decryption and MAC process is similar. The role of the ciphertext and plaintext are just inversed.
Next figure shows the <strong>Decryption and MAC</strong> mechanism.</p>
<img alt="_images/AES_GCM_DEC.png" src="_images/AES_GCM_DEC.png" />
<section id="gmac">
<h3>GMAC<a class="headerlink" href="#gmac" title="Permalink to this headline"></a></h3>
<p><strong>GMAC</strong> is a special case of GCM mode where data is only authenticated, and not encrypted\ decrypted.
It is equivalent to have additional data without any message.
The library provides specific APIs to generate a GMAC.</p>
</section>
</section>
<section id="underlying-aes">
<h2>Underlying AES<a class="headerlink" href="#underlying-aes" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>EM9305 embeds:</dt><dd><ul class="simple">
<li><p>A software AES that manages the key sizes (128, 192 and 256).</p></li>
<li><p>A hardware AES that only manages 128-bit key size.</p></li>
</ul>
</dd>
<dt>The hardware AES can be invoked:</dt><dd><ul class="simple">
<li><p>either with a key given explicitly</p></li>
<li><p>or with a key stored in a key container. In this case, the ID of the key is provided to the AES.</p></li>
</ul>
</dd>
</dl>
<p>AES GCM APIs interface both the AES Software and the AES hardware. When AES hardware is used, the APIs allows the use of an explicit key or the use of a key container.</p>
<p>Next figure shows which AES is executed, according to the various options.</p>
<blockquote>
<div><img alt="_images/AES_Select.png" src="_images/AES_Select.png" />
</div></blockquote>
</section>
<section id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Permalink to this headline"></a></h2>
<section id="enumerations">
<h3>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this headline"></a></h3>
<section id="aes-type">
<h4>AES Type<a class="headerlink" href="#aes-type" title="Permalink to this headline"></a></h4>
<p>The underlying algorithm is chosen with the following macro: <a class="reference internal" href="AES.html#aes-hw-sw-label"><span class="std std-ref">AES type</span></a></p>
</section>
<section id="aes-key-size-in-bits">
<h4>AES Key size in bits<a class="headerlink" href="#aes-key-size-in-bits" title="Permalink to this headline"></a></h4>
<p>The key size is chosen with the macro defined here: <a class="reference internal" href="AES.html#aes-key-size-bits-label"><span class="std std-ref">AES Key size in bits</span></a></p>
</section>
<section id="explicit-key-or-key-container">
<h4>Explicit key or key container<a class="headerlink" href="#explicit-key-or-key-container" title="Permalink to this headline"></a></h4>
<p>The choice between a key provided by value or implicitly with a key container ID is given by the following enumeration:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv417AES_GCM_KeyType_t">
<span id="_CPPv317AES_GCM_KeyType_t"></span><span id="_CPPv217AES_GCM_KeyType_t"></span><span class="target" id="group___a_e_s___g_c_m_1ga091b32c9f029734a70a62f72ffaf6820"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_KeyType_t</span></span></span><a class="headerlink" href="#_CPPv417AES_GCM_KeyType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Select if the key is passed by value(explicitly) or if the key is contained in a key container. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17AES_GCM_KeyType_t17AES_GCM_KEY_VALUEE">
<span id="_CPPv3N17AES_GCM_KeyType_t17AES_GCM_KEY_VALUEE"></span><span id="_CPPv2N17AES_GCM_KeyType_t17AES_GCM_KEY_VALUEE"></span><span class="target" id="group___a_e_s___g_c_m_1gga091b32c9f029734a70a62f72ffaf6820a3240b7fe0ac9680e720610a95248e431"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_KEY_VALUE</span></span></span><a class="headerlink" href="#_CPPv4N17AES_GCM_KeyType_t17AES_GCM_KEY_VALUEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key value is provided explicitly by value. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N17AES_GCM_KeyType_t14AES_GCM_KEY_IDE">
<span id="_CPPv3N17AES_GCM_KeyType_t14AES_GCM_KEY_IDE"></span><span id="_CPPv2N17AES_GCM_KeyType_t14AES_GCM_KEY_IDE"></span><span class="target" id="group___a_e_s___g_c_m_1gga091b32c9f029734a70a62f72ffaf6820ae1a511e6ad162352a943196f30b5d071"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_KEY_ID</span></span></span><a class="headerlink" href="#_CPPv4N17AES_GCM_KeyType_t14AES_GCM_KEY_IDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key value is provided by its ID. The key is in a key container. </p>
</dd></dl>

</dd></dl>

</section>
<section id="error-status">
<h4>Error status<a class="headerlink" href="#error-status" title="Permalink to this headline"></a></h4>
<p>The API error status are given by:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv419AES_GCM_Lib_error_t">
<span id="_CPPv319AES_GCM_Lib_error_t"></span><span id="_CPPv219AES_GCM_Lib_error_t"></span><span class="target" id="group___a_e_s___g_c_m_1gae7fb4702cd1a9e69e39a1c9ecc8c5732"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></span><a class="headerlink" href="#_CPPv419AES_GCM_Lib_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Error status words for AES GCM mode. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_GCM_Lib_error_t15AES_GCM_SUCCESSE">
<span id="_CPPv3N19AES_GCM_Lib_error_t15AES_GCM_SUCCESSE"></span><span id="_CPPv2N19AES_GCM_Lib_error_t15AES_GCM_SUCCESSE"></span><span class="target" id="group___a_e_s___g_c_m_1ggae7fb4702cd1a9e69e39a1c9ecc8c5732ae20d402b3d2418318c9e9a333231f039"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_SUCCESS</span></span></span><a class="headerlink" href="#_CPPv4N19AES_GCM_Lib_error_t15AES_GCM_SUCCESSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES GCM computation successful. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_GCM_Lib_error_t30AES_GCM_INCOMPATIBLE_PARAMETERE">
<span id="_CPPv3N19AES_GCM_Lib_error_t30AES_GCM_INCOMPATIBLE_PARAMETERE"></span><span id="_CPPv2N19AES_GCM_Lib_error_t30AES_GCM_INCOMPATIBLE_PARAMETERE"></span><span class="target" id="group___a_e_s___g_c_m_1ggae7fb4702cd1a9e69e39a1c9ecc8c5732a156a79fcbbfb0909c5e456519967fec9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_INCOMPATIBLE_PARAMETER</span></span></span><a class="headerlink" href="#_CPPv4N19AES_GCM_Lib_error_t30AES_GCM_INCOMPATIBLE_PARAMETERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Incompatible key size with key type and AES type. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_GCM_Lib_error_t24AES_GCM_INCORRECT_LENGTHE">
<span id="_CPPv3N19AES_GCM_Lib_error_t24AES_GCM_INCORRECT_LENGTHE"></span><span id="_CPPv2N19AES_GCM_Lib_error_t24AES_GCM_INCORRECT_LENGTHE"></span><span class="target" id="group___a_e_s___g_c_m_1ggae7fb4702cd1a9e69e39a1c9ecc8c5732a9c1a35d235bac6792c91b4d3a7750565"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_INCORRECT_LENGTH</span></span></span><a class="headerlink" href="#_CPPv4N19AES_GCM_Lib_error_t24AES_GCM_INCORRECT_LENGTHE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Incorrect length- Data must be 16 bytes long. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_GCM_Lib_error_t28AES_GCM_INCORRECT_KEY_LENGTHE">
<span id="_CPPv3N19AES_GCM_Lib_error_t28AES_GCM_INCORRECT_KEY_LENGTHE"></span><span id="_CPPv2N19AES_GCM_Lib_error_t28AES_GCM_INCORRECT_KEY_LENGTHE"></span><span class="target" id="group___a_e_s___g_c_m_1ggae7fb4702cd1a9e69e39a1c9ecc8c5732ab11927d19d8e925aafcbff56b6d987f0"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_INCORRECT_KEY_LENGTH</span></span></span><a class="headerlink" href="#_CPPv4N19AES_GCM_Lib_error_t28AES_GCM_INCORRECT_KEY_LENGTHE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key length is incorrect.It shall be 128,192 or 256. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N19AES_GCM_Lib_error_t32AES_GCM_INCORRECT_RESULT_POINTERE">
<span id="_CPPv3N19AES_GCM_Lib_error_t32AES_GCM_INCORRECT_RESULT_POINTERE"></span><span id="_CPPv2N19AES_GCM_Lib_error_t32AES_GCM_INCORRECT_RESULT_POINTERE"></span><span class="target" id="group___a_e_s___g_c_m_1ggae7fb4702cd1a9e69e39a1c9ecc8c5732a5322cd50c2ad741b8dd842a656c382ee"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_INCORRECT_RESULT_POINTER</span></span></span><a class="headerlink" href="#_CPPv4N19AES_GCM_Lib_error_t32AES_GCM_INCORRECT_RESULT_POINTERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Result pointer is null. </p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="context">
<h3>Context<a class="headerlink" href="#context" title="Permalink to this headline"></a></h3>
<p>A context that contains the key size, the underlying AES , the key type , the key value \ key ID, the current counter and intermediate data is defined as follows.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv411AES_GCM_CTX">
<span id="_CPPv311AES_GCM_CTX"></span><span id="_CPPv211AES_GCM_CTX"></span><span id="AES_GCM_CTX"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_CTX</span></span></span><a class="headerlink" href="#_CPPv411AES_GCM_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES GCM context </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7keySizeE">
<span id="_CPPv3N11AES_GCM_CTX7keySizeE"></span><span id="_CPPv2N11AES_GCM_CTX7keySizeE"></span><span id="AES_GCM_CTX::keySize__AES_key_size_bit_t"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1ab53591c45d4a72d75bf7a8e143ea8376"></span><a class="reference internal" href="AES.html#_CPPv418AES_key_size_bit_t" title="AES_key_size_bit_t"><span class="n"><span class="pre">AES_key_size_bit_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keySize</span></span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7keySizeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7AESTypeE">
<span id="_CPPv3N11AES_GCM_CTX7AESTypeE"></span><span id="_CPPv2N11AES_GCM_CTX7AESTypeE"></span><span id="AES_GCM_CTX::AESType__AES_Select_t"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1ad4eb0203a1a315c61c7068aac2acc79e"></span><a class="reference internal" href="AES.html#_CPPv412AES_Select_t" title="AES_Select_t"><span class="n"><span class="pre">AES_Select_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AESType</span></span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7AESTypeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES Type: Either AES_HARDWARE or AES_SOFTWARE. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7keyTypeE">
<span id="_CPPv3N11AES_GCM_CTX7keyTypeE"></span><span id="_CPPv2N11AES_GCM_CTX7keyTypeE"></span><span id="AES_GCM_CTX::keyType__AES_GCM_KeyType_t"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a43231b794bdfde4395d6da5f051410e2"></span><a class="reference internal" href="#_CPPv417AES_GCM_KeyType_t" title="AES_GCM_KeyType_t"><span class="n"><span class="pre">AES_GCM_KeyType_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keyType</span></span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7keyTypeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Key type. Either KEY_ID or KEY_VALUE </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX3keyE">
<span id="_CPPv3N11AES_GCM_CTX3keyE"></span><span id="_CPPv2N11AES_GCM_CTX3keyE"></span><span id="AES_GCM_CTX::key__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1ab4bd6e305f9973e1ede3b08dd074e954"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">key</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">32</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX3keyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The key value or the key index </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX1HE">
<span id="_CPPv3N11AES_GCM_CTX1HE"></span><span id="_CPPv2N11AES_GCM_CTX1HE"></span><span id="AES_GCM_CTX::H__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a4e89e6e4acd813c65c066e5a5a35895b"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">H</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX1HE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The Hash subkey </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX1SE">
<span id="_CPPv3N11AES_GCM_CTX1SE"></span><span id="_CPPv2N11AES_GCM_CTX1SE"></span><span id="AES_GCM_CTX::S__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a4fb999786e1d33c294c0a5e885257470"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">S</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX1SE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Current MAC value </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX2J0E">
<span id="_CPPv3N11AES_GCM_CTX2J0E"></span><span id="_CPPv2N11AES_GCM_CTX2J0E"></span><span id="AES_GCM_CTX::J0__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a5978d243f322ffbf61b90e40424b8b39"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">J0</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX2J0E" title="Permalink to this definition"></a><br /></dt>
<dd><p>J0 value </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7counterE">
<span id="_CPPv3N11AES_GCM_CTX7counterE"></span><span id="_CPPv2N11AES_GCM_CTX7counterE"></span><span id="AES_GCM_CTX::counter__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1ace4889384b3cd9f1b88cdc9584feeed8"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">counter</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7counterE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Current counter </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7lengthAE">
<span id="_CPPv3N11AES_GCM_CTX7lengthAE"></span><span id="_CPPv2N11AES_GCM_CTX7lengthAE"></span><span id="AES_GCM_CTX::lengthA__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a470cc9f4e7210d1c6b52a6451e9e51fd"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lengthA</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7lengthAE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Accumulated length of Additional data </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX7lengthPE">
<span id="_CPPv3N11AES_GCM_CTX7lengthPE"></span><span id="_CPPv2N11AES_GCM_CTX7lengthPE"></span><span id="AES_GCM_CTX::lengthP__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a39ef0e107364a45b5fa6b3e4a6b87d48"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lengthP</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX7lengthPE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Accumulated length of plaintext or ciphertext </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX6bufferE">
<span id="_CPPv3N11AES_GCM_CTX6bufferE"></span><span id="_CPPv2N11AES_GCM_CTX6bufferE"></span><span id="AES_GCM_CTX::buffer__uint8_tA"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a175dc0b6c1727170897bae8c2218a9c8"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">buffer</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX6bufferE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Intermediate buffer for encryption/decryption </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX11nbByteReadyE">
<span id="_CPPv3N11AES_GCM_CTX11nbByteReadyE"></span><span id="_CPPv2N11AES_GCM_CTX11nbByteReadyE"></span><span id="AES_GCM_CTX::nbByteReady__uint8_t"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a12d51ac917cb0bbacbd31010aeaf14b2"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nbByteReady</span></span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX11nbByteReadyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Indicate how many bytes in the buffer are available to encrypt/decrypt the message before executing a new AES </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11AES_GCM_CTX4GMACE">
<span id="_CPPv3N11AES_GCM_CTX4GMACE"></span><span id="_CPPv2N11AES_GCM_CTX4GMACE"></span><span id="AES_GCM_CTX::GMAC__uint8_t"></span><span class="target" id="struct_a_e_s___g_c_m___c_t_x_1a24e9da4850ca5d8a546abb3f46908816"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GMAC</span></span></span><a class="headerlink" href="#_CPPv4N11AES_GCM_CTX4GMACE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Indicate if the computation is a GMAC or not </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="aes-gcm-initctx">
<h3>AES_GCM_InitCtx<a class="headerlink" href="#aes-gcm-initctx" title="Permalink to this headline"></a></h3>
<section id="goal-of-the-function">
<h4>Goal of the function<a class="headerlink" href="#goal-of-the-function" title="Permalink to this headline"></a></h4>
<p>This function initializes an AES context with the different options: key size, underlying AES and key type. It sets the key and the initial counter value. It also initializes the calculation, computing J0.</p>
</section>
<section id="prototype">
<h4>Prototype<a class="headerlink" href="#prototype" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415AES_GCM_InitCtxP11AES_GCM_CTX12AES_Select_t17AES_GCM_KeyType_t18AES_key_size_bit_tP7uint8_tAL8E_7uint8_tP7uint8_t">
<span id="_CPPv315AES_GCM_InitCtxP11AES_GCM_CTX12AES_Select_t17AES_GCM_KeyType_t18AES_key_size_bit_tP7uint8_tAL8E_7uint8_tP7uint8_t"></span><span id="_CPPv215AES_GCM_InitCtxP11AES_GCM_CTX12AES_Select_t17AES_GCM_KeyType_t18AES_key_size_bit_tP7uint8_tA8_7uint8_tP7uint8_t"></span><span id="AES_GCM_InitCtx__AES_GCM_CTXP.AES_Select_t.AES_GCM_KeyType_t.AES_key_size_bit_t.uint8_tP.uint8_tA.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1gae5911dfd56f810ce9c6f4157e228b489"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_InitCtx</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <a class="reference internal" href="AES.html#_CPPv412AES_Select_t" title="AES_Select_t"><span class="n"><span class="pre">AES_Select_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">AESSelect</span></span>, <a class="reference internal" href="#_CPPv417AES_GCM_KeyType_t" title="AES_GCM_KeyType_t"><span class="n"><span class="pre">AES_GCM_KeyType_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">keyType</span></span>, <a class="reference internal" href="AES.html#_CPPv418AES_key_size_bit_t" title="AES_key_size_bit_t"><span class="n"><span class="pre">AES_key_size_bit_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">keySize</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Key</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenIV</span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">IV</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415AES_GCM_InitCtxP11AES_GCM_CTX12AES_Select_t17AES_GCM_KeyType_t18AES_key_size_bit_tP7uint8_tAL8E_7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialize an AES GCM context. Choose the underlying AES, the key type and key size. Set the key value. Set the initial value. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[out]</strong> AES GCM context to set </p></li>
<li><p><strong>AESSelect</strong> – <strong>[in]</strong> The underlying AES. Either AES_HARDWARE or AES_SOFTWARE </p></li>
<li><p><strong>keyType</strong> – <strong>[in]</strong> The type of the key: Either KEY_VALUE for explicitly key value or KEY_ID for a key in a key container </p></li>
<li><p><strong>keySize</strong> – <strong>[in]</strong> The size of the key in bits : AES_KEY_128,AES_KEY_192 or AES_KEY_256 </p></li>
<li><p><strong>key</strong> – <strong>[in]</strong> The key value(16 to 32 bytes) or the key ID (first byte) </p></li>
<li><p><strong>lenIV</strong> – <strong>[in]</strong> 8-byte array representing the length in bytes of the IV. E.g uint8_t lenIV[8]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C} indicates a 12 bytes IV. </p></li>
<li><p><strong>IV</strong> – <strong>[in]</strong> Buffer of lenIV byte with the initial value</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_GCM_INCORRECT_KEY_LENGTH</strong> – Incorrect key length </p></li>
<li><p><strong>AES_GCM_INCOMPATIBLE_PARAMETER</strong> – Hardware/software selection is not compatible with the key length </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context to initialize</p></li>
<li><p><strong>AESSelect</strong>: Select the AES hardware or the AES software</p></li>
<li><p><strong>keyType</strong>: Select if the key is given explicitly by value or if it refers by its key container ID.</p></li>
<li><p><strong>keySize</strong>: Key size in bits</p></li>
<li><p><strong>initialCounter</strong> : 16-byte initial counter value</p></li>
<li><dl class="simple">
<dt><strong>key</strong>:</dt><dd><ul>
<li><p>When the key is given explicitly: 16, 24 or 32 bytes representing the key value.</p></li>
<li><p>When the key is given by its ID: 1 byte with the key ID.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>lenIV</strong>: an 8-byte array that indicates the length in bytes of the IV.</p></li>
<li><p><strong>IV</strong>: Initial value of length indicated by lenIV</p></li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type AES_ENC_ONLY(Encryption). The key must not have been invalidated. In case those conditions are not respected, this function returns an error of type AES_Error_t.</p>
</div>
</section>
<section id="return-values">
<h4>Return values<a class="headerlink" href="#return-values" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>Initialization successful</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_INCORRECT_KEY_LENGTH</p></td>
<td><p>Incorrect key length</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_INCOMPATIBLE_PARAMETER</p></td>
<td><p>Hardware AES is not compatible with this key length</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-gcm-hash-additional-data">
<h3>AES_GCM_Hash_Additional_Data<a class="headerlink" href="#aes-gcm-hash-additional-data" title="Permalink to this headline"></a></h3>
<section id="id1">
<h4>Goal of the function<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>This function accumulates data in intermediate buffer and hashes it when the buffer is full.
It performs the Galois Field multiplication.</p>
</section>
<section id="id2">
<h4>Prototype<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428AES_GCM_Hash_Additional_DataP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t">
<span id="_CPPv328AES_GCM_Hash_Additional_DataP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t"></span><span id="_CPPv228AES_GCM_Hash_Additional_DataP11AES_GCM_CTXA8_7uint8_tP7uint8_t"></span><span id="AES_GCM_Hash_Additional_Data__AES_GCM_CTXP.uint8_tA.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1ga2f5ae2872acaa18854347f0a991815d5"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_Hash_Additional_Data</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenA</span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428AES_GCM_Hash_Additional_DataP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Hash the additional data that precedes the data to encrypt/decrypt. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be called several times consecutively with different parts of the additional data. LenA does not represent the total length of the data. It represents the length of the data provided for this call. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be skipped in case there is no additional data. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES GCM </p></li>
<li><p><strong>lenA</strong> – <strong>[in]</strong> 8-byte array representing the length in bytes of the additional data provided at this call. E.g uint8_t lenIV[8]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00} indicates a 256-byte additional data </p></li>
<li><p><strong>A</strong> – <strong>[in]</strong> Buffer of lenA byte with the additional data <p></p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context</p></li>
<li><p><strong>lenA</strong>: Array representing the length in byte of the data provided during this call. It can be any size from 0 byte to 0xFFFFFFFFFFFFFFFF bytes.</p></li>
<li><p><strong>A</strong>: Buffer of lenA bytes with the additional data provided for this call.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This function can:</dt><dd><ul class="simple">
<li><p>be called once with all the additional data.</p></li>
<li><p>be called several times consecutively, providing parts of the additional data only. In that case lenA is the size of the data provided during this call.</p></li>
</ul>
</dd>
</dl>
</div>
</section>
<section id="id4">
<h4>Return values<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>No error, data accumulated</p></td>
<td><p>OK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-gcm-encryptandmac">
<h3>AES_GCM_EncryptAndMAC<a class="headerlink" href="#aes-gcm-encryptandmac" title="Permalink to this headline"></a></h3>
<section id="id5">
<h4>Goal of the function<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<p>This function encrypts the data provided and updates the MAC accordingly.</p>
</section>
<section id="id6">
<h4>Prototype<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421AES_GCM_EncryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t">
<span id="_CPPv321AES_GCM_EncryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t"></span><span id="_CPPv221AES_GCM_EncryptAndMACP11AES_GCM_CTXA8_7uint8_tP7uint8_tP7uint8_t"></span><span id="AES_GCM_EncryptAndMAC__AES_GCM_CTXP.uint8_tA.uint8_tP.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1ga6b675bba8c01280bcc08ca1b7c95de6b"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_EncryptAndMAC</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenP</span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plainText</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cipherText</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421AES_GCM_EncryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Encrpyt the provided plaintext and update the MAC. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be called several times consecutively with different parts of the plaintext. LenP does not represent the total length of the data. It represents the length of the data provided for this call. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES GCM </p></li>
<li><p><strong>lenP</strong> – <strong>[in]</strong> 8-byte array representing the length in bytes of the plaintext data provided at this call. E.g uint8_t lenP[8]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00} indicates a 512-byte plaintext. </p></li>
<li><p><strong>plainText</strong> – <strong>[in]</strong> Buffer of lenP byte with the data to encrypt </p></li>
<li><p><strong>cipherText</strong> – <strong>[out]</strong> Buffer of lenP byte with the encrypted data </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context</p></li>
<li><p><strong>lenP</strong>: Array representing the length in bytes of the plaintext provided during this call. It can be any size from 0 bytes to 0x0000007F FFFFFF00 bytes.</p></li>
<li><p><strong>plainText</strong>: Buffer of lenP bytes with the plaintext to encrypt this call.</p></li>
<li><p><strong>cipherText</strong>: Buffer of lenP bytes receoving the encrypted message.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This function can:</dt><dd><ul class="simple">
<li><p>be called once with the complete plaintext.</p></li>
<li><p>be called several times consecutively, providing parts of the message only. In that case lenP is the size of the data provided during this call.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type AES_ENC_ONLY(Encryption). The key must not have been invalidated. In case those conditions are not respected, this function returns an error of type AES_Error_t.</p>
</div>
</section>
<section id="id8">
<h4>Return values<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>Successful encryption</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_INCORRECT_RESULT_POINTER</p></td>
<td><p>Ciphertext pointer is not initialized</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_INCORRECT_LENGTH</p></td>
<td><p>lenP is too big</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-gcm-decryptandmac">
<h3>AES_GCM_DecryptAndMAC<a class="headerlink" href="#aes-gcm-decryptandmac" title="Permalink to this headline"></a></h3>
<section id="id9">
<h4>Goal of the function<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h4>
<p>This function decrypts the data provided and updates the MAC accordingly.</p>
</section>
<section id="id10">
<h4>Prototype<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421AES_GCM_DecryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t">
<span id="_CPPv321AES_GCM_DecryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t"></span><span id="_CPPv221AES_GCM_DecryptAndMACP11AES_GCM_CTXA8_7uint8_tP7uint8_tP7uint8_t"></span><span id="AES_GCM_DecryptAndMAC__AES_GCM_CTXP.uint8_tA.uint8_tP.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1gaf53cb94a3aa773e6bfd78a15e45b2963"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_DecryptAndMAC</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenC</span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cipherText</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">plainText</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421AES_GCM_DecryptAndMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Decrypt the provided ciphertext and update the MAC. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be called several times consecutively with different parts of the ciphertext. LenC does not represent the total length of the data. It represents the length of the data provided for this call. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES GCM </p></li>
<li><p><strong>lenC</strong> – <strong>[in]</strong> 8-byte array representing the length in bytes of the cipherText data provided at this call. E.g uint8_t lenC[8]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00} indicates a 512-byte plaintext. </p></li>
<li><p><strong>cipherText</strong> – <strong>[in]</strong> Buffer of lenC byte with the data to decrypt </p></li>
<li><p><strong>plainText</strong> – <strong>[out]</strong> Buffer of lenC byte with the decrypted data </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_GCM_INCORRECT_RESULT_POINTER</strong> – Result pointer not initialized </p></li>
<li><p><strong>AES_GCM_INCORRECT_LENGTH</strong> – The length of the message should be snaller than 2^39 -256 = 000000 7F FF FF FF 00 </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id11">
<h4>Parameters<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context</p></li>
<li><p><strong>lenC</strong>: Array representing the length in bytes of the ciphertext provided during this call. It can be any size from 0 byte to 0x0000007F FFFFFF00 bytes.</p></li>
<li><p><strong>cipherText</strong>: Buffer of lenC bytes with the ciphertext to decrypt this call.</p></li>
<li><p><strong>plainText</strong>: Buffer of lenC bytes receiving the decrypted message.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This function can:</dt><dd><ul class="simple">
<li><p>be called once with the complete ciphertext.</p></li>
<li><p>be called several times consecutively, providing parts of the message only. In that case lenC is the size of the data provided during this call.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type <strong>AES_ENC_ONLY(Encryption)</strong>. As the AES is performed in encryption, a key typed <strong>AES_DEC_ONLY(decryption)</strong> would not work. The key must not have been invalidated. In case those conditions are not respected, this function returns an error of type AES_Error_t.</p>
</div>
</section>
<section id="id12">
<h4>Return values<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>Successful decryption</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_INCORRECT_RESULT_POINTER</p></td>
<td><p>plainText pointer is not initialized</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_INCORRECT_LENGTH</p></td>
<td><p>lenC is too big</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-gcm-gmac">
<h3>AES_GCM_GMAC<a class="headerlink" href="#aes-gcm-gmac" title="Permalink to this headline"></a></h3>
<section id="id13">
<h4>Goal of the function<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h4>
<p>This function accumulates data in intermediate buffer and hashes it when the buffer is full.
It performs the Galois Field multiplications for the MAC computation.</p>
</section>
<section id="id14">
<h4>Prototype<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412AES_GCM_GMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t">
<span id="_CPPv312AES_GCM_GMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t"></span><span id="_CPPv212AES_GCM_GMACP11AES_GCM_CTXA8_7uint8_tP7uint8_t"></span><span id="AES_GCM_GMAC__AES_GCM_CTXP.uint8_tA.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1gac775bc0c8357d7f6bd1966def9c26f31"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_GMAC</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenD</span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">8</span></span><span class="p"><span class="pre">]</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412AES_GCM_GMACP11AES_GCM_CTXAL8E_7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Perform a GMAC computation ( GCM mode with no encryption) </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be called several times consecutively with different parts of the additional data. LenD does not represent the total length of the data. It represents the length of the data provided for this call. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES GCM </p></li>
<li><p><strong>lenD</strong> – <strong>[in]</strong> 8-byte array representing the length in bytes of the data provided at this call. E.g uint8_t lenD[8]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00} indicates a 512-byte plaintext. </p></li>
<li><p><strong>data</strong> – <strong>[in]</strong> Buffer of lenD byte with the data to MAC </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_GCM_INCORRECT_RESULT_POINTER</strong> – Result pointer not initialized </p></li>
<li><p><strong>AES_GCM_INCORRECT_LENGTH</strong> – The length of the message should be smaller than 2^39 -256 = 000000 7F FF FF FF 00 </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id15">
<h4>Parameters<a class="headerlink" href="#id15" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context</p></li>
<li><p><strong>lenA</strong>: Array representing the length in bytes of the data provided during this call. It can be any size from 0 byte to 0xFFFFFFFFFFFFFFFF bytes.</p></li>
<li><p><strong>A</strong>: Buffer of lenA bytes with the additional data provided at this call.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This function can:</dt><dd><ul class="simple">
<li><p>be called once with all the additional data.</p></li>
<li><p>be called several times consecutively, providing parts of the additional data only. In that case lenA is the size of the data provided during this call.</p></li>
</ul>
</dd>
</dl>
</div>
</section>
<section id="id16">
<h4>Return values<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>No error, data accumulated</p></td>
<td><p>OK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="aes-gcm-getmac">
<h3>AES_GCM_GetMAC<a class="headerlink" href="#aes-gcm-getmac" title="Permalink to this headline"></a></h3>
<section id="id17">
<h4>Goal of the function<a class="headerlink" href="#id17" title="Permalink to this headline"></a></h4>
<p>This function completes the MAC computation and returns the final MAC.</p>
</section>
<section id="id18">
<h4>Prototype<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414AES_GCM_GetMACP11AES_GCM_CTX7uint8_tP7uint8_t">
<span id="_CPPv314AES_GCM_GetMACP11AES_GCM_CTX7uint8_tP7uint8_t"></span><span id="_CPPv214AES_GCM_GetMACP11AES_GCM_CTX7uint8_tP7uint8_t"></span><span id="AES_GCM_GetMAC__AES_GCM_CTXP.uint8_t.uint8_tP"></span><span class="target" id="group___a_e_s___g_c_m_1ga28227a817227ece393c45cc2f79233dc"></span><a class="reference internal" href="#_CPPv419AES_GCM_Lib_error_t" title="AES_GCM_Lib_error_t"><span class="n"><span class="pre">AES_GCM_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_GCM_GetMAC</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411AES_GCM_CTX" title="AES_GCM_CTX"><span class="n"><span class="pre">AES_GCM_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">lenMAC</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">MAC</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414AES_GCM_GetMACP11AES_GCM_CTX7uint8_tP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Finalize the MAC computation once all the data have been provided. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> AES GCM </p></li>
<li><p><strong>lenMAC</strong> – <strong>[in]</strong> Length in bytes of the MAC. It must be a value in range [4..16]. </p></li>
<li><p><strong>MAC</strong> – <strong>[out]</strong> Buffer to receive the MAC. It must be at least of length LenMAC.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AES_GCM_SUCCESS</strong> – No error occurred </p></li>
<li><p><strong>AES_GCM_INCORRECT_LENGTH</strong> – The MAC length shall be in range [4..16]. </p></li>
<li><p><strong>AES_GCM_INCORRECT_RESULT_POINTER</strong> – MAC pointer not initialized </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error code</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id19">
<h4>Parameters<a class="headerlink" href="#id19" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> : The AES GCM context</p></li>
<li><p><strong>lenMAC</strong>: length in bytes of the desired MAC. It must be a value between 4 and 16.</p></li>
<li><p><strong>MAC</strong>: Buffer to receive the MAC value.</p></li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using a key container, the key must be either of type AES_HW_ENC_DEC (encryption and decryption) or type <strong>AES_ENC_ONLY(Encryption)</strong>. As the AES is performed in encryption, a key typed <strong>AES_DEC_ONLY(decryption)</strong> would not work. The key must not have been invalidated. In case those conditions are not respected, this function returns an error of type AES_Error_t.</p>
</div>
</section>
<section id="id20">
<h4>Return values<a class="headerlink" href="#id20" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_SUCCESS</p></td>
<td><p>No error, data accumulated</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_INCORRECT_LENGTH</p></td>
<td><p>MAC length is incorrect. It should be in [4..16]</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_INCORRECT_RESULT_POINTER</p></td>
<td><p>MAC pointer is not initialized</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="performances">
<h2>Performances<a class="headerlink" href="#performances" title="Permalink to this headline"></a></h2>
<section id="library-location">
<h3>Library location<a class="headerlink" href="#library-location" title="Permalink to this headline"></a></h3>
<p>The lib is located in ROM.</p>
</section>
<section id="code-size">
<h3>Code size<a class="headerlink" href="#code-size" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1672</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ram">
<h3>RAM<a class="headerlink" href="#ram" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No usage of global RAM except the AES_GCM_CTX</p></td>
</tr>
</tbody>
</table>
</section>
<section id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>176 bytes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="execution-time">
<h3>Execution time<a class="headerlink" href="#execution-time" title="Permalink to this headline"></a></h3>
<p>The AES_GCM_InitCtx function performs an AES. Therefore, the time depends on the configuration.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_InitCtx</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_InitCtx</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>129</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_InitCtx</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>153</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_InitCtx</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>171</p></td>
</tr>
</tbody>
</table>
<p>The execution time AES_GCM_Hash_Additional_Data depends on the size of the additional data that is processed during this call.
Because the Galois multiplication is performed on data of 16 bytes, the operation is performed only every 16 bytes. It induces that the number of multiplications is roughly the [NbByte16] or[NbByte16]-1.
The hash of the data does not involve AES so that the key size is not impacting the timing.
Next table shows the time for 16 bytes.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_Hash_Additional_Data</p></td>
<td><p>AES</p></td>
<td><p>Any</p></td>
<td><p>718</p></td>
</tr>
</tbody>
</table>
<p>The function AES_GCM_GMAC is fundamentally the same as AES_GCM_Hash_Additional_Data. The performances are identical.
Next table shows the time for 16 bytes.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_GMAC</p></td>
<td><p>AES</p></td>
<td><p>Any</p></td>
<td><p>718</p></td>
</tr>
</tbody>
</table>
<p>The performance of the function AES_GCM_EncryptAndMAC depends on the size of the plaintext, the underlying AES and also how many bytes were accumulated in the temporary buffer for the MAC computation. It also depends if all the additional data were handled in AES_GCM_Hash_Additional_Data. Globally, one Galois field multiplication and one AES is performed per block of 16 bytes.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_EncryptAndMAC</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>917</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_EncryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>1022</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_EncryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>1046</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_EncryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>1064</p></td>
</tr>
</tbody>
</table>
<p>The performances of the function AES_GCM_DecryptAndMAC are the same for the encryption and mainly depend on the data size. For 16 bytes of data to decrypt we have the following figures:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_DecryptAndMAC</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>917</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_DecryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>1022</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_DecryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>1046</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_DecryptAndMAC</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>1064</p></td>
</tr>
</tbody>
</table>
<p>Finally AES_GCM_GetMAC always involves a Galois field multiplication and an AES computation. It may involves a second multiplication if it was not performed previously in the encrypt\decrypt functions. Below are the figures for the case with 1 multiplication.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Underlying algorithm</p></th>
<th class="head"><p>Key size in bits</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AES_GCM_GetMAC</p></td>
<td><p>AES Hardware</p></td>
<td><p>128</p></td>
<td><p>908</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_GetMAC</p></td>
<td><p>AES Software</p></td>
<td><p>128</p></td>
<td><p>1013</p></td>
</tr>
<tr class="row-even"><td><p>AES_GCM_GetMAC</p></td>
<td><p>AES Software</p></td>
<td><p>192</p></td>
<td><p>1035</p></td>
</tr>
<tr class="row-odd"><td><p>AES_GCM_GetMAC</p></td>
<td><p>AES Software</p></td>
<td><p>256</p></td>
<td><p>1094</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline"></a></h2>
<p>AES GCM lib depends on the AES lib.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>Next code shows basic examples of GCM algorithm</dt><dd><ul class="simple">
<li><p>using the AES hardware with an explicit key</p></li>
<li><p>using the AES hardware with key stored in key containers</p></li>
<li><p>using the AES software</p></li>
<li><p>with various size for the additional data</p></li>
<li><p>with various size of plaintext \ ciphertext</p></li>
</ul>
</dd>
</dl>
<p>It also shows a GMAC example.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @file       ExampleAES_GCM.c</span>
<span class="c1">///</span>
<span class="c1">/// @project    T9305</span>
<span class="c1">///</span>
<span class="c1">/// @author     SAS</span>
<span class="c1">///</span>
<span class="c1">/// @brief   	Example of use of AES GCM library</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @copyright Copyright (C) 2022 EM Microelectronic</span>
<span class="c1">/// @cond</span>
<span class="c1">///</span>
<span class="c1">/// All rights reserved.</span>
<span class="c1">///</span>
<span class="c1">/// Redistribution and use in source and binary forms, with or without</span>
<span class="c1">/// modification, are permitted provided that the following conditions are met:</span>
<span class="c1">/// 1. Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer.</span>
<span class="c1">/// 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">/// and/or other materials provided with the distribution.</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1">/// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1">/// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c1">/// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<span class="c1">/// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c1">/// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c1">/// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c1">/// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c1">/// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c1">/// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="c1">/// POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">/// @endcond</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;AES.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;AES_GCM.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;hw_aes.h&quot;</span><span class="cp"></span>

<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">ExampleAES_GCM</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">	</span><span class="n">AES_GCM_CTX</span><span class="w"> </span><span class="n">ctx</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">AES_GCM_Lib_error_t</span><span class="w"> </span><span class="n">sw</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Cipher</span><span class="p">[</span><span class="mh">0x40</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Decipher</span><span class="p">[</span><span class="mh">0x40</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">MAC</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">keyId</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>

<span class="w">	</span><span class="c1">//test vector with a 128-bit key</span>
<span class="cp">#define TLEN 0x0C</span>
<span class="cp">#define PLEN 0x3C</span>
<span class="cp">#define ALEN 0x14</span>
<span class="cp">#define IVLEN 0x0C</span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Key</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY128</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x94</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Plaintext</span><span class="p">[</span><span class="n">PLEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xD9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0x32</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE5</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xA5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x59</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x26</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA9</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x53</span><span class="p">,</span><span class="w"> </span><span class="mh">0x15</span><span class="p">,</span><span class="w"> </span><span class="mh">0x34</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="mh">0x53</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2F</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xCF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x49</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xED</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xAA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x57</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x39</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Additional</span><span class="p">[</span><span class="n">ALEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x36</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xA8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD5</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x85</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthA</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">ALEN</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthIV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">IVLEN</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">IV</span><span class="p">[</span><span class="n">IVLEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthP</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">PLEN</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="p">[</span><span class="n">PLEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x42</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0x77</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAA</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA4</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x35</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x23</span><span class="p">,</span><span class="w"> </span><span class="mh">0x29</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x14</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x54</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x93</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x7D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x39</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x58</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedMAC</span><span class="p">[</span><span class="n">TLEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xF0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0x28</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFC</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x90</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5E</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//test vector with 192 bit key</span>
<span class="cp">#define TLEN192 0x10</span>
<span class="cp">#define PLEN192 0x40</span>
<span class="cp">#define ALEN192 0x40</span>
<span class="cp">#define IVLEN192 0x0C</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Key192</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x94</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Plaintext192</span><span class="p">[</span><span class="n">PLEN192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xD9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0x32</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xE5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x59</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x26</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA7</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xA9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x53</span><span class="p">,</span><span class="w"> </span><span class="mh">0x15</span><span class="p">,</span><span class="w"> </span><span class="mh">0x34</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8A</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="mh">0x53</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x2F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x49</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xED</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x57</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x39</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xD2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x55</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Additional192</span><span class="p">[</span><span class="n">ALEN192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x36</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x60</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD3</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xD5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x89</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x96</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xFD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x43</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x59</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x23</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xED</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x78</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x5E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span><span class="p">,</span><span class="w"> </span><span class="mh">0x23</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x5D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD4</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthA192</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">ALEN192</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthIV192</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="n">IVLEN192</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">IV192</span><span class="p">[</span><span class="n">IVLEN192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xDE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthP192</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">PLEN192</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedCipher192</span><span class="p">[</span><span class="n">PLEN192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x39</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xE8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x41</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEB</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x87</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0x57</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x9E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x93</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x77</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x44</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC5</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x61</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x47</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE2</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x44</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCC</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xAD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x56</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedMAC192</span><span class="p">[</span><span class="n">TLEN192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="mh">0x53</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x10</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDB</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//test vector with 256 bit key</span>
<span class="cp">#define TLEN256 0x10</span>
<span class="cp">#define ALEN256 0x40</span>
<span class="cp">#define IVLEN256 0x0C</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Key256</span><span class="p">[</span><span class="n">AES_BYTE_SIZE_KEY256</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x94</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x94</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Additional256</span><span class="p">[</span><span class="n">ALEN256</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x36</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x60</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD3</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xD5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x89</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x96</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xFD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x43</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x59</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x23</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xED</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x78</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x5E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span><span class="p">,</span><span class="w"> </span><span class="mh">0x23</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x5D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD4</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthA256</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">			</span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">ALEN256</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthIV256</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="n">IVLEN256</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">IV256</span><span class="p">[</span><span class="n">IVLEN256</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xDE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedMAC256</span><span class="p">[</span><span class="n">TLEN256</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xDE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x34</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDC</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD4</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0xE2</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x44</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// First example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// Perform AES GCM in encryption + MAC mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The key is 128-bit, we use the AES hardware without key container.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// MAC length is 12 bytes. IV length is 12 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The additional data are 20 bytes. The message to encrypt is 60 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The data are encrypted and MAC in one shot</span>
<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">	</span><span class="c1">//Initialization:</span>
<span class="w">	</span><span class="c1">//-using a 128 bit key</span>
<span class="w">	</span><span class="c1">//-not using the key container</span>
<span class="w">	</span><span class="c1">//using AES_HARDWARE</span>
<span class="w">	</span><span class="c1">//the length of the message and the length of the additional data are the total lengths</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HARDWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_GCM_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">LengthIV</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Deal with the additional data in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_Hash_Additional_Data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA</span><span class="p">,</span><span class="w"> </span><span class="n">Additional</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Encrpyt the message in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_EncryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP</span><span class="p">,</span><span class="w"> </span><span class="n">Plaintext</span><span class="p">,</span><span class="w"> </span><span class="n">Cipher</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//get the final MAC</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GetMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">TLEN</span><span class="p">,</span><span class="w"> </span><span class="n">MAC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the result is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="c1">//Check the MAC is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedMAC</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Second example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// Perform AES GCM in decryption + MAC mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The key is 128-bit, we use the AES software</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// MAC length is 12 bytes. IV length is 12 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The additional data are 20 bytes. The message to encrypt is 60 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// We deal with the additional data in two steps(5 bytes then 15 bytes)</span>
<span class="w">	</span><span class="c1">// and we encrypt the message in 3 steps(17, 8 , 35)</span>
<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthA1</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">//Size of the first part of A=5 bytes</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthA2</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">ALEN</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">//Size of the second part of A=20-5=15 bytes</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthP1</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">//Size of the first part of A</span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthP2</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">LengthP3</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="n">PLEN</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">17</span><span class="w"></span>
<span class="w">			</span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Initialization:</span>
<span class="w">	</span><span class="c1">//-using a 128 bit key</span>
<span class="w">	</span><span class="c1">//-not using the key container</span>
<span class="w">	</span><span class="c1">//using AES_SOFTWARE</span>
<span class="w">	</span><span class="c1">//the length of the message and the length of the additional data are the total lengths</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_SOFTWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_GCM_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">LengthIV</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Introduce the first part of the additional data- LengthA1+LengthA2=LengthA</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_Hash_Additional_Data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA1</span><span class="p">,</span><span class="w"> </span><span class="n">Additional</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//Introduce the second part of the additional data</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_Hash_Additional_Data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA2</span><span class="p">,</span><span class="w"> </span><span class="n">Additional</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//decrypt a first part of the cipherLengthP1+LengthP2=LengthP</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_DecryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP1</span><span class="p">,</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="p">,</span><span class="w"> </span><span class="n">Decipher</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//decrypt a first part of the cipher</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_DecryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP2</span><span class="p">,</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">17</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Decipher</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">17</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//decrypt a first part of the cipher</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_DecryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP3</span><span class="p">,</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Decipher</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//get the final MAC</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GetMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">TLEN</span><span class="p">,</span><span class="w"> </span><span class="n">MAC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the result is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Decipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Plaintext</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the MAC is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedMAC</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Third example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// Perform AES GCM in encryption + MAC mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The key is 128-bit, we use the AES hardware WITH key container.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">/// MAC length is 12 bytes. IV length is 12 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The additional data are 20 bytes. The message to encrypt is 60 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The data are encrypted and MAC in one shot</span>
<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>

<span class="w">	</span><span class="c1">//A priori the key has been written previously in a key container.</span>
<span class="w">	</span><span class="c1">//Here we write the key in container 0x05</span>
<span class="w">	</span><span class="n">AES_SetKeyContainer</span><span class="p">((</span><span class="kt">uint32_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HW_ENC_DEC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="n">keyId</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x05</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Initialization:</span>
<span class="w">	</span><span class="c1">//-using a 128 bit key</span>
<span class="w">	</span><span class="c1">//-using the key container</span>
<span class="w">	</span><span class="c1">//using AES_HARDWARE</span>
<span class="w">	</span><span class="c1">//the length of the message and the length of the additional data are the total lengths</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_HARDWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_GCM_KEY_ID</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_128</span><span class="p">,</span><span class="w"> </span><span class="n">keyId</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">LengthIV</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Deal with the additional data in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_Hash_Additional_Data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA</span><span class="p">,</span><span class="w"> </span><span class="n">Additional</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Encrpyt the message in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_EncryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP</span><span class="p">,</span><span class="w"> </span><span class="n">Plaintext</span><span class="p">,</span><span class="w"> </span><span class="n">Cipher</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//get the final MAC</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GetMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">TLEN</span><span class="p">,</span><span class="w"> </span><span class="n">MAC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the result is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedCipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="c1">//Check the MAC is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TLEN</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedMAC</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Fourth example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// Perform AES GCM in encryption + MAC mode</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The key is 192-bit, we use the AES software</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// MAC length is 16 bytes. IV length is 12 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The additional data are 48 bytes. The message to encrpyt is 48 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The data are encrypted and MAC in one shot</span>
<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">//the length of the message and the length of the additional data are the total lengths</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_SOFTWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_GCM_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_192</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Key192</span><span class="p">,</span><span class="w"> </span><span class="n">LengthIV192</span><span class="p">,</span><span class="w"> </span><span class="n">IV192</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Deal with the additional data in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_Hash_Additional_Data</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA192</span><span class="p">,</span><span class="w"> </span><span class="n">Additional192</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Encrpyt the message in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_EncryptAndMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthP192</span><span class="p">,</span><span class="w"> </span><span class="n">Plaintext192</span><span class="p">,</span><span class="w"> </span><span class="n">Cipher</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//get the final MAC</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GetMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">TLEN192</span><span class="p">,</span><span class="w"> </span><span class="n">MAC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the result is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">PLEN192</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Cipher</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedCipher192</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="c1">//Check the MAC is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TLEN192</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedMAC192</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//--------------------------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Fifth example</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// Perform AESGMAC</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The key is 256-bit, we use the AES software</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// MAC length is 16 bytes. IV length is 12 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The additional data are 64 bytes.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// The data are MACed in one shot. Note that we could also perform the AES_GCM_GMAC function</span>
<span class="w">	</span><span class="c1">//in several calls.</span>
<span class="w">	</span><span class="c1">//-------------------------------------------------------------------------- </span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_InitCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">AES_SOFTWARE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_GCM_KEY_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">AES_KEY_256</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="n">Key256</span><span class="p">,</span><span class="w"> </span><span class="n">LengthIV256</span><span class="p">,</span><span class="w"> </span><span class="n">IV256</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//Deal with the additional data in one shot</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">LengthA256</span><span class="p">,</span><span class="w"> </span><span class="n">Additional256</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//get the final MAC</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AES_GCM_GetMAC</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">TLEN256</span><span class="p">,</span><span class="w"> </span><span class="n">MAC</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AES_GCM_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Check the MAC is as expected</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TLEN256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">MAC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedMAC256</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">			</span><span class="n">error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">else</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AES_CCM.html" class="btn btn-neutral float-left" title="AES CCM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="PRNG.html" class="btn btn-neutral float-right" title="PRNG (Pseudo Random Number Generation)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, EM.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>