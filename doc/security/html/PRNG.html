<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PRNG (Pseudo Random Number Generation) &mdash; EM9305 CryptoLib 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ECC Functions" href="ECC_FUNCTIONS.html" />
    <link rel="prev" title="AES GCM" href="AES_GCM.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="index.html" class="icon icon-home"> EM9305 CryptoLib
            <img src="_static/logoEM.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Architecture.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AES.html">AES (one block)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CryptoContainer.html">AES Crypto Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="AESModes.html">AES modes and MAC</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PRNG (Pseudo Random Number Generation)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bibliography">Bibliography</a></li>
<li class="toctree-l2"><a class="reference internal" href="#goal-of-the-document">Goal of the document</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reminder-on-the-random-number-generation">Reminder on the random number generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#need-of-high-quality-random-numbers">Need of high quality random numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-approach">General approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#characterization-and-validation">Characterization and validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#apis">APIs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis-overview">APIs overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options">Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#choice-of-the-hardware-core">Choice of the hardware core</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enabling-or-disabling-the-health-tests">Enabling or disabling the health tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#choice-of-the-underlying-aes">Choice of the underlying AES</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#error-status">Error status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setprngctx">SetPRNGCtx</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#goal-of-the-function">Goal of the function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#function">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#return-values">Return values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initprng">InitPRNG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Goal of the function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Return values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performances">Performances</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remark-on-the-health-tests">Remark on the health tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#getprng">GetPRNG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Goal of the function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remark">Remark</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Return values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Performances</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#general-performances">General Performances</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#library-location">Library location</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-size">Code size</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ram">RAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stack">Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#important-remark">Important remark</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ECC_FUNCTIONS.html">ECC Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="HASH_FUNCTIONS.html">Hash functions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EM9305 CryptoLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>PRNG (Pseudo Random Number Generation)</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="prng-pseudo-random-number-generation">
<h1>PRNG (Pseudo Random Number Generation)<a class="headerlink" href="#prng-pseudo-random-number-generation" title="Permalink to this headline"></a></h1>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline"></a></h2>
<p>[1] NIST SP 800-90A: Recommendation for Random Number Generation Using Deterministic Random Bit Generator</p>
<p><a class="reference external" href="https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final">NIST SP 800-90A</a>:
<a class="reference external" href="https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final">https://csrc.nist.gov/publications/detail/sp/800-22/rev-1a/final</a></p>
<p>[2] NIST SP 800-90B: Recommendation for the Entropy Sources Used for Random Bit Generation</p>
<p><a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf">NIST SP 800-90B</a>
<a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90B.pdf</a></p>
<p>[3] NIST SP 800-90C: Recommendation for Random Bit Generator (RBG) Construction</p>
<p><a class="reference external" href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">NIST SP 800-90C</a>:  <a class="reference external" href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-90c/draft/documents/sp800_90c_second_draft.pdf">https://csrc.nist.gov/CSRC/media/Publications/sp/800-90c/draft/documents/sp800_90c_second_draft.pdf</a></p>
</section>
<section id="goal-of-the-document">
<h2>Goal of the document<a class="headerlink" href="#goal-of-the-document" title="Permalink to this headline"></a></h2>
<p>The goal of this document is to describe the functionality of the <strong>PRNG</strong> library.</p>
<dl class="simple">
<dt>This chapter describes:</dt><dd><ul class="simple">
<li><p>the principle of PRNG, especially the combination of the hardware seed and the software post-treatment.</p></li>
<li><p>all the supported functions offered by the library</p></li>
<li><p>the prototypes of the functions,  the parameters, the error code, etc..</p></li>
<li><p>the performances of the functions.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="reminder-on-the-random-number-generation">
<h2>Reminder on the random number generation<a class="headerlink" href="#reminder-on-the-random-number-generation" title="Permalink to this headline"></a></h2>
<section id="need-of-high-quality-random-numbers">
<h3>Need of high quality random numbers<a class="headerlink" href="#need-of-high-quality-random-numbers" title="Permalink to this headline"></a></h3>
<p>Random numbers generation is a cornerstone primitive for all the cryptographic protocols. Among other usages, random numbers are needed for:</p>
<blockquote>
<div><ul class="simple">
<li><p>Secret key generation</p></li>
<li><p>Cryptographic challenges for authentication</p></li>
<li><p>Salt and nonces generation</p></li>
<li><p>Random initial values</p></li>
<li><p>Etc…</p></li>
</ul>
</div></blockquote>
<p><strong>For that reason, the PRNG.lib aims at providing high quality, i.e. cryptographic quality random numbers.</strong></p>
</section>
<section id="general-approach">
<h3>General approach<a class="headerlink" href="#general-approach" title="Permalink to this headline"></a></h3>
<p>The general approach of EM9305 is to use a mix of hardware random numbers generation and a post processing performed in software.
Next figure shows the general model of the PRNG.</p>
<img alt="_images/PRNG_Principle.png" src="_images/PRNG_Principle.png" />
<dl class="simple">
<dt>2 phases can be distinguished:</dt><dd><ul class="simple">
<li><p>A <strong>first phase</strong> consists in generating random numbers with the <strong>hardware</strong>. This phase exploits physical noise(jitter, thermal noise, etc…). After digitalization, the random numbers generated constitute a seed. This phase is not deterministic.</p></li>
<li><p>The <strong>second phase</strong> consists in <strong>post-processing</strong> the seed, with a software post-treatment based on AES.</p></li>
</ul>
</dd>
</dl>
<p>We chose to be compliant with the NIST standards[1,2,3]. The overall model is compliant with the draft version of NIST SP800-90C[3].  The post-treatment is compliant with NIST SP800-90A[1]. The test of the first phase is compliant with NIST SP800-90B[2].</p>
<dl class="simple">
<dt>Regarding the hardware,four distinct hardware RNG cores are integrated in EM9305:</dt><dd><ul class="simple">
<li><p>Core0</p></li>
<li><p>Core1</p></li>
<li><p>Core2</p></li>
<li><p>Core3.</p></li>
</ul>
</dd>
</dl>
<p>The RNG cores differ by the their oscillators sizes. Core0 is the fastest core and Core3 the slowest one. When initializing the context, one can select the core that is used to seed the RNG (see SetPRNGCtx API )</p>
<p>For the post-treatment we use the DRBG_CTR methodology defined in [1] with AES-128 as underlying algorithm.</p>
<p>Optionally the user can choose to run health tests on the hardware seed. Those tests are defined in [2] and are performed on-line.</p>
</section>
<section id="characterization-and-validation">
<h3>Characterization and validation<a class="headerlink" href="#characterization-and-validation" title="Permalink to this headline"></a></h3>
<dl class="simple">
<dt>The hardware seed is characterized with 3 different statistical tests:</dt><dd><ul class="simple">
<li><p>FIPS 140-1 and FIPS 140-2 ad-hoc statistical test suites</p></li>
<li><p>NIST SP 800-90B [2] statistical tests suite</p></li>
<li><p>NIST SP 800-22 statistical tests suite</p></li>
</ul>
</dd>
<dt>The final outcome after the post-processing is qualified against:</dt><dd><ul class="simple">
<li><p>NIST SP 800-22 statistical test suite.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Permalink to this headline"></a></h2>
<section id="context">
<h3>Context<a class="headerlink" href="#context" title="Permalink to this headline"></a></h3>
<p>A <strong>PRNG_CTX</strong> context structure is defined as the combination of options and working buffers used for the NIST SP 800-90A post-processing.
The structure is as follows.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv48PRNG_CTX">
<span id="_CPPv38PRNG_CTX"></span><span id="_CPPv28PRNG_CTX"></span><span id="PRNG_CTX"></span><span class="target" id="struct_p_r_n_g___c_t_x"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_CTX</span></span></span><a class="headerlink" href="#_CPPv48PRNG_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure of PRNG context </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX9ConfigAESE">
<span id="_CPPv3N8PRNG_CTX9ConfigAESE"></span><span id="_CPPv2N8PRNG_CTX9ConfigAESE"></span><span id="PRNG_CTX::ConfigAES__uint8_t"></span><span class="target" id="struct_p_r_n_g___c_t_x_1ac8cf894a09c2ca4120fb14df14309684"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConfigAES</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX9ConfigAESE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Choose AES SOFTWARE or AES HARDWARE. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX13ConfigRngCoreE">
<span id="_CPPv3N8PRNG_CTX13ConfigRngCoreE"></span><span id="_CPPv2N8PRNG_CTX13ConfigRngCoreE"></span><span id="PRNG_CTX::ConfigRngCore__uint8_t"></span><span class="target" id="struct_p_r_n_g___c_t_x_1ae15f7224ba1cf26d3540d79b41e5da7e"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConfigRngCore</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX13ConfigRngCoreE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Choose the RNG core. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX17ConfigHealthTestsE">
<span id="_CPPv3N8PRNG_CTX17ConfigHealthTestsE"></span><span id="_CPPv2N8PRNG_CTX17ConfigHealthTestsE"></span><span id="PRNG_CTX::ConfigHealthTests__uint8_t"></span><span class="target" id="struct_p_r_n_g___c_t_x_1a5a2d437b4d6766458267c5d09f6059cd"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConfigHealthTests</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX17ConfigHealthTestsE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Enable or disable health tests. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX3rfuE">
<span id="_CPPv3N8PRNG_CTX3rfuE"></span><span id="_CPPv2N8PRNG_CTX3rfuE"></span><span id="PRNG_CTX::rfu__uint8_t"></span><span class="target" id="struct_p_r_n_g___c_t_x_1aebd238d03b91281dd5824207d1d2300e"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rfu</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX3rfuE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Padding. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX10ConfigPRNGE">
<span id="_CPPv3N8PRNG_CTX10ConfigPRNGE"></span><span id="_CPPv2N8PRNG_CTX10ConfigPRNGE"></span><span id="PRNG_CTX::ConfigPRNG__uint32_t"></span><span class="target" id="struct_p_r_n_g___c_t_x_1ac5917f68d5a013bd5003e92528ea006c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ConfigPRNG</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX10ConfigPRNGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Choose the number of bits required to have 256 bits of entropy (256 to 640) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PRNG_CTX7NistCTXE">
<span id="_CPPv3N8PRNG_CTX7NistCTXE"></span><span id="_CPPv2N8PRNG_CTX7NistCTXE"></span><span id="PRNG_CTX::NistCTX__PRNG_NIST_CTX"></span><span class="target" id="struct_p_r_n_g___c_t_x_1a39daa5286bfb1325807b7ce4fd95cf43"></span><a class="reference internal" href="#_CPPv413PRNG_NIST_CTX" title="PRNG_NIST_CTX"><span class="n"><span class="pre">PRNG_NIST_CTX</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">NistCTX</span></span></span><a class="headerlink" href="#_CPPv4N8PRNG_CTX7NistCTXE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG NIST context. </p>
</dd></dl>

</div>
</dd></dl>

<p>The NIST working buffer is structured as 3 working buffers:</p>
<blockquote>
<div><ul class="simple">
<li><p>a key</p></li>
<li><p>a value V</p></li>
<li><p>a counter</p></li>
</ul>
</div></blockquote>
<p>The exact structure is given by the PRNG_NIST_CTX.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv413PRNG_NIST_CTX">
<span id="_CPPv313PRNG_NIST_CTX"></span><span id="_CPPv213PRNG_NIST_CTX"></span><span id="PRNG_NIST_CTX"></span><span class="target" id="struct_p_r_n_g___n_i_s_t___c_t_x"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_NIST_CTX</span></span></span><a class="headerlink" href="#_CPPv413PRNG_NIST_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>Structure of PRNG NIST context </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_NIST_CTX3KeyE">
<span id="_CPPv3N13PRNG_NIST_CTX3KeyE"></span><span id="_CPPv2N13PRNG_NIST_CTX3KeyE"></span><span id="PRNG_NIST_CTX::Key__uint32_tA"></span><span class="target" id="struct_p_r_n_g___n_i_s_t___c_t_x_1a6f79c6edc69a525da109c9b406998edb"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Key</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">4</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N13PRNG_NIST_CTX3KeyE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG context key value. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_NIST_CTX1VE">
<span id="_CPPv3N13PRNG_NIST_CTX1VE"></span><span id="_CPPv2N13PRNG_NIST_CTX1VE"></span><span id="PRNG_NIST_CTX::V__uint32_tA"></span><span class="target" id="struct_p_r_n_g___n_i_s_t___c_t_x_1a37e10e89c17b726ae7882ed3800e3457"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">4</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N13PRNG_NIST_CTX1VE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG context internal state. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_NIST_CTX12ResetCounterE">
<span id="_CPPv3N13PRNG_NIST_CTX12ResetCounterE"></span><span id="_CPPv2N13PRNG_NIST_CTX12ResetCounterE"></span><span id="PRNG_NIST_CTX::ResetCounter__uint32_t"></span><span class="target" id="struct_p_r_n_g___n_i_s_t___c_t_x_1aa19a7f99ac4d62818020fb58ec63850c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ResetCounter</span></span></span><a class="headerlink" href="#_CPPv4N13PRNG_NIST_CTX12ResetCounterE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG’s number of uses since last reseeding or reset. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="apis-overview">
<h3>APIs overview<a class="headerlink" href="#apis-overview" title="Permalink to this headline"></a></h3>
<dl class="simple">
<dt>Basically:</dt><dd><ul class="simple">
<li><p>The function <strong>SetPRNGCtx</strong> allows to set the options of the context.</p></li>
<li><p>The function <strong>InitPRNG</strong> aims at initializing the NIST context.</p></li>
<li><p>The function <strong>GetPRNG</strong> exploits the context and generates strong random numbers.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h3>
<section id="choice-of-the-hardware-core">
<span id="prng-core-label"></span><h4>Choice of the hardware core<a class="headerlink" href="#choice-of-the-hardware-core" title="Permalink to this headline"></a></h4>
<p>The choice of the hardware core is performed with PRNG_Core_t enumeration:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv411PRNG_Core_t">
<span id="_CPPv311PRNG_Core_t"></span><span id="_CPPv211PRNG_Core_t"></span><span class="target" id="group___p_r_n_g_1ga01073c54eef7ae3af04a6553fba0ff70"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_Core_t</span></span></span><a class="headerlink" href="#_CPPv411PRNG_Core_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Selection of the Hardware RNG core </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11PRNG_Core_t19HW_DEFAULT_RNG_COREE">
<span id="_CPPv3N11PRNG_Core_t19HW_DEFAULT_RNG_COREE"></span><span id="_CPPv2N11PRNG_Core_t19HW_DEFAULT_RNG_COREE"></span><span class="target" id="group___p_r_n_g_1gga01073c54eef7ae3af04a6553fba0ff70aca52c71cfa323d6930dd59003ebda523"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HW_DEFAULT_RNG_CORE</span></span></span><a class="headerlink" href="#_CPPv4N11PRNG_Core_t19HW_DEFAULT_RNG_COREE" title="Permalink to this definition"></a><br /></dt>
<dd><p>RNG default core is core 2. After characterization, core 2 shows better random quality. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11PRNG_Core_t6CORE_0E">
<span id="_CPPv3N11PRNG_Core_t6CORE_0E"></span><span id="_CPPv2N11PRNG_Core_t6CORE_0E"></span><span class="target" id="group___p_r_n_g_1gga01073c54eef7ae3af04a6553fba0ff70a079f1742ac442d4e4dd33c816257b39e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CORE_0</span></span></span><a class="headerlink" href="#_CPPv4N11PRNG_Core_t6CORE_0E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Core 0. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11PRNG_Core_t6CORE_1E">
<span id="_CPPv3N11PRNG_Core_t6CORE_1E"></span><span id="_CPPv2N11PRNG_Core_t6CORE_1E"></span><span class="target" id="group___p_r_n_g_1gga01073c54eef7ae3af04a6553fba0ff70ac60cdaad26caf9e5ae125dea1019d832"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CORE_1</span></span></span><a class="headerlink" href="#_CPPv4N11PRNG_Core_t6CORE_1E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Core 1. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11PRNG_Core_t6CORE_2E">
<span id="_CPPv3N11PRNG_Core_t6CORE_2E"></span><span id="_CPPv2N11PRNG_Core_t6CORE_2E"></span><span class="target" id="group___p_r_n_g_1gga01073c54eef7ae3af04a6553fba0ff70a91869a3fb7181c3865b0e712f66b30fd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CORE_2</span></span></span><a class="headerlink" href="#_CPPv4N11PRNG_Core_t6CORE_2E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Core 2. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N11PRNG_Core_t6CORE_3E">
<span id="_CPPv3N11PRNG_Core_t6CORE_3E"></span><span id="_CPPv2N11PRNG_Core_t6CORE_3E"></span><span class="target" id="group___p_r_n_g_1gga01073c54eef7ae3af04a6553fba0ff70a397b11b84d6a43a8d48f947d0c744228"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CORE_3</span></span></span><a class="headerlink" href="#_CPPv4N11PRNG_Core_t6CORE_3E" title="Permalink to this definition"></a><br /></dt>
<dd><p>Core 3. </p>
</dd></dl>

</dd></dl>

</section>
<section id="enabling-or-disabling-the-health-tests">
<span id="prng-ht-label"></span><h4>Enabling or disabling the health tests<a class="headerlink" href="#enabling-or-disabling-the-health-tests" title="Permalink to this headline"></a></h4>
<p>The enabling or disabling of the health tests is performed with the PRNG_Health_t enumeration:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv413PRNG_Health_t">
<span id="_CPPv313PRNG_Health_t"></span><span id="_CPPv213PRNG_Health_t"></span><span class="target" id="group___p_r_n_g_1gacb879612112a33215a68b9957035a650"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_Health_t</span></span></span><a class="headerlink" href="#_CPPv413PRNG_Health_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Health tests performed on the hardware RNG sequence </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_Health_t20DISABLE_HEALTH_TESTSE">
<span id="_CPPv3N13PRNG_Health_t20DISABLE_HEALTH_TESTSE"></span><span id="_CPPv2N13PRNG_Health_t20DISABLE_HEALTH_TESTSE"></span><span class="target" id="group___p_r_n_g_1ggacb879612112a33215a68b9957035a650aa8c236422a935d326568f070e2f22cdf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DISABLE_HEALTH_TESTS</span></span></span><a class="headerlink" href="#_CPPv4N13PRNG_Health_t20DISABLE_HEALTH_TESTSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Health tests disabled. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_Health_t19ENABLE_HEALTH_TESTSE">
<span id="_CPPv3N13PRNG_Health_t19ENABLE_HEALTH_TESTSE"></span><span id="_CPPv2N13PRNG_Health_t19ENABLE_HEALTH_TESTSE"></span><span class="target" id="group___p_r_n_g_1ggacb879612112a33215a68b9957035a650aac686e00e2f46f36602c4579c25121ea"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ENABLE_HEALTH_TESTS</span></span></span><a class="headerlink" href="#_CPPv4N13PRNG_Health_t19ENABLE_HEALTH_TESTSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Health tests enabled. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N13PRNG_Health_t27HEALTH_TESTS_DEFAULT_CONFIGE">
<span id="_CPPv3N13PRNG_Health_t27HEALTH_TESTS_DEFAULT_CONFIGE"></span><span id="_CPPv2N13PRNG_Health_t27HEALTH_TESTS_DEFAULT_CONFIGE"></span><span class="target" id="group___p_r_n_g_1ggacb879612112a33215a68b9957035a650afccc919e5664473bfa56c24228db53da"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HEALTH_TESTS_DEFAULT_CONFIG</span></span></span><a class="headerlink" href="#_CPPv4N13PRNG_Health_t27HEALTH_TESTS_DEFAULT_CONFIGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Health tests default configuration. </p>
</dd></dl>

</dd></dl>

</section>
<section id="choice-of-the-underlying-aes">
<span id="prng-aes-label"></span><h4>Choice of the underlying AES<a class="headerlink" href="#choice-of-the-underlying-aes" title="Permalink to this headline"></a></h4>
<p>The choice of the underlying AES is performed with PRNG_AES_t:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv410PRNG_AES_t">
<span id="_CPPv310PRNG_AES_t"></span><span id="_CPPv210PRNG_AES_t"></span><span class="target" id="group___p_r_n_g_1ga747e49856d7f23f8362b82947d1dc9df"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_AES_t</span></span></span><a class="headerlink" href="#_CPPv410PRNG_AES_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Underlying AES for the post processing. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N10PRNG_AES_t17AES_PRNG_HARDWAREE">
<span id="_CPPv3N10PRNG_AES_t17AES_PRNG_HARDWAREE"></span><span id="_CPPv2N10PRNG_AES_t17AES_PRNG_HARDWAREE"></span><span class="target" id="group___p_r_n_g_1gga747e49856d7f23f8362b82947d1dc9dfad3a393697aba00165136bdeebe33f6b2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_PRNG_HARDWARE</span></span></span><a class="headerlink" href="#_CPPv4N10PRNG_AES_t17AES_PRNG_HARDWAREE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES Hardware. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N10PRNG_AES_t17AES_PRNG_SOFTWAREE">
<span id="_CPPv3N10PRNG_AES_t17AES_PRNG_SOFTWAREE"></span><span id="_CPPv2N10PRNG_AES_t17AES_PRNG_SOFTWAREE"></span><span class="target" id="group___p_r_n_g_1gga747e49856d7f23f8362b82947d1dc9dfa9c093c93894d90e95006fff1b429d062"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AES_PRNG_SOFTWARE</span></span></span><a class="headerlink" href="#_CPPv4N10PRNG_AES_t17AES_PRNG_SOFTWAREE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES Software. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N10PRNG_AES_t26HW_PRNG_DEFAULT_AES_CONFIGE">
<span id="_CPPv3N10PRNG_AES_t26HW_PRNG_DEFAULT_AES_CONFIGE"></span><span id="_CPPv2N10PRNG_AES_t26HW_PRNG_DEFAULT_AES_CONFIGE"></span><span class="target" id="group___p_r_n_g_1gga747e49856d7f23f8362b82947d1dc9dfae0d78cc2686a5d8a398e472ee3a305cf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HW_PRNG_DEFAULT_AES_CONFIG</span></span></span><a class="headerlink" href="#_CPPv4N10PRNG_AES_t26HW_PRNG_DEFAULT_AES_CONFIGE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Default AES is the AES hardware. </p>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="error-status">
<span id="prng-error-label"></span><h3>Error status<a class="headerlink" href="#error-status" title="Permalink to this headline"></a></h3>
<p>The status of the functions is of type PRNG_Lib_error_t:</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv416PRNG_Lib_error_t">
<span id="_CPPv316PRNG_Lib_error_t"></span><span id="_CPPv216PRNG_Lib_error_t"></span><span class="target" id="group___p_r_n_g_1ga4c9d06d23c4ec09c80d6ad0b9dbb9b16"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PRNG_Lib_error_t</span></span></span><a class="headerlink" href="#_CPPv416PRNG_Lib_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Error status for PRNG lib </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t10SW_PRNG_OKE">
<span id="_CPPv3N16PRNG_Lib_error_t10SW_PRNG_OKE"></span><span id="_CPPv2N16PRNG_Lib_error_t10SW_PRNG_OKE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16af137fded68bd36803214bd13188dfdfd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_OK</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t10SW_PRNG_OKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>AES computation successful. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t31SW_PRNG_HEALTH_REPETITIVE_ERRORE">
<span id="_CPPv3N16PRNG_Lib_error_t31SW_PRNG_HEALTH_REPETITIVE_ERRORE"></span><span id="_CPPv2N16PRNG_Lib_error_t31SW_PRNG_HEALTH_REPETITIVE_ERRORE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16a17b61da7eaf53b266fed0825016eee74"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_HEALTH_REPETITIVE_ERROR</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t31SW_PRNG_HEALTH_REPETITIVE_ERRORE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Repetitive health test failed. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t29SW_PRNG_HEALTH_ADAPTIVE_ERRORE">
<span id="_CPPv3N16PRNG_Lib_error_t29SW_PRNG_HEALTH_ADAPTIVE_ERRORE"></span><span id="_CPPv2N16PRNG_Lib_error_t29SW_PRNG_HEALTH_ADAPTIVE_ERRORE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16add7d903110a5f24c9332181601713aa7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_HEALTH_ADAPTIVE_ERROR</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t29SW_PRNG_HEALTH_ADAPTIVE_ERRORE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Adaptive health test failed. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t11SW_PRNG_NOKE">
<span id="_CPPv3N16PRNG_Lib_error_t11SW_PRNG_NOKE"></span><span id="_CPPv2N16PRNG_Lib_error_t11SW_PRNG_NOKE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16a4b65610a5fd6612c4d63282eb6ebca46"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_NOK</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t11SW_PRNG_NOKE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG initialization not OK. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t32SW_PRNG_INCORRECT_RESULT_POINTERE">
<span id="_CPPv3N16PRNG_Lib_error_t32SW_PRNG_INCORRECT_RESULT_POINTERE"></span><span id="_CPPv2N16PRNG_Lib_error_t32SW_PRNG_INCORRECT_RESULT_POINTERE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16a88810f0d259a0cd90382a472d2b0546f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_INCORRECT_RESULT_POINTER</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t32SW_PRNG_INCORRECT_RESULT_POINTERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Result pointer is not initialized. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16PRNG_Lib_error_t23SW_PRNG_NOT_INITIALIZEDE">
<span id="_CPPv3N16PRNG_Lib_error_t23SW_PRNG_NOT_INITIALIZEDE"></span><span id="_CPPv2N16PRNG_Lib_error_t23SW_PRNG_NOT_INITIALIZEDE"></span><span class="target" id="group___p_r_n_g_1gga4c9d06d23c4ec09c80d6ad0b9dbb9b16a8ef5d72beecf7fcbf9dc5965a8e0407e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SW_PRNG_NOT_INITIALIZED</span></span></span><a class="headerlink" href="#_CPPv4N16PRNG_Lib_error_t23SW_PRNG_NOT_INITIALIZEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>PRNG was not initialized. Execute InitPRNG first. </p>
</dd></dl>

</dd></dl>

</section>
<section id="setprngctx">
<h3>SetPRNGCtx<a class="headerlink" href="#setprngctx" title="Permalink to this headline"></a></h3>
<section id="goal-of-the-function">
<h4>Goal of the function<a class="headerlink" href="#goal-of-the-function" title="Permalink to this headline"></a></h4>
<p>The function sets the context options. This function only sets the parameters of the context. It does not generate any random number.</p>
</section>
<section id="function">
<h4>Function<a class="headerlink" href="#function" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410SetPRNGCtxP8PRNG_CTX10PRNG_AES_t11PRNG_Core_t8uint32_t13PRNG_Health_t">
<span id="_CPPv310SetPRNGCtxP8PRNG_CTX10PRNG_AES_t11PRNG_Core_t8uint32_t13PRNG_Health_t"></span><span id="_CPPv210SetPRNGCtxP8PRNG_CTX10PRNG_AES_t11PRNG_Core_t8uint32_t13PRNG_Health_t"></span><span id="SetPRNGCtx__PRNG_CTXP.PRNG_AES_t.PRNG_Core_t.uint32_t.PRNG_Health_t"></span><span class="target" id="group___p_r_n_g_1gaa29bad9978b437c52eb6f7ab76b67bbd"></span><a class="reference internal" href="#_CPPv416PRNG_Lib_error_t" title="PRNG_Lib_error_t"><span class="n"><span class="pre">PRNG_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetPRNGCtx</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv48PRNG_CTX" title="PRNG_CTX"><span class="n"><span class="pre">PRNG_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Ctx</span></span>, <a class="reference internal" href="#_CPPv410PRNG_AES_t" title="PRNG_AES_t"><span class="n"><span class="pre">PRNG_AES_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">AESSelect</span></span>, <a class="reference internal" href="#_CPPv411PRNG_Core_t" title="PRNG_Core_t"><span class="n"><span class="pre">PRNG_Core_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">CoreSelect</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">PRNGConfig</span></span>, <a class="reference internal" href="#_CPPv413PRNG_Health_t" title="PRNG_Health_t"><span class="n"><span class="pre">PRNG_Health_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">HealthTests</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410SetPRNGCtxP8PRNG_CTX10PRNG_AES_t11PRNG_Core_t8uint32_t13PRNG_Health_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the configuration parameters of a PRNG context. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SetPRNGCtx only defines the parameters. It does not pick any random hardware number and does not initialize the NIST SP800-90A context. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ctx</strong> – <strong>[out]</strong> Context of the PRNG </p></li>
<li><p><strong>AESSelect</strong> – <strong>[in]</strong> Select the underlying AES (AES_HARDWARE or AES_SOFTWARE) </p></li>
<li><p><strong>CoreSelect</strong> – <strong>[in]</strong> Select the underlying hardware RNG core (from 0 to 3) </p></li>
<li><p><strong>PRNGConfig</strong> – <strong>[in]</strong> Choose the number of bits required to have 256 bits of entropy (256 to 640) </p></li>
<li><p><strong>HealthTests</strong> – <strong>[in]</strong> Determine if the health tests will be enabled or not </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>SW_PRNG_OK</strong> – PRNG setting successful </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h4>
<p>The context can be configured with 4 options:</p>
<ol class="arabic simple">
<li><p><strong>ConfigRngCore:</strong> The RNG hardware core can be selected. EM9305 embeds four different RNG cores: Core0, Core1, Core2 and Core3. After characterization of EM9305, Core2 appears to be the best option. The core should be selected among the options defined here: <a class="reference internal" href="#prng-core-label"><span class="std std-ref">Choice of the hardware core</span></a></p></li>
<li><p><strong>ConfigAES:</strong> The underlying AES can be selected:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Either the AES-128 Software is selected</p></li>
<li><p>Or the AES-128 Hardware is selected</p></li>
</ul>
</div></blockquote>
<p>For best performances, AES hardware will be preferably chosen. Nonetheless, one may prefer the AES software to reduce the peak power consumption. Options are defined here <a class="reference internal" href="#prng-aes-label"><span class="std std-ref">Choice of the underlying AES</span></a></p>
<ol class="arabic simple" start="3">
<li><p><strong>ConfigHealthTests:</strong> The health tests can be enabled or disabled. To be compliant with NIST SP800-90B, health tests shall be performed. Options are defined here: <a class="reference internal" href="#prng-ht-label"><span class="std std-ref">Enabling or disabling the health tests</span></a></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>When the health tests are enabled, 512 bytes hardware random numbers must be picked during the initialization.</p></li>
<li><p>When the health tests are disabled, the number of hardware random bytes to pick depends on the entropy of the hardware random numbers. 32 to 80 bytes are required.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Health tests check that there is no catastrophic default in the hardware generation of the random numbers.</p>
</div>
<ol class="arabic simple" start="4">
<li><p><strong>ConfigPRNG:</strong> The entropy per bit of the hardware random generator.  Depending on the entropy of the hardware generator, one needs to pick more or less hardware random  numbers to set up the context.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>If the entropy is perfect (=1), 32 hardware random bytes are sufficient to initialize the context.</p></li>
<li><p>If the entropy is not perfect(&lt;1), more than 32 hardware random bytes are necessary.</p></li>
</ul>
</div></blockquote>
<p>ConfigPRNG should be set to the value: 256/(Entropy per bit).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The entropy is determined during the hardware characterization. It is assumed that the entropy is not worst case 0.4.
When the health tests are enabled, the hardware random numbers are taken among the 512 bytes generated for the health tests.
Depending on the entropy, the number of AES which are performed during the initialization is more or less important.
<strong>We recommend to use the default value HW_DEFAULT_ENTROPY_PER_BIT=0.8</strong></p>
</div>
</section>
<section id="return-values">
<h4>Return values<a class="headerlink" href="#return-values" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SW_PRNG_OK</p></td>
<td><p>Setting was successful</p></td>
<td><p>OK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="initprng">
<h3>InitPRNG<a class="headerlink" href="#initprng" title="Permalink to this headline"></a></h3>
<section id="id1">
<h4>Goal of the function<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>The function sets the context PRNG_NIST_CTX.
It consists in 3 phases:</p>
<ol class="arabic simple">
<li><p>Generation of random values with the hardware random generator.</p></li>
<li><p>Optionally, test the quality of the hardware random numbers (i.e. Health tests)</p></li>
<li><p>Post process the hardware random numbers with AES to generate the initial context (V,Key). The counter is also set to null value during this phase.</p></li>
</ol>
<p>Next figure illustrates the context initialization phase in function of the parameter.</p>
<img alt="_images/PRNG_Init.png" src="_images/PRNG_Init.png" />
</section>
<section id="id2">
<h4>Function<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48InitPRNGP8PRNG_CTXP7uint8_t">
<span id="_CPPv38InitPRNGP8PRNG_CTXP7uint8_t"></span><span id="_CPPv28InitPRNGP8PRNG_CTXP7uint8_t"></span><span id="InitPRNG__PRNG_CTXP.uint8_tP"></span><span class="target" id="group___p_r_n_g_1gaadaaf8f9c87820974a9fedc20967b8ce"></span><a class="reference internal" href="#_CPPv416PRNG_Lib_error_t" title="PRNG_Lib_error_t"><span class="n"><span class="pre">PRNG_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InitPRNG</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv48PRNG_CTX" title="PRNG_CTX"><span class="n"><span class="pre">PRNG_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">MAC</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48InitPRNGP8PRNG_CTXP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes the PRNG. Pick hardware random numbers to initialize the NIST SP800-90A context. Perform the health tests if required. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PRNG must be (re)initialized when the PRNG context has been lost. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ctx</strong> – <strong>[in]</strong> Context of the PRNG </p></li>
<li><p><strong>MAC</strong> – <strong>[in]</strong> A specific string of the device. MAC should be 6 bytes long </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SW_PRNG_OK</strong> – Successful initialization </p></li>
<li><p><strong>SW_PRNG_HEALTH_REPETITIVE_ERROR</strong> – Repetitive health test failed </p></li>
<li><p><strong>SW_PRNG_HEALTH_ADAPTIVE_ERROR</strong> – Adaptive health test failed </p></li>
<li><p><strong>SW_PRNG_NOK</strong> – Something went wrong with underlying AES</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong> A PRNG context</p></li>
<li><p><strong>MAC</strong> A 6-byte value. <strong>MAC</strong> is used as a diversifier to ensure that even if the hardware is stuck, two devices would not produce the same random numbers. The BLE MAC address is appropriate for the <strong>MAC</strong> parameter but any other device specific value is also suitable.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id4">
<h4>Return values<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SW_PRNG_OK</p></td>
<td><p>Initialization was successful</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>SW_PRNG_HEALTH_REPETITIVE_ERROR</p></td>
<td><p>Repetitive health test detected an issue. Too many successive hardware random numbers were identical.</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>SW_PRNG_HEALTH_ADAPTIVE_ERROR</p></td>
<td><p>Adaptive health test detected an issue. The distribution of the hardware random is not correct.</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-odd"><td><p>SW_PRNG_NOK</p></td>
<td><p>Something went wrong in initialization.</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>This function must be called at least once.</strong></p>
<p>However, once the context has been initialized, there is no need to call this function anymore until the <strong>next reset</strong>.</p>
<p>After a reset, the context is lost. Therefore, it must be reinitialized.</p>
</div>
</section>
<section id="performances">
<h4>Performances<a class="headerlink" href="#performances" title="Permalink to this headline"></a></h4>
<p>The execution time of the function InitPRNG depends on the parameters. The number of hardware random numbers that are drawed depends on the entropy and whether the health tests are enabled or not. The number of AES performed depends on the entropy. The performances are obviously better when the AES hardware is used.
Next table shows the number of hardware random numbers that are picked, the number of AES executed and the execution time for each configuration.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Health tests enabled</p></th>
<th class="head"><p>Entropy of the HW RNG</p></th>
<th class="head"><p>AES</p></th>
<th class="head"><p>Number of Hardware random numbers to pick</p></th>
<th class="head"><p>Number of AES to perform</p></th>
<th class="head"><p>Time in us to generate the HW random numbers</p></th>
<th class="head"><p>Time to execute the health tests</p></th>
<th class="head"><p>Time for AES</p></th>
<th class="head"><p>Total time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>NO</p></td>
<td><p>1</p></td>
<td><p>HW</p></td>
<td><p>32</p></td>
<td><p>2</p></td>
<td><p>118</p></td>
<td><p>0</p></td>
<td><p>59</p></td>
<td><p>177</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>NO</p></td>
<td><p>0.8</p></td>
<td><p>HW</p></td>
<td><p>40</p></td>
<td><p>14</p></td>
<td><p>148</p></td>
<td><p>0</p></td>
<td><p>415</p></td>
<td><p>563</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>NO</p></td>
<td><p>0.4</p></td>
<td><p>HW</p></td>
<td><p>80</p></td>
<td><p>32</p></td>
<td><p>295</p></td>
<td><p>0</p></td>
<td><p>949</p></td>
<td><p>1244</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>NO</p></td>
<td><p>1</p></td>
<td><p>SW</p></td>
<td><p>32</p></td>
<td><p>2</p></td>
<td><p>118</p></td>
<td><p>0</p></td>
<td><p>500</p></td>
<td><p>618</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>NO</p></td>
<td><p>0.8</p></td>
<td><p>SW</p></td>
<td><p>40</p></td>
<td><p>14</p></td>
<td><p>148</p></td>
<td><p>0</p></td>
<td><p>3500</p></td>
<td><p>3648</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>NO</p></td>
<td><p>0.4</p></td>
<td><p>SW</p></td>
<td><p>80</p></td>
<td><p>32</p></td>
<td><p>295</p></td>
<td><p>0</p></td>
<td><p>8000</p></td>
<td><p>8295</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>YES</p></td>
<td><p>1</p></td>
<td><p>HW</p></td>
<td><p>512</p></td>
<td><p>2</p></td>
<td><p>1890</p></td>
<td><p>125</p></td>
<td><p>59</p></td>
<td><p>2074</p></td>
</tr>
<tr class="row-odd"><td><p><strong>8</strong></p></td>
<td><p><strong>YES</strong></p></td>
<td><p><strong>0.8</strong></p></td>
<td><p><strong>HW</strong></p></td>
<td><p><strong>512</strong></p></td>
<td><p><strong>14</strong></p></td>
<td><p><strong>1890</strong></p></td>
<td><p><strong>125</strong></p></td>
<td><p><strong>415</strong></p></td>
<td><p><strong>2430</strong></p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>YES</p></td>
<td><p>0.4</p></td>
<td><p>HW</p></td>
<td><p>512</p></td>
<td><p>32</p></td>
<td><p>1890</p></td>
<td><p>125</p></td>
<td><p>949</p></td>
<td><p>2964</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>YES</p></td>
<td><p>1</p></td>
<td><p>SW</p></td>
<td><p>512</p></td>
<td><p>2</p></td>
<td><p>1890</p></td>
<td><p>125</p></td>
<td><p>500</p></td>
<td><p>2515</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>YES</p></td>
<td><p>0.8</p></td>
<td><p>SW</p></td>
<td><p>512</p></td>
<td><p>14</p></td>
<td><p>1890</p></td>
<td><p>125</p></td>
<td><p>3500</p></td>
<td><p>5515</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>YES</p></td>
<td><p>0.4</p></td>
<td><p>SW</p></td>
<td><p>512</p></td>
<td><p>32</p></td>
<td><p>1890</p></td>
<td><p>125</p></td>
<td><p>8000</p></td>
<td><p>10015</p></td>
</tr>
</tbody>
</table>
<p>The <strong>configuration 8</strong> is the preferred configuration.</p>
</section>
<section id="remark-on-the-health-tests">
<h4>Remark on the health tests<a class="headerlink" href="#remark-on-the-health-tests" title="Permalink to this headline"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the health tests detect a weakness on the hardware random numbers, a new set of hardware random numbers is picked.
There are <strong>three</strong> trials. If after the three trials, the health tests still fail <strong>InitPRNG</strong> returns an error status.
In that case the PRNG_NIST_CTX is <strong>not</strong> set. It should be considered as a major failure of the chip.</p>
</div>
</section>
</section>
<section id="getprng">
<h3>GetPRNG<a class="headerlink" href="#getprng" title="Permalink to this headline"></a></h3>
<section id="id5">
<h4>Goal of the function<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<p>This function generates random values. Internally, it modifies the context according to the specification NIST SP 800-90 A and returns random values issued from a post-treatment on the PRNG context.</p>
<p>This function can be called consecutively 0xFFFFFFFF times without resetting the context.</p>
<p>This function does not pick any random values coming from the true hardware random generator. It is a purely deterministic operation.</p>
<p>The process is illustrated in next figure:</p>
<img alt="_images/PRNG_Get.png" src="_images/PRNG_Get.png" />
</section>
<section id="id6">
<h4>Function<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47GetPRNGP8PRNG_CTX8uint32_tP8uint32_t">
<span id="_CPPv37GetPRNGP8PRNG_CTX8uint32_tP8uint32_t"></span><span id="_CPPv27GetPRNGP8PRNG_CTX8uint32_tP8uint32_t"></span><span id="GetPRNG__PRNG_CTXP.uint32_t.uint32_tP"></span><span class="target" id="group___p_r_n_g_1gae4f6d7356afb0dccaa946a12635542f5"></span><a class="reference internal" href="#_CPPv416PRNG_Lib_error_t" title="PRNG_Lib_error_t"><span class="n"><span class="pre">PRNG_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetPRNG</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv48PRNG_CTX" title="PRNG_CTX"><span class="n"><span class="pre">PRNG_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Ctx</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">NumberOfWords</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Random</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47GetPRNGP8PRNG_CTX8uint32_tP8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Generates random values with the PRNG. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PRNG must be (re)initialized when the PRNG context has been lost. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ctx</strong> – <strong>[in]</strong> PRNG Ctx </p></li>
<li><p><strong>NumberOfWords</strong> – <strong>[in]</strong> Number of 32-bit words to generate. </p></li>
<li><p><strong>Random</strong> – <strong>[out]</strong> A buffer of NumberOfWords x 32 bits that receives the random values. </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SW_PRNG_OK</strong> – Successful generation </p></li>
<li><p><strong>SW_PRNG_INCORRECT_RESULT_POINTER</strong> – Result buffer not initialized. </p></li>
<li><p><strong>SW_PRNG_NOT_INITIALIZED</strong> – The PRNG was not initialized. Execute InitPRNG first </p></li>
<li><p><strong>SW_PRNG_NOK</strong> – Something went wrong with underlying AE </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p><strong>Ctx</strong>: A context PRNG</p></li>
<li><p><strong>NumberOfWords</strong>:  Number of desired 32-bit long random words.</p></li>
<li><p><strong>Random</strong>: Pointer on the result buffer.</p></li>
</ul>
</div></blockquote>
</section>
<section id="remark">
<h4>Remark<a class="headerlink" href="#remark" title="Permalink to this headline"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Internally, the post treatment generates 16 bytes of random numbers per loop iteration. It results that the optimal <strong>NumberOfWords</strong> required is a multiple of 4. For instance, it would be more efficient to call GetPRNG with NumberOfWords=4, rather than 4 times GetPRNG with NumberOfWords=1.</p>
<p>Also there is a penalty of 2 AES executions, at each call of the GetPRNG function. Therefore it would be more efficient to require several words in one time, rather than calling the function multiple times for the same amount of random numbers.</p>
</div>
</section>
<section id="id8">
<h4>Return values<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SW_PRNG_OK</p></td>
<td><p>Initialization was successful</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>SW_PRNG_INCORRECT_RESULT_POINTER</p></td>
<td><p>Null pointer.</p></td>
<td><p>NOK</p></td>
</tr>
<tr class="row-even"><td><p>SW_PRNG_NOK</p></td>
<td><p>Something went wrong in the post-processing.</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id9">
<h4>Performances<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h4>
<p>The performances of GetPRNG depend on the underlying AES and the number of desired words.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Number of 32-bit words</p></th>
<th class="head"><p>Number of bits</p></th>
<th class="head"><p>Number of AESs performed</p></th>
<th class="head"><p>Time in us with AES HW</p></th>
<th class="head"><p>Time in us with AES SW</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2</p></td>
<td><p>64</p></td>
<td><p>3</p></td>
<td><p>86</p></td>
<td><p>750</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>128</p></td>
<td><p>3</p></td>
<td><p>86</p></td>
<td><p>750</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>256</p></td>
<td><p>4</p></td>
<td><p>115</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>384</p></td>
<td><p>5</p></td>
<td><p>143</p></td>
<td><p>1250</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>512</p></td>
<td><p>6</p></td>
<td><p>172</p></td>
<td><p>1500</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>640</p></td>
<td><p>7</p></td>
<td><p>201</p></td>
<td><p>1750</p></td>
</tr>
<tr class="row-even"><td><p>32</p></td>
<td><p>1024</p></td>
<td><p>10</p></td>
<td><p>287</p></td>
<td><p>2500</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="general-performances">
<h2>General Performances<a class="headerlink" href="#general-performances" title="Permalink to this headline"></a></h2>
<section id="library-location">
<h3>Library location<a class="headerlink" href="#library-location" title="Permalink to this headline"></a></h3>
<p>The lib is located in ROM.</p>
</section>
<section id="code-size">
<h3>Code size<a class="headerlink" href="#code-size" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2172 bytes in ROM</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ram">
<h3>RAM<a class="headerlink" href="#ram" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>44 bytes per context</p></td>
</tr>
</tbody>
</table>
</section>
<section id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TBD</p></td>
</tr>
</tbody>
</table>
</section>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline"></a></h3>
<p><strong>PRNG</strong> depends on the AES library.</p>
</section>
</section>
<section id="important-remark">
<h2>Important remark<a class="headerlink" href="#important-remark" title="Permalink to this headline"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>PRNG_CTX shall be located in persistent RAM</strong>. Otherwise, the PRNG context will be lost whenever the part goes to sleep mode.</p>
<p>If the context is in persistent RAM, it is enough to invoke InitPRNG only after a reset.</p>
</div>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<p>Next code provides a basic example of use.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//--------------------------------------------------------------------------------------</span>
<span class="c1">//</span>
<span class="c1">// FILE : Example_PRNG.c</span>
<span class="c1">//</span>
<span class="c1">// Goal : Basic example of PRNG use</span>
<span class="c1">//--------------------------------------------------------------------------------------</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;AES.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;PRNG.h&quot;</span><span class="cp"></span>

<span class="c1">//======================================================================================</span>
<span class="c1">//						Example</span>
<span class="c1">//======================================================================================</span>

<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">Example_PRNG</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">PRNG_Lib_error_t</span><span class="w"> </span><span class="n">SW</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Random1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Random2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Create a PRNG context- WARNING it should be located in persistent RAM</span>
<span class="w">	</span><span class="n">PRNG_CTX</span><span class="w"> </span><span class="n">Ctx</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Choose the options for this PRNG context</span>
<span class="w">	</span><span class="n">SetPRNGCtx</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="n">HW_PRNG_DEFAULT_AES_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">HW_DEFAULT_RNG_CORE</span><span class="p">,</span><span class="w"></span>
<span class="w">	</span><span class="n">HW_PRNG_DEFAULT_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="n">HEALTH_TESTS_DEFAULT_CONFIG</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Alternatively, we could set the context directly without the help of setPRNGCtx function</span>
<span class="w">	</span><span class="c1">//Ctx.ConfigRngCore = HW_DEFAULT_RNG_CORE;</span>
<span class="w">	</span><span class="c1">//Ctx.ConfigPRNG = HW_PRNG_DEFAULT_CONFIG;</span>
<span class="w">	</span><span class="c1">//Ctx.ConfigAES = HW_PRNG_DEFAULT_AES_CONFIG;</span>
<span class="w">	</span><span class="c1">//Ctx.ConfigHealthTests = HEALTH_TESTS_DEFAULT_CONFIG;</span>

<span class="w">	</span><span class="c1">//Test MAC address</span>
<span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">MAC1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x01</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//The PRNG MUST to be initialized once per session, i.e . when the context is lost (RAM erased, reset...)</span>
<span class="w">	</span><span class="n">SW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitPRNG</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">MAC1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SW_PRNG_OK</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Let&#39;s generate some random data</span>
<span class="w">	</span><span class="n">SW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetPRNG</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Random1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SW_PRNG_OK</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="n">SW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetPRNG</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Ctx</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Random2</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SW_PRNG_OK</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//let&#39;s check if they are different</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">Random1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">Random2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">Random1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Random2</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">Error</span><span class="p">);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AES_GCM.html" class="btn btn-neutral float-left" title="AES GCM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ECC_FUNCTIONS.html" class="btn btn-neutral float-right" title="ECC Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, EM.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>