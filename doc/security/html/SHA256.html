<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SHA256 &mdash; EM9305 CryptoLib 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SHA384" href="SHA384.html" />
    <link rel="prev" title="SHA224" href="SHA224.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
            <a href="index.html" class="icon icon-home"> EM9305 CryptoLib
            <img src="_static/logoEM.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Architecture.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="AES.html">AES (one block)</a></li>
<li class="toctree-l1"><a class="reference internal" href="CryptoContainer.html">AES Crypto Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="AESModes.html">AES modes and MAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="PRNG.html">PRNG (Pseudo Random Number Generation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="ECC_FUNCTIONS.html">ECC Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="HASH_FUNCTIONS.html">Hash functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="SHA1.html">SHA-1</a></li>
<li class="toctree-l2"><a class="reference internal" href="SHA224.html">SHA224</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SHA256</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bibliography">Bibliography</a></li>
<li class="toctree-l3"><a class="reference internal" href="#goal-of-the-document">Goal of the document</a></li>
<li class="toctree-l3"><a class="reference internal" href="#types-of-apis">Types of APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#apis">APIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defines">Defines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#one-shot-computation-function-sha256-api">ONE SHOT COMPUTATION FUNCTION : SHA256 API</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#function">Function</a></li>
<li class="toctree-l5"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#return-values">Return values</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#step-by-step-functions">STEP BY STEP FUNCTIONS</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#goal-of-the-functions">Goal of the functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sha256init">SHA256Init</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id1">Function</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#id2">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id3">Return values</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sha256update">SHA256Update</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id4">Function</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#id5">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id6">Return values</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sha256final">SHA256Final</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#id7">Function</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#id8">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="#id9">Return values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performances">Performances</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#library-location">Library location</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-size">Code size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ram">RAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack">Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-time">Execution time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SHA384.html">SHA384</a></li>
<li class="toctree-l2"><a class="reference internal" href="SHA512.html">SHA512</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EM9305 CryptoLib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="HASH_FUNCTIONS.html">Hash functions</a> &raquo;</li>
      <li>SHA256</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sha256">
<span id="sha256-label"></span><h1>SHA256<a class="headerlink" href="#sha256" title="Permalink to this headline"></a></h1>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline"></a></h2>
<p>[1] FIPS 180-4: Secure Hash Standard</p>
<p><a class="reference external" href="https://csrc.nist.gov/publications/detail/fips/180/4/final">FIPS 180-4</a>: <a class="reference external" href="https://csrc.nist.gov/publications/detail/fips/180/4/final">https://csrc.nist.gov/publications/detail/fips/180/4/final</a></p>
</section>
<section id="goal-of-the-document">
<h2>Goal of the document<a class="headerlink" href="#goal-of-the-document" title="Permalink to this headline"></a></h2>
<p>The goal of this document is to describe the functionality of the library <strong>SHA256</strong>.
It describes:</p>
<blockquote>
<div><ul class="simple">
<li><p>the supported functions,</p></li>
<li><p>the parameters of the functions,</p></li>
<li><p>the error cases,</p></li>
<li><p>the performances of the functions.</p></li>
</ul>
</div></blockquote>
<p>This library implements SHA256 algorithm according to the specification FIPS 180-4 [1].</p>
</section>
<section id="types-of-apis">
<h2>Types of APIs<a class="headerlink" href="#types-of-apis" title="Permalink to this headline"></a></h2>
<p>It implements two sets of APIs:</p>
<blockquote>
<div><ul class="simple">
<li><p>A first API allows to perform SHA256 in one shot: the message and its size are provided and the function computes the digest in one shot.</p></li>
<li><p>A second set of APIs allows to provide the data to hash block by block. The computation of the digest can be performed step by step, accumulating data until the final processing.</p></li>
</ul>
</div></blockquote>
</section>
<section id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Permalink to this headline"></a></h2>
<section id="enumerations">
<h3>Enumerations<a class="headerlink" href="#enumerations" title="Permalink to this headline"></a></h3>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv418SHA256_Lib_error_t">
<span id="_CPPv318SHA256_Lib_error_t"></span><span id="_CPPv218SHA256_Lib_error_t"></span><span class="target" id="group___s_h_a256_1ga6932b17d9d1103ed3c5c5fadcd2b20cd"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_Lib_error_t</span></span></span><a class="headerlink" href="#_CPPv418SHA256_Lib_error_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Error status words for SHA256. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N18SHA256_Lib_error_t14SHA256_SUCCESSE">
<span id="_CPPv3N18SHA256_Lib_error_t14SHA256_SUCCESSE"></span><span id="_CPPv2N18SHA256_Lib_error_t14SHA256_SUCCESSE"></span><span class="target" id="group___s_h_a256_1gga6932b17d9d1103ed3c5c5fadcd2b20cdac6d876d90319dcda57bef7b349b15f1a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_SUCCESS</span></span></span><a class="headerlink" href="#_CPPv4N18SHA256_Lib_error_t14SHA256_SUCCESSE" title="Permalink to this definition"></a><br /></dt>
<dd><p>SHA256 computation successful. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N18SHA256_Lib_error_t31SHA256_INCORRECT_RESULT_POINTERE">
<span id="_CPPv3N18SHA256_Lib_error_t31SHA256_INCORRECT_RESULT_POINTERE"></span><span id="_CPPv2N18SHA256_Lib_error_t31SHA256_INCORRECT_RESULT_POINTERE"></span><span class="target" id="group___s_h_a256_1gga6932b17d9d1103ed3c5c5fadcd2b20cda262be99ba077d2f9658b33b998ffc7fa"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_INCORRECT_RESULT_POINTER</span></span></span><a class="headerlink" href="#_CPPv4N18SHA256_Lib_error_t31SHA256_INCORRECT_RESULT_POINTERE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Result pointer is null. </p>
</dd></dl>

</dd></dl>

</section>
<section id="defines">
<h3>Defines<a class="headerlink" href="#defines" title="Permalink to this headline"></a></h3>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SHA256_DIGEST_SIZE">
<span class="target" id="group___s_h_a256_1ga81efbc0fc101b06a914f7ff9e2fbc0e9"></span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_DIGEST_SIZE</span></span></span><a class="headerlink" href="#c.SHA256_DIGEST_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Digest size for SHA256 in bytes </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.SHA256_BLOCK_SIZE">
<span class="target" id="group___s_h_a256_1ga9c1fe69ad43d4ca74b84303a0ed64f2f"></span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_BLOCK_SIZE</span></span></span><a class="headerlink" href="#c.SHA256_BLOCK_SIZE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Block size for SHA256 in bytes </p>
</dd></dl>

</section>
<section id="one-shot-computation-function-sha256-api">
<h3>ONE SHOT COMPUTATION FUNCTION : SHA256 API<a class="headerlink" href="#one-shot-computation-function-sha256-api" title="Permalink to this headline"></a></h3>
<p>This function computes the SHA256 digest of a data of any length. The computation is performed in one-shot. Next figure shows the general scheme.</p>
<img alt="_images/SHA256_oneStep.png" src="_images/SHA256_oneStep.png" />
<section id="function">
<h4>Function<a class="headerlink" href="#function" title="Permalink to this headline"></a></h4>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46SHA256P7uint8_tP7uint8_t8uint32_t">
<span id="_CPPv36SHA256P7uint8_tP7uint8_t8uint32_t"></span><span id="_CPPv26SHA256P7uint8_tP7uint8_t8uint32_t"></span><span id="SHA256__uint8_tP.uint8_tP.uint32_t"></span><span class="target" id="group___s_h_a256_1gacbba550f2b0d72830f9a35f12d99f64a"></span><a class="reference internal" href="#_CPPv418SHA256_Lib_error_t" title="SHA256_Lib_error_t"><span class="n"><span class="pre">SHA256_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Message</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Result</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">MessageLength</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46SHA256P7uint8_tP7uint8_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Computes the hash of the message with SHA256. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Message</strong> – <strong>[in]</strong> Message to hash </p></li>
<li><p><strong>Result</strong> – <strong>[out]</strong> Digest of the message </p></li>
<li><p><strong>MessageLength</strong> – <strong>[in]</strong> Message length in bytes </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SHA256_SUCCESS</strong> – Successful computation </p></li>
<li><p><strong>SHA256_INCORRECT_RESULT_POINTER</strong> – Result buffer not initialized </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>Message</strong> : The message to hash. It can be of any length.</p></li>
<li><p><strong>Result</strong>: Pointer on the 32-byte result.</p></li>
<li><p><strong>MessageLength</strong> : Length of the message in bytes. It can be any value from 0x00(included) to 0xFFFFFFFF (included).</p></li>
</ul>
</section>
<section id="return-values">
<h4>Return values<a class="headerlink" href="#return-values" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHA256_SUCCESS</p></td>
<td><p>SHA256 computation successful.</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>SHA256_INCORRECT_RESULT_POINTER</p></td>
<td><p>Result pointer is null.</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="step-by-step-functions">
<h3>STEP BY STEP FUNCTIONS<a class="headerlink" href="#step-by-step-functions" title="Permalink to this headline"></a></h3>
<section id="goal-of-the-functions">
<h4>Goal of the functions<a class="headerlink" href="#goal-of-the-functions" title="Permalink to this headline"></a></h4>
<p>According to [1] SHA256 algorithm is performed in several steps.</p>
<blockquote>
<div><ul class="simple">
<li><p>The first step consists in initializing a context of 32 bytes with known constants.</p></li>
<li><p>The second step consists in splitting the data to hash into blocks of 64 bytes. Each block is processed to update the context.</p></li>
<li><p>Finally the data to hash is padded with a fix pattern and the data length. The context is updated accordingly. The digest consists in the last value of the 32-byte context.</p></li>
</ul>
</div></blockquote>
<p>The step by step functions allow to perform SHA256 in several steps. Especially it permits to provide the data by block of any size.</p>
<p>The set of functions is constituted of 3 functions:</p>
<blockquote>
<div><ul class="simple">
<li><p>An initialization function that initializes the context.</p></li>
<li><p>An update function that accumulates the input data and processes the data as soon as 64 bytes are accumulated.</p></li>
<li><p>A final function that performs the padding and computes the final digest.</p></li>
</ul>
</div></blockquote>
<p>Next image shows the principle of the step by step functions:</p>
<blockquote>
<div><img alt="_images/SHA256_Steps.png" src="_images/SHA256_Steps.png" />
</div></blockquote>
</section>
<section id="context">
<h4>Context<a class="headerlink" href="#context" title="Permalink to this headline"></a></h4>
<p>SHA256_CTX is a structure that accumulates the intermediate data necessary to the hash computation.
It is defined as follows in SHA256_CTX.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv410SHA256_CTX">
<span id="_CPPv310SHA256_CTX"></span><span id="_CPPv210SHA256_CTX"></span><span id="SHA256_CTX"></span><span class="target" id="struct_s_h_a256___c_t_x"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256_CTX</span></span></span><a class="headerlink" href="#_CPPv410SHA256_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>SHA256 context </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10SHA256_CTX4HashE">
<span id="_CPPv3N10SHA256_CTX4HashE"></span><span id="_CPPv2N10SHA256_CTX4HashE"></span><span id="SHA256_CTX::Hash__uint32_tA"></span><span class="target" id="struct_s_h_a256___c_t_x_1a9f4f3262b562cf3242d33ad0bb1b02c2"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Hash</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">SHA256_DIGEST_SIZE</span></span><span class="w"> </span><span class="o"><span class="pre">/</span></span><span class="w"> </span><span class="m"><span class="pre">4</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N10SHA256_CTX4HashE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Digest buffer </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10SHA256_CTX5BlockE">
<span id="_CPPv3N10SHA256_CTX5BlockE"></span><span id="_CPPv2N10SHA256_CTX5BlockE"></span><span id="SHA256_CTX::Block__uint8_tA"></span><span class="target" id="struct_s_h_a256___c_t_x_1a919f4ec213b991a56514def5536aa19c"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Block</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">SHA256_BLOCK_SIZE</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv4N10SHA256_CTX5BlockE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Working buffer to accumulate data to hash </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10SHA256_CTX10MessageLenE">
<span id="_CPPv3N10SHA256_CTX10MessageLenE"></span><span id="_CPPv2N10SHA256_CTX10MessageLenE"></span><span id="SHA256_CTX::MessageLen__uint32_t"></span><span class="target" id="struct_s_h_a256___c_t_x_1ad9121b21aaf11d9c7c47c21b92f5b3d5"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MessageLen</span></span></span><a class="headerlink" href="#_CPPv4N10SHA256_CTX10MessageLenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Size in bytes of the message accumulated till now </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N10SHA256_CTX5IndexE">
<span id="_CPPv3N10SHA256_CTX5IndexE"></span><span id="_CPPv2N10SHA256_CTX5IndexE"></span><span id="SHA256_CTX::Index__uint8_t"></span><span class="target" id="struct_s_h_a256___c_t_x_1ae9b95b33aef78c4e2ae05282a95b498a"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index</span></span></span><a class="headerlink" href="#_CPPv4N10SHA256_CTX5IndexE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Size of the data accumulated in the Block buffer </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="sha256init">
<h4>SHA256Init<a class="headerlink" href="#sha256init" title="Permalink to this headline"></a></h4>
<section id="id1">
<h5>Function<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h5>
<p>This function initializes a SHA256 computation. It initializes the SHA256_CTX.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410SHA256InitP10SHA256_CTX">
<span id="_CPPv310SHA256InitP10SHA256_CTX"></span><span id="_CPPv210SHA256InitP10SHA256_CTX"></span><span id="SHA256Init__SHA256_CTXP"></span><span class="target" id="group___s_h_a256_1ga65af3ea3aeb6ec04aaea9c5f8f382029"></span><a class="reference internal" href="#_CPPv418SHA256_Lib_error_t" title="SHA256_Lib_error_t"><span class="n"><span class="pre">SHA256_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256Init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410SHA256_CTX" title="SHA256_CTX"><span class="n"><span class="pre">SHA256_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410SHA256InitP10SHA256_CTX" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initializes a SHA256 computation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ctx</strong> – <strong>[out]</strong> SHA256 context </p>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>SHA256_SUCCESS</strong> – Successful initialization </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="id2">
<h4>Parameters<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>ctx</strong> : a SHA256 context</p></li>
</ul>
</section>
<section id="id3">
<h4>Return values<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHA256_SUCCESS</p></td>
<td><p>SHA256 successfully initialized.</p></td>
<td><p>OK</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sha256update">
<h4>SHA256Update<a class="headerlink" href="#sha256update" title="Permalink to this headline"></a></h4>
<section id="id4">
<h5>Function<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h5>
<p>This function processes the data provided by pbInput buffer. It accumulates the data in the context until the block is full (64 bytes). If the block is full, the data is hashed and the 32-byte long context is updated. The inputLength can be any size from 0x00(included) to 0xFFFFFFFF(included).
One will usually call SHA256Update several times. All the bytes of the message must be processed SHA256Update, including the potential incomplete block. On the other hand, the padding should not be provided to SHA256Update.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412SHA256UpdateP10SHA256_CTXP7uint8_t8uint32_t">
<span id="_CPPv312SHA256UpdateP10SHA256_CTXP7uint8_t8uint32_t"></span><span id="_CPPv212SHA256UpdateP10SHA256_CTXP7uint8_t8uint32_t"></span><span id="SHA256Update__SHA256_CTXP.uint8_tP.uint32_t"></span><span class="target" id="group___s_h_a256_1ga9631b41d8fe3855c75b12bf87539fc17"></span><a class="reference internal" href="#_CPPv418SHA256_Lib_error_t" title="SHA256_Lib_error_t"><span class="n"><span class="pre">SHA256_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256Update</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410SHA256_CTX" title="SHA256_CTX"><span class="n"><span class="pre">SHA256_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pbInput</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">InputLength</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412SHA256UpdateP10SHA256_CTXP7uint8_t8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Updates the context with the data given in input. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[inout]</strong> SHA-256 context </p></li>
<li><p><strong>pbInput</strong> – <strong>[in]</strong> data to hash </p></li>
<li><p><strong>InputLength</strong> – <strong>[inout]</strong> Length of the data pointed by pbInput (in bytes) </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>SHA256_SUCCESS</strong> – Successful computation </p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>ctx</strong> : a SHA256 context that was initialized previously</p></li>
<li><p><strong>pbInput</strong> : data to hash of length InputLength</p></li>
<li><p><strong>InputLength</strong> : length in bytes of the data (from 0x00 to 0xFFFFFFFF)</p></li>
</ul>
</section>
<section id="id6">
<h4>Return values<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHA256_SUCCESS</p></td>
<td><p>SHA256 update successful.</p></td>
<td><p>OK</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sha256final">
<h4>SHA256Final<a class="headerlink" href="#sha256final" title="Permalink to this headline"></a></h4>
<section id="id7">
<h5>Function<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h5>
<p>SHA256Final adds the final padding and processes the context a final time to produce the digest.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411SHA256FinalP10SHA256_CTXP7uint8_t">
<span id="_CPPv311SHA256FinalP10SHA256_CTXP7uint8_t"></span><span id="_CPPv211SHA256FinalP10SHA256_CTXP7uint8_t"></span><span id="SHA256Final__SHA256_CTXP.uint8_tP"></span><span class="target" id="group___s_h_a256_1gae22200f9395454989af4414e8d125bec"></span><a class="reference internal" href="#_CPPv418SHA256_Lib_error_t" title="SHA256_Lib_error_t"><span class="n"><span class="pre">SHA256_Lib_error_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SHA256Final</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv410SHA256_CTX" title="SHA256_CTX"><span class="n"><span class="pre">SHA256_CTX</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">ctx</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pbResult</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411SHA256FinalP10SHA256_CTXP7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Finalizes the hash computation and returns the result. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – <strong>[in]</strong> SHA256 context </p></li>
<li><p><strong>pbResult</strong> – <strong>[out]</strong> Final digest (32 bytes) </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>SHA256_SUCCESS</strong> – Successful computation </p></li>
<li><p><strong>SHA256_INCORRECT_RESULT_POINTER</strong> – Result buffer not initialized </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Error status </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p><strong>ctx</strong> : a SHA256 context that was initialized previously</p></li>
<li><p><strong>pbResult</strong> : pointer on the 32-byte hash digest</p></li>
</ul>
</section>
<section id="id9">
<h4>Return values<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h4>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 28%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>OK \ NOK</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SHA256_SUCCESS</p></td>
<td><p>SHA256 update successful</p></td>
<td><p>OK</p></td>
</tr>
<tr class="row-odd"><td><p>SHA256_INCORRECT_RESULT_POINTER</p></td>
<td><p>pbResult is null pointer</p></td>
<td><p>NOK</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="performances">
<h2>Performances<a class="headerlink" href="#performances" title="Permalink to this headline"></a></h2>
<section id="library-location">
<h3>Library location<a class="headerlink" href="#library-location" title="Permalink to this headline"></a></h3>
<p>The lib is located in ROM.</p>
</section>
<section id="code-size">
<h3>Code size<a class="headerlink" href="#code-size" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>948 bytes in ROM for the SHA256 module</p></td>
</tr>
<tr class="row-odd"><td><p>In addition, the generic hash framework is 564 bytes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ram">
<h3>RAM<a class="headerlink" href="#ram" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No usage of global RAM except the SHA256_CTX</p></td>
</tr>
</tbody>
</table>
</section>
<section id="stack">
<h3>Stack<a class="headerlink" href="#stack" title="Permalink to this headline"></a></h3>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size in bytes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Approximatively 334 bytes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="execution-time">
<h3>Execution time<a class="headerlink" href="#execution-time" title="Permalink to this headline"></a></h3>
<p>The execution time of SHA256 naturally depends on the length of the message to hash.
The data being processed by blocks of 64 bytes, the time will essentially depend on the number of 64-byte blocks the message has. Nonetheless for small data, one will take care that, due to the padding, an extra block may be added.</p>
<p>The next table shows the number of processed block(s) for various message lengths as example.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data length in bytes</p></th>
<th class="head"><p>Number of processed blocks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>55</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>56</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>57</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>63</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>64</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>128</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>1024</p></td>
<td><p>17</p></td>
</tr>
</tbody>
</table>
<p>The performances of each function are given in the next table.</p>
<p>For the SHA256Update, besides the fact that it depends on the data length, it also depends on the amount of data already accumulated. The process of an extra 64-byte block may be necessary or not.</p>
<p>For the SHA256Final, 1 or 2 blocks must be processed depending on the overall length of the data to digest.</p>
<p>For the SHA256 API, it also depends on the data length.
All together, the processing time of one 64-byte block is the most relevant figure.</p>
<p>Next table gives some examples of execution time.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Number of cycles</p></th>
<th class="head"><p>Time in us at 48Mhz</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Process of 1 64-byte block</p></td>
<td><p>5531</p></td>
<td><p>115</p></td>
</tr>
<tr class="row-odd"><td><p>SHA256Init</p></td>
<td><p>115</p></td>
<td><p>2.3</p></td>
</tr>
<tr class="row-even"><td><p>SHA256Update(for 64 bytes)</p></td>
<td><p>5531</p></td>
<td><p>115</p></td>
</tr>
<tr class="row-odd"><td><p>SHA256Final(for 1 block processed)</p></td>
<td><p>4940</p></td>
<td><p>102</p></td>
</tr>
<tr class="row-even"><td><p>SHA256(for 112 bytes)</p></td>
<td><p>11298</p></td>
<td><p>235</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline"></a></h2>
<p>SHA256 lib depends on the generic hash framework library <strong>hash.lib</strong>.</p>
<p>Note that SHA224 and SHA256 algorithms are included in the same library.</p>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @file       ExampleSHA256.c</span>
<span class="c1">///</span>
<span class="c1">/// @project    T9305</span>
<span class="c1">///</span>
<span class="c1">/// @author     SAS</span>
<span class="c1">///</span>
<span class="c1">/// @brief   	Example of use of SHA256 library</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// @copyright Copyright (C) 2022 EM Microelectronic</span>
<span class="c1">/// @cond</span>
<span class="c1">///</span>
<span class="c1">/// All rights reserved.</span>
<span class="c1">///</span>
<span class="c1">/// Redistribution and use in source and binary forms, with or without</span>
<span class="c1">/// modification, are permitted provided that the following conditions are met:</span>
<span class="c1">/// 1. Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer.</span>
<span class="c1">/// 2. Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">/// this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">/// and/or other materials provided with the distribution.</span>
<span class="c1">///</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">///</span>
<span class="c1">/// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1">/// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1">/// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c1">/// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<span class="c1">/// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c1">/// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c1">/// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c1">/// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c1">/// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c1">/// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="c1">/// POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">/// @endcond</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;SHA256.h&quot;</span><span class="cp"></span>

<span class="cm">/*******************************************************************************</span>
<span class="cm"> Function: ExampleSHA256</span>

<span class="cm"> Basic example of use of the SHA256 library</span>

<span class="cm"> Return:</span>
<span class="cm"> 0 if everything is ok</span>
<span class="cm"> 1 otherwise</span>

<span class="cm"> Remark 1:</span>
<span class="cm"> SHA256 uses the generic hash Engine SHA_ARC.lib. Therefore, to call SHA256 one needs:</span>
<span class="cm"> - SHA_ARC.lib</span>
<span class="cm"> - SHA224_256_ARC.lib</span>

<span class="cm"> Remark 2:</span>
<span class="cm"> Two kinds of APIs are supported:</span>
<span class="cm"> * SHA256 API allows to perform a SHA256 hash in one step</span>
<span class="cm"> * SHA256Init, SHA256Update, SHA256Final allow to hash a message step by step.</span>

<span class="cm"> *******************************************************************************/</span><span class="w"></span>
<span class="kt">uint8_t</span><span class="w"> </span><span class="nf">ExampleSHA256</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Digest</span><span class="p">[</span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">];</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">SHA256_CTX</span><span class="w"> </span><span class="n">MyCtx</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="n">SHA256_Lib_error_t</span><span class="w"> </span><span class="n">sw</span><span class="p">;</span><span class="w"></span>

<span class="cp">#define MESSAGE_LEN 112</span>

<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">Message</span><span class="p">[</span><span class="n">MESSAGE_LEN</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x61</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x6a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6d</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6e</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x6f</span><span class="p">,</span><span class="w"> </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x75</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">ExpectedResult</span><span class="p">[</span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xcf</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w"> </span><span class="mh">0xa7</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x78</span><span class="p">,</span><span class="w"> </span><span class="mh">0xaf</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6c</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9e</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x37</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9b</span><span class="p">,</span><span class="w"> </span><span class="mh">0x11</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xf0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">,</span><span class="w"> </span><span class="mh">0x51</span><span class="p">,</span><span class="w"> </span><span class="mh">0xaf</span><span class="p">,</span><span class="w"> </span><span class="mh">0xac</span><span class="p">,</span><span class="w"></span>
<span class="w">			</span><span class="mh">0x45</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7a</span><span class="p">,</span><span class="w"> </span><span class="mh">0xfe</span><span class="p">,</span><span class="w"> </span><span class="mh">0xe9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xd1</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Example 1: we perform the computation in one step</span>
<span class="w">	</span><span class="c1">//--------------------------------------------------</span>
<span class="w">	</span><span class="c1">//perform the computation in one step</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256</span><span class="p">((</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">Message</span><span class="p">,</span><span class="w"> </span><span class="n">Digest</span><span class="p">,</span><span class="w"> </span><span class="n">MESSAGE_LEN</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">//compare the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Digest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedResult</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Example 2: we perform the computation in several steps</span>
<span class="w">	</span><span class="c1">//------------------------------------------------------</span>
<span class="w">	</span><span class="c1">// Note that in the two following examples, the size of the cuts message is purely</span>
<span class="w">	</span><span class="c1">// arbitrary for the sake of examples. Any size, including 0 is allowed.</span>

<span class="w">	</span><span class="c1">//Example 2a. We first perform the update 64 bytes per 64 bytes.</span>
<span class="w">	</span><span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="w">	</span><span class="c1">//init</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//accumulate and perform computation of first 64 bytes</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Update</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Message</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//continue on the next 112-64 following bytes</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Update</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Message</span><span class="p">[</span><span class="mi">64</span><span class="p">],</span><span class="w"> </span><span class="n">MESSAGE_LEN</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//finalize the computation and get the result</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Final</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">,</span><span class="w"> </span><span class="n">Digest</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//compare the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Digest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedResult</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//Example 2b. We first perform the update 16 bytes per 16 bytes.</span>
<span class="w">	</span><span class="c1">//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="w">	</span><span class="c1">//init</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="c1">//accumulate and perform computation on 16 bytes</span>
<span class="w">		</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Update</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Message</span><span class="p">[</span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">			</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="c1">//finalize the computation and get the result</span>
<span class="w">	</span><span class="n">sw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHA256Final</span><span class="p">(</span><span class="o">&amp;</span><span class="n">MyCtx</span><span class="p">,</span><span class="w"> </span><span class="n">Digest</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sw</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SHA256_SUCCESS</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="c1">//compare the result</span>
<span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">SHA256_DIGEST_SIZE</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Digest</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ExpectedResult</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">			</span><span class="n">Error</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="p">}</span><span class="w"></span>
<span class="w">	</span><span class="p">}</span><span class="w"></span>

<span class="w">	</span><span class="c1">//final status of the test</span>
<span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Error</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">	</span><span class="k">else</span><span class="w"></span>
<span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="SHA224.html" class="btn btn-neutral float-left" title="SHA224" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SHA384.html" class="btn btn-neutral float-right" title="SHA384" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, EM.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>