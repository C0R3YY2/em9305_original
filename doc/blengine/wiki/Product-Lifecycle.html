

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Lifecycle &mdash; BLEngine 1.10.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=1d24b1d9"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/js/search.js?v=a5c8da7a"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Releases Notes" href="Releases-Notes.html" />
    <link rel="prev" title="HCI Device API" href="HCI-Device-API.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting-Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html">CLI Usage and options</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html#blengine-commands">Blengine Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html#python-module-usage">Python Module Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="NVM-Information.html">NVM Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="HCI-Device-API.html">HCI Device API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Product Lifecycle</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#procedures">Procedures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#restart">restart</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#power-cycle">power_cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nvm-dump">nvm_dump</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-firmware-headers">Read firmware headers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Releases-Notes.html">Releases Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/9304.html">9304 Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto/9305.html">9305 Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../packets.html">HCI Packets List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../procedures.html">BLEngine Procedures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/blengine.html">blengine package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BLEngine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Product Lifecycle</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="product-lifecycle">
<h1>Product Lifecycle<a class="headerlink" href="#product-lifecycle" title="Link to this heading"></a></h1>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<p>To ensure a proper integration of product lifecycle in BLEngine, an HCIEngine has implicit support for device mode through a <code class="docutils literal notranslate"><span class="pre">engine.enable_device_mode_support()</span></code> method, which will bind the startup events to the new device_mode attribute.</p>
<p>The dictionary <code class="docutils literal notranslate"><span class="pre">device_mode_events</span></code> shown below contains the list of events that are sent over the transport when the related mode is entered. It has to be mentioned that since the active mode means entering the end user application, this event might not be sent if it is not explicitely sent in this application.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device_mode_events</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ENTER_ACTIVE_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ENTER_CONFIGURATION_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ENTER_EMCORE_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;emcore&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ENTER_PRODUCTION_TESTS_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;prodtest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ENTER_BOOTLOADER_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;bootloader&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ENTER_EMSHI_MODE&quot;</span><span class="p">:</span> <span class="s2">&quot;emshi&quot;</span><span class="p">,</span>

<span class="p">}</span>
</pre></div>
</div>
<p>When a device is instructed to enter a specific mode, it is recommended to wait for the related event reception which will confirm that the device has actually entered the requested mode.</p>
<p>To achieve this, the HCiEngine now provides a new <code class="docutils literal notranslate"><span class="pre">engine.device_mode_event</span></code> threading Event, which can be used to wait on mode event easily as it is shown in the code snippet below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># clear the event state</span>
<span class="n">engine</span><span class="o">.</span><span class="n">device_mode_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="o">...</span> <span class="n">do</span> <span class="n">some</span> <span class="n">stuff</span> <span class="o">...</span>

<span class="c1"># wait 1 seconds for a startup event</span>
<span class="k">if</span> <span class="n">engine</span><span class="o">.</span><span class="n">device_mode_event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;got it ! now in mode : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">engine</span><span class="o">.</span><span class="n">device_mode</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;startup event missed&quot;</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="procedures">
<h2>Procedures<a class="headerlink" href="#procedures" title="Link to this heading"></a></h2>
<p>The procedures listed below are introduced along with the lifecycle control.</p>
<section id="restart">
<h3>restart<a class="headerlink" href="#restart" title="Link to this heading"></a></h3>
<p>Restart the device in any mode in the following values :</p>
<ul class="simple">
<li><p>default</p></li>
<li><p>active</p></li>
<li><p>emcore</p></li>
<li><p>bootloader</p></li>
<li><p>config</p></li>
</ul>
<section id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">restart</span> <span class="pre">--mode=config</span></code></p>
<p>The default start-up mode is to execute the end user application into the flash memory (it has to be programmed first). It is the so called <code class="docutils literal notranslate"><span class="pre">active</span></code> mode.</p>
<p>Usage in code :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">blengine.hci.procedures.EMSystem</span> <span class="kn">import</span> <span class="n">restart</span>

<span class="n">restart</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="power-cycle">
<h3>power_cycle<a class="headerlink" href="#power-cycle" title="Link to this heading"></a></h3>
<p>Power Cycle the device (DVK needed) with the following value : default, config</p>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">power_cycle</span> <span class="pre">--mode=config</span></code></p>
<p>This command will produce the following output:</p>
<p><img alt="Power cycle to config mode" src="../_images/blengine_power_cycle_config_mode.png" /></p>
<p>Note that the value is to start in active mode. In this mode, the main user application is started. Depending if it sends back the HCI “Active mode” event or not, the out of the following command…</p>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">power_cycle</span></code></p>
<p>…can end-up with the following result:</p>
<p><img alt="Power cycle to default mode" src="../_images/blengine_power_cycle_default_mode.png" /></p>
</section>
<section id="nvm-dump">
<h3>nvm_dump<a class="headerlink" href="#nvm-dump" title="Link to this heading"></a></h3>
<p>Dump the memory in a human readable format:</p>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">nvm_dump</span> <span class="pre">-h</span></code></p>
<p>The dump can be redirected to an output file like in this example:</p>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">nvm_dump</span> <span class="pre">--file=out_data.txt</span></code></p>
</section>
<section id="read-firmware-headers">
<h3>Read firmware headers<a class="headerlink" href="#read-firmware-headers" title="Link to this heading"></a></h3>
<p>It is possible to identify the firmware images stored in the flash memory. Since each firmware image has its own header stored along with its image, it is possible to scan the flash memory and display what is found with the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">blengine</span> <span class="pre">run</span> <span class="pre">get_fw_headers</span></code></p>
<p>A result example could be the following:</p>
<p><img alt="Read firmware headers" src="../_images/blengine_get_fw_headers.png" /></p>
<p>This example shows that the device flash memory contains one firmware image of type 3 (user application).
Even if the firmware image is programmed starting at address 0x302000, the entry point is located at address 0x302028. In between is located the image header that contains the exposed informations.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="HCI-Device-API.html" class="btn btn-neutral float-left" title="HCI Device API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Releases-Notes.html" class="btn btn-neutral float-right" title="Releases Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>