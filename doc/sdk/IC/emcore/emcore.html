<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>List of EM-Core Variants &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Sample Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">List of EM-Core Variants</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="list-of-em-core-variants">
<h1>List of EM-Core Variants<a class="headerlink" href="#list-of-em-core-variants" title="Link to this heading"></a></h1>
<p>This SDK provides a standard EM-Core configuration with the above listed built-in libraries.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">EM-Core Variant</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 37.5%" />
<col style="width: 62.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>standard</p></td>
<td><p>Standard Version of EM-Core</p></td>
</tr>
</tbody>
</table>
<p>Each <em>EM-Core</em> variant comes with an additional target which name contains the suffix <cite>_no_crc_check</cite> (e.g. <cite>emcore_standard_no_crc_check.ihex</cite>). Such variant includes the exact same functionalities than the variant without this suffix provides except that the image integrity (CRC check) is not verified at power on reset.</p>
<p>Depending on the lifecycle and production flow, CRC may be verified by other means. Therefore, this functionality may save boot time and energy in some specific contexts.</p>
<section id="custom-em-core">
<h2>Custom EM-Core<a class="headerlink" href="#custom-em-core" title="Link to this heading"></a></h2>
<p>Instead of using the provided default <em>EM-Core</em>, the end user has the possibility to build his/her own homebrewed <em>EM-Core</em> by adding new custom items or by removing uneeded items. This customized flavor can then be linked against the end user application to create the final application that relies onto this custom <em>EM-Core</em>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In case a customized <em>EM-Core</em> is created and used, it shall be programmed in the NVM along with the end user application that makes use of it. Even if the both the custom <em>EM-Core</em> flavor and the standard one have the same
source code, a standard <em>EM-Core</em> must not be mixed with a sample application designed to run with the custom flavor,
and inversely. In such a case of mixed configuration, the sample application might not be able to start.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The following picture shows the custom <em>EM-Core</em> folder in the SDK.</p>
<a class="reference internal image-reference" href="../../_images/EM-Core_custom_folder_content.png"><img alt="../../_images/EM-Core_custom_folder_content.png" class="align-center" src="../../_images/EM-Core_custom_folder_content.png" style="width: 1011.0px; height: 132.0px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The source code and all build configuration files are provided in the <code class="docutils literal notranslate"><span class="pre">emcore/custom</span></code> folder. The <code class="docutils literal notranslate"><span class="pre">emcore/bin</span></code> folder contains the standard default binary version provided in the SDK along with the <code class="docutils literal notranslate"><span class="pre">NVM_Bootloader</span></code>.</p>
<p>The <em>EM-Core</em> source code is located in both the <code class="docutils literal notranslate"><span class="pre">emcore/custom/includes</span></code> and in <code class="docutils literal notranslate"><span class="pre">emcore/custom/source</span></code> folders.
It corresponds to the standard default <em>EM-Core</em>.</p>
</section>
</section>
<section id="building-the-custom-em-core-flavor-distributed-in-the-sdk">
<h1>Building the custom <em>EM-Core</em> flavor distributed in the SDK<a class="headerlink" href="#building-the-custom-em-core-flavor-distributed-in-the-sdk" title="Link to this heading"></a></h1>
<p>To showcase how to build a custom <em>EM-Core</em> flavor, a custom version of <em>EM-Core</em> is provided within the SDK. Its name is <em>my_flavor</em>.</p>
<p>First run the command to create the build environment within the SDK:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;
$<span class="w"> </span>./init.bat
</pre></div>
</div>
<p>Then build this <em>EM-Core</em> flavor named <code class="docutils literal notranslate"><span class="pre">my_flavor</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>emcore_custom_my_flavor
</pre></div>
</div>
<p>After build, all files are installed within the following folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;sdk&gt;/emcore/bin/v4.1/my_flavor
</pre></div>
</div>
</section>
<section id="defining-a-custom-flavor">
<h1>Defining a custom flavor<a class="headerlink" href="#defining-a-custom-flavor" title="Link to this heading"></a></h1>
<p>Beyond using the <em>EM-Core</em> flavor provided in the SDK, the user has the possibility to create his own version of <em>EM-Core</em>. The following steps show how this can be done.</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">emcore/custom/custom_emcore_def.cmake</span></code> is where the name of the user flavor’s name is defined.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_FLAVORS</span><span class="w"> </span><span class="s">my_flavor:15</span><span class="p">)</span>
</pre></div>
</div>
<p>The name “<em>my_flavor</em>”” shall be replaced by any name relevant to the user defined configuration, with the exception to the “<em>standard</em>” name.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_FLAVORS</span><span class="w"> </span><span class="s">custom_flavor:1234</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="tweaking-the-cmake-file">
<h1>Tweaking the <code class="docutils literal notranslate"><span class="pre">.cmake</span></code> file<a class="headerlink" href="#tweaking-the-cmake-file" title="Link to this heading"></a></h1>
<p>The file <code class="docutils literal notranslate"><span class="pre">emcore/custom/custom_emcore.cmake</span></code> is the actual file that will be processed by <code class="docutils literal notranslate"><span class="pre">CMake</span></code> to create the custom <em>EM-Core</em>. This is also the place where the user can list his/her own source files and/or libraries.
Generally speaking, the user will tweak the content of this file to customize his/her own <em>EM-Core</em> flavor. This requires having a quite good knowledge of <code class="docutils literal notranslate"><span class="pre">CMake</span></code> files syntax, but nothing fancy here.</p>
<p>Any reference to the “<em>my_flavor</em>” pattern shall be changed to match with the user defined flavor’s name.</p>
<p>Let’s consider a new ‘<em>custom_flavor</em>’ version. The following statements shall be changed in the file.</p>
<p>First, set the name of the custom <em>EM-Core</em> library. This will define the name of the output file for this specific <em>EM-Core</em> in the <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;/build/emcore/custom</span></code> folder.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_LIBS</span>
<span class="w">   </span><span class="s">emcore_information_custom_flavor</span>
<span class="w">   </span><span class="c"># Add the libraries you want to include to your custom EM-Core</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Then, change the name of the variable that contains the list of header files to include:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_INCLUDES__custom_flavor</span>
<span class="w">   </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_INCLUDES_COMMON</span><span class="o">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Then, the variable that lists the libraries to link against shall also have its name changed for this flavor:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_LIBS__custom_flavor</span>
<span class="w">   </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_LIBS_COMMON</span><span class="o">}</span>
<span class="w">   </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_LIBS</span><span class="o">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that for all these modifications, only the suffix is changed:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">_my_flavor</span></code> ==&gt; <code class="docutils literal notranslate"><span class="pre">_custom_flavor</span></code></p>
</div></blockquote>
</section>
<section id="adding-a-missing-library">
<h1>Adding a missing library<a class="headerlink" href="#adding-a-missing-library" title="Link to this heading"></a></h1>
<p>Whenever the standard <em>EM-Core</em> does not contain a library that is needed, it can be easily added.</p>
<p>Let’s take the <cite>unitimer</cite> example to be added in a custom flavor of <em>EM-Core</em>. Still in the <code class="docutils literal notranslate"><span class="pre">custom_emcore.cmake</span></code> file, the include folder where the <code class="docutils literal notranslate"><span class="pre">unitimer</span></code> header file is located is introduced by adding it to the <code class="docutils literal notranslate"><span class="pre">CUSTOM_EMCORE_INCLUDES__custom_flavor</span></code> variable:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_INCLUDES__custom_flavor</span>
<span class="w">  </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_INCLUDES_COMMON</span><span class="o">}</span>
<span class="w">  </span><span class="o">${</span><span class="nv">LIBS_DIR</span><span class="o">}</span><span class="s">/unitimer/includes</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This statement is mandatory to get access to the <code class="docutils literal notranslate"><span class="pre">unitimer</span></code> header file.</p>
<p>Then, to successfully link the <em>EM-Core</em> with this library, the following statement shall be added in the variable <code class="docutils literal notranslate"><span class="pre">CUSTOM_EMCORE_LIBS__custom_flavor</span></code>:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">CUSTOM_EMCORE_LIBS__custom_flavor</span>
<span class="w">  </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_LIBS_COMMON</span><span class="o">}</span>
<span class="w">  </span><span class="o">${</span><span class="nv">CUSTOM_EMCORE_LIBS</span><span class="o">}</span>
<span class="w">  </span><span class="s">unitimer</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And that’s it. The next step is to build this <em>EM-Core</em> flavor as shown in the next step.</p>
</section>
<section id="building-the-em-core-custom-flavor">
<h1>Building the <em>EM-Core</em> custom flavor<a class="headerlink" href="#building-the-em-core-custom-flavor" title="Link to this heading"></a></h1>
<p>Re-execute the <em>init.bat</em> script to recreate the build environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;
$<span class="w"> </span>./init.bat
</pre></div>
</div>
<p>Note that this command will erase a previously built <code class="docutils literal notranslate"><span class="pre">build</span></code> folder. This step is mandatory to create the specific user defined <em>EM-Core</em> target so it can be built.</p>
<p>Then, building the <em>EM-Core</em> custom flavor is done by issuing the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>custom_emcore_custom_flavor
</pre></div>
</div>
<p>The target name starts with <code class="docutils literal notranslate"><span class="pre">custom_emcore_</span></code> and is followed by the name of the flavor to be built.</p>
</section>
<section id="building-the-application-and-linking-with-user-em-core">
<h1>Building the application and linking with user <em>EM-Core</em><a class="headerlink" href="#building-the-application-and-linking-with-user-em-core" title="Link to this heading"></a></h1>
<p>The last step to complete is to instruct the build system to link with the user defined <em>EM-Core</em> when building an app instead of linking with the standard one.</p>
<p>Let’s take the <code class="docutils literal notranslate"><span class="pre">nvm_emb_hrs</span></code> sample application as an example.</p>
<p>Looking at its <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file, the following lines are where the magic takes place:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">targets_emcore_flavor</span><span class="w"> </span><span class="s2">&quot;standard&quot;</span><span class="p">)</span>
<span class="nb">APP_IN_NVM</span><span class="p">()</span>
<span class="nb">ARC_EXECUTABLE</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">${PROJECT_NAME</span><span class="o">}</span><span class="s">_SRCS}</span><span class="p">)</span>
<span class="nb">ARC_LINK_LIBRARIES</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">${PROJECT_NAME</span><span class="o">}</span><span class="s">_LIBS}</span><span class="p">)</span>
<span class="nb">ARC_INCLUDE_DIRECTORIES</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">${PROJECT_NAME</span><span class="o">}</span><span class="s">_INCLUDES}</span><span class="p">)</span>
<span class="nb">GENERATE_EMCORE_APPLICATION</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="s">_emcore</span><span class="w"> </span><span class="s2">&quot;${targets_emcore_flavor}&quot;</span>
<span class="w">   </span><span class="s2">&quot;${${PROJECT_NAME}_SRCS}&quot;</span><span class="w"> </span><span class="s2">&quot;${${PROJECT_NAME}_INCLUDES}&quot;</span>
<span class="w">   </span><span class="s2">&quot;-DNO_FLINT_ERRORS&quot;</span>
<span class="w">   </span><span class="s2">&quot;${${PROJECT_NAME}_EMCORE_LIBS}&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>As it can be seen, the variable <code class="docutils literal notranslate"><span class="pre">targets_emcore_flavor</span></code> defines the <em>EM-Core</em> flavor that shall be used. The user defined flavor shall be written here instead of <em>standard</em>.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">SET</span><span class="p">(</span><span class="s">targets_emcore_flavor</span><span class="w"> </span><span class="s2">&quot;custom_flavor&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, the first parameter of the <code class="docutils literal notranslate"><span class="pre">GENERATE_EMCORE_APPLICATION</span></code> macro can be change to be more representative of the user define version of the application. Consequently, the suffix <em>_emcore</em> can be changed to something else. But this modification is not mandatory.</p>
<p>Then, the application can be built by issuing the following command in the SDK folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>nvm_emb_hrs_emcore
</pre></div>
</div>
<p>Note that this command instructs to build the new <em>EM-Core</em> flavor. But the exact version (or name) is specified within the <code class="docutils literal notranslate"><span class="pre">.cmake</span></code> file.</p>
<p>And that’s it!</p>
<p>The generated <em>EM-Core</em> is located in the <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;/build/emcore/custom</span></code> and the generated files are shown in the screenshot below:</p>
<a class="reference internal image-reference" href="../../_images/Custom_emcore_generated.png"><img alt="../../_images/Custom_emcore_generated.png" class="align-center" src="../../_images/Custom_emcore_generated.png" style="width: 569.0px; height: 287.0px;" /></a>
<p>In particular, the file <code class="docutils literal notranslate"><span class="pre">custom_emcore_custom_flavor_di05.ihex</span></code> is the one that shall be programmed in the NVM.</p>
<p>And the <code class="docutils literal notranslate"><span class="pre">nvm_emb_hrs_emcore</span></code> application that uses this custom flavor has been built in <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;/build/projects/nvm_emb_hrs</span></code> as shown in the following screenshot:</p>
<a class="reference internal image-reference" href="../../_images/nvm_emb_hrs_emcore_generated.png"><img alt="../../_images/nvm_emb_hrs_emcore_generated.png" class="align-center" src="../../_images/nvm_emb_hrs_emcore_generated.png" style="width: 564.0px; height: 223.0px;" /></a>
<p>Same as above, the <code class="docutils literal notranslate"><span class="pre">.ihex</span></code> file is the one to use to program in the NVM.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>