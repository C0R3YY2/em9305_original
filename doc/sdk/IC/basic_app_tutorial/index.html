<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic Application Tutorial &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Boot Selector" href="../boot_selector/index.html" />
    <link rel="prev" title="Miscellaneous Sample Applications" href="../examples/misc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Sample Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples/drivers.html">EM9305 Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bluetooth.html">Bluetooth Sample Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/firmware_update.html">Firmware Update Sample Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples/misc.html">Miscellaneous Sample Applications</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Basic Application Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#application-structure">Application structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#application-description-behavior">Application description behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-the-application">Building the application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-the-application">Programming the application</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../boot_selector/index.html">Boot Selector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bootloader/index.html">Bootloader example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emsas_example/index.html">EM System Application Specific (EMSAS) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_qpc_example/index.html">QPC example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_unit_test/index.html">Unit test example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../printf_example/index.html">Printf Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Examples.html">Sample Applications</a></li>
          <li class="breadcrumb-item"><a href="../examples/misc.html">Miscellaneous Sample Applications</a></li>
      <li class="breadcrumb-item active">Basic Application Tutorial</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="basic-application-tutorial">
<h1>Basic Application Tutorial<a class="headerlink" href="#basic-application-tutorial" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This application example shows how to integrate multiple drivers that are
running simultaneously in a QP/C driven environment.
It plays with GPIOs so that traces can be seen to show internal activity,
makes a periodic voltage sample triggered by a dedicated timer.
It shows how to create QP/C user signals that can be used in a real
time application.</p>
<p>Refer to the EM9305 Implementer’s guide for a comprehensive description of
this sample application.</p>
</section>
<section id="application-structure">
<h2>Application structure<a class="headerlink" href="#application-structure" title="Link to this heading"></a></h2>
<p>The source of this application is split in the following files:</p>
<ul class="simple">
<li><p>basic_app_tutorial.c
This is the main file that contains the so called <code class="docutils literal notranslate"><span class="pre">NVM_ConfigModules()</span></code>
and the <code class="docutils literal notranslate"><span class="pre">NVM_ApplicationEntry()</span></code> functions.</p></li>
<li><p>tasks.c
This file contains all functions related to QP/C. This includes functions
to create and activate tasks, the idle task as well and also the various
callbacks that are use throughout this application.</p></li>
<li><p>utils.c
This file contains functions to configure the GPIOs so GPIO6 and GPIO7 are
used for the UART and GPIO8 to GPIO10 are used as real GPIOs that can be
spied with a Salae or Digilent device.</p></li>
<li><p>nvm_main.h
This small header file is the nvm_main.c companion file. It contains function
prototypes with some GPIO definitions.</p></li>
<li><p>tasks.h
This file contains the user defined signal used in the frame of QP/C along with
some function prototypes.</p></li>
</ul>
<p>The C source files are gathered within the <code class="docutils literal notranslate"><span class="pre">src</span></code> directory while the header files
are stored within the <code class="docutils literal notranslate"><span class="pre">inc</span></code> folder just for the sake to avoid mixing up things.</p>
<p>The application is well commented so the code is quite self explanatory. It is
recommended to first analyze the file <code class="docutils literal notranslate"><span class="pre">nvm_main.c</span></code> content relying on the provided
comments.
Then, the <code class="docutils literal notranslate"><span class="pre">idleTask()</span></code> function located in the file <code class="docutils literal notranslate"><span class="pre">tasks.c</span></code> can be reviewed.
This is where all signals are processed so reading this code provides a good understanding
on how things work.</p>
</section>
<section id="application-description-behavior">
<h2>Application description behavior<a class="headerlink" href="#application-description-behavior" title="Link to this heading"></a></h2>
<p>The application uses a first periodic timer which calls the <code class="docutils literal notranslate"><span class="pre">timerCallback</span></code> every 100 ms.
In this callback, a user defined <code class="docutils literal notranslate"><span class="pre">APP_TIMER_SIG</span></code> is posted so it can be processed in the
idle task. When this signal is received, the GPIO9 is toggled.</p>
<p>A second periodic timer is created with a frequency of 1 Hz. Then, each second, the
<code class="docutils literal notranslate"><span class="pre">adcTimerCallback()</span></code> function is called. In this callback function, the user defined
<code class="docutils literal notranslate"><span class="pre">APP_ADC_TIMER_SIG</span></code> signal is sent. Like the timer signal, this signal is processed
in the idle task. When this happens, the GPIO8 is toggled and a single asynchronous ADC
sampling is started. Once done, the system can safely go to sleep mode.</p>
<p>When the ADC sampling is complete, the system wakes-up and the ADC callback function
<code class="docutils literal notranslate"><span class="pre">adcCallback()</span></code> is called. In this function, the user defined <code class="docutils literal notranslate"><span class="pre">APP_ADC_SIG</span></code> signal
is sent so it can be processed in the idle function. What is done in this case is reading
the actually sampled value which is sent over the UART.</p>
<p>And then all this mechanic is repeated forever.</p>
<p>Note that the two used timers are created once and reused over the time. To be able to achieve
this, the timer creation is done in the idle task when the QP/C signal <code class="docutils literal notranslate"><span class="pre">Q_ENTRY_SIG</span></code> is
received which happens only once at device startup.</p>
</section>
<section id="building-the-application">
<h2>Building the application<a class="headerlink" href="#building-the-application" title="Link to this heading"></a></h2>
<p>As usual with the SDK, building the application is straightforward.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;/build
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>basic_app_tutorial
</pre></div>
</div>
<p>The option <code class="docutils literal notranslate"><span class="pre">-v</span></code> can be appended to the above line to display the full
compilation and link instructions line. This is useful for debugging
purpose.</p>
</section>
<section id="programming-the-application">
<h2>Programming the application<a class="headerlink" href="#programming-the-application" title="Link to this heading"></a></h2>
<p>The generated <code class="docutils literal notranslate"><span class="pre">ihex</span></code> file can be programmed to the device by issuing on the terminal
windows a command similar to the one below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>blengine<span class="w"> </span>--port<span class="w"> </span>COM5<span class="w"> </span>--debug<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>projects<span class="se">\b</span>asic_app_tutorial<span class="se">\b</span>asic_app_tutorial.ihex
</pre></div>
</div>
<p>The COM port parameter needs to be customized to match the actual user installation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples/misc.html" class="btn btn-neutral float-left" title="Miscellaneous Sample Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../boot_selector/index.html" class="btn btn-neutral float-right" title="Boot Selector" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>