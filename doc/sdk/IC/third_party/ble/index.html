<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMB BLE stack &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Tiny printf (printf)" href="../printf/index.html" />
    <link rel="prev" title="&lt;no title&gt;" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../API.html#rom-apis">ROM APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../API.html#sdk-driver-apis">SDK Driver APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../API.html#sdk-libraries-apis">SDK Libraries APIs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../API.html#third-party-libraries-apis">Third Party Libraries APIs</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">EMB BLE stack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#change-log">Change Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#version-history">Version history</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-2-1-0">Version 2.1.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-2-0-0">Version 2.0.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-5-2">Version 1.5.2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-5-1">Version 1.5.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-5-0">Version 1.5.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-4-1">Version 1.4.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-4-0">Version 1.4.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-3-0">Version 1.3.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-1-0">Version 1.1.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-8">Version 1.0.8</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-7">Version 1.0.7</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-6">Version 1.0.6</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-5">Version 1.0.5</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-4">Version 1.0.4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-3">Version 1.0.3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-2">Version 1.0.2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-1">Version 1.0.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-1-0-0">Version 1.0.0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../printf/index.html">Tiny printf (printf)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../qpc/index.html">QPC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unit_test/index.html">Unity (unit_test)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usb/index.html">USB Driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Examples.html">Sample Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../API.html">API</a></li>
          <li class="breadcrumb-item"><a href="../index.html">&lt;no title&gt;</a></li>
      <li class="breadcrumb-item active">EMB BLE stack</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="emb-ble-stack">
<h1>EMB BLE stack<a class="headerlink" href="#emb-ble-stack" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>For more information related to the BLE configurations, please look at <code class="docutils literal notranslate"><span class="pre">libs\third_party\emb\cmake\configs.cmake</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">configs.cmake</span></code> shall not be modified. It is provided for information purpose and corresponds to the associated libraries.
An application shall always be compiled with the same configuration as the linked EMB libraries.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This version of the EMB library includes, in addition to the fully-featured stack, a proof of concept version of the stack
that supports only BLE advertisement using 3kB of PRAM.
The PoC is just step #1 of the BLE stack improvement activity and it should not directly be used until the final solution is provided.</p>
</div>
</section>
</section>
<section id="change-log">
<h1>Change Log<a class="headerlink" href="#change-log" title="Link to this heading"></a></h1>
<p>Porting version (EM versioning).</p>
</section>
<section id="version-history">
<h1>Version history<a class="headerlink" href="#version-history" title="Link to this heading"></a></h1>
<section id="version-2-2-0">
<h2>Version 2.2.0<a class="headerlink" href="#version-2-2-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Updating to Packetcraft “Mango” stack release.</p></li>
<li><p>Correct issue with Minimum Number of Used Channels LLCP for both the Central and Peripheral GAP roles.</p></li>
<li><p>New Constant Tone Extension Transmitter feature for Connection-Oriented and Connectionless modes.</p></li>
<li><p>Radio optimizations to improve timing for Periodic Advertising, PAwR, BIS and CIS use-cases.</p></li>
<li><p>New Constant Tone Extension Transmitter stack library and nvm_emb_assettag sample application added to SDK.</p></li>
<li><p>Bluetooth LE Qualification corrections for Constant Tone Extension feature and new qualification test-cases.</p></li>
<li><p>MISRA C Coding Style modifications to improve stack robustness.</p></li>
</ul>
</section>
<section id="version-2-1-0">
<h2>Version 2.1.0<a class="headerlink" href="#version-2-1-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>New EMB extension for a vendor-specific LL_ADV_COMPLETE_IND event (Legacy Advertising ONLY).</p></li>
<li><p>Modified the Wireless Software Framework (WSF) QPC implementation to allow customer use of the QF_onIdleExt() callbacks.</p></li>
<li><p>Removed the Preferred Periodicity check with Invalid Anchor Offset on a Connection Parameter update request (Apple Interoperability).</p></li>
<li><p>New EMB Lite API for legacy (BLE version 4.x) applications.</p></li>
</ul>
</section>
<section id="version-2-0-0">
<h2>Version 2.0.0<a class="headerlink" href="#version-2-0-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Update to “Margarita” based stack (Packetcraft Lime release + Select commits from Packetcraft Mango release)</p></li>
<li><p>Deprecated the <cite>bool_t</cite> type, replaced with standard <cite>bool</cite> type</p></li>
<li><p>Add new EMB extension for retrieving slave anchor time</p></li>
<li><p>Fixed a 1 second periodic wake-up caused by a routine in the LEPC feature</p></li>
<li><p>Various API changes for power related functions</p></li>
<li><p>Updated threshold range for LEPC feature</p></li>
</ul>
</section>
<section id="version-1-5-2">
<h2>Version 1.5.2<a class="headerlink" href="#version-1-5-2" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Isochronous qualification bugfixes (LL/CIS/CEN/BV-44, LL/CIS/PER/BV-28, LL/CIS/PER/BV-26, HCI/CIS/BV-14)</p></li>
<li><p>Internal test improvements (!7938, !6018, !7901, !8022)</p></li>
<li><p>Internal audio configuration library</p></li>
<li><p>EMSRC_SetRfPower fix range to -127 to 20</p></li>
<li><p>Enable the Conn Event Counter getter in the 7k stack</p></li>
<li><p>Added section for creating the new library with the new config in libs.cmake to HowToCreateNewLibraries doc</p></li>
<li><p>Removed extra call to LlExtAdvSlaveInit</p></li>
<li><p>Disable PTO for ISO broadcast</p></li>
<li><p>EMB LDRA static configuration</p></li>
<li><p>Allow to register a callback when WSF task starts.</p></li>
<li><p>Make NUM_WSF_TASK_EVENTS accessible to better size QPC event pool.</p></li>
<li><p>Added new Transmit Power Service to BLE Profile and Services.</p></li>
<li><p>Added EMB extension initialization for adding function pointer table for any extension APIs.</p></li>
<li><p>Removed addition of dm_pc.h and changes that were added to support the EMB Manual Power control API to dm_pc.c. Moved them to the emb extension file.</p></li>
</ul>
</section>
<section id="version-1-5-1">
<h2>Version 1.5.1<a class="headerlink" href="#version-1-5-1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Preserve packet processor CTE configuration in AOAD</p></li>
<li><p>Added API to enable the power management flag if the Set Transmit power with Enhanced Power Control disabled</p></li>
<li><p>Turn on PAL transmit power mgmt for Transmit and Receive test modes</p></li>
<li><p>Initialize prand module in PalCryptoInit</p></li>
</ul>
</section>
<section id="version-1-5-0">
<h2>Version 1.5.0<a class="headerlink" href="#version-1-5-0" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Added Bluetooth LE 4.2 legacy library version</p></li>
<li><p>Added EMB peripheral legacy Bluetooth configuration</p></li>
<li><p>Enable HCI support for HCI_LE_Request_Peer_SCA command</p></li>
<li><p>Remove HCI local supported Codec-related commands</p></li>
<li><p>Provide run-time configuration (enable/disable) for the BLE v5.2 Enhanced Power Control feature (By default, the feature is disabled)</p></li>
<li><p>Fixed bytes to bytes compatibility issues between host and controller structures</p></li>
<li><p>Improved sanity checks</p></li>
<li><p>Fixed bug regarding a divide by zero exception in the Power Control Module</p></li>
<li><p>Updates to configs</p></li>
<li><p>Re-enabling the SCA feature</p></li>
<li><p>Bug fixes for failing Harmony ISO tests</p></li>
<li><p>Code refactored for MISRA compliance</p></li>
<li><p>Added function to allow user changing dynamically Tx power in different modes when enhanced power control (LEPC feature) is disabled</p></li>
</ul>
</div></blockquote>
</section>
<section id="version-1-4-1">
<h2>Version 1.4.1<a class="headerlink" href="#version-1-4-1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>EMB database: add conditional compilation for CRC32 API change</p></li>
</ul>
</section>
<section id="version-1-4-0">
<h2>Version 1.4.0<a class="headerlink" href="#version-1-4-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>EMSRC_TransmitterTest - correct parameter validation checking</p></li>
<li><p>Add new radio test commands: EMSRC_ReceiverTestV2, EMSRC_ReceiverTestV3, EMSRC_TransmitterTestV2, and EMSRC_TransmitterTestV3</p></li>
</ul>
</section>
<section id="version-1-3-0">
<h2>Version 1.3.0<a class="headerlink" href="#version-1-3-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>EM System commands: adding support for EM vendor commands</p></li>
<li><p>Adding support for 4 connections</p></li>
<li><p>Applying the RNG SW workaround only for di01</p></li>
<li><p>Adding support for sleep mode</p></li>
<li><p>Fixing sleep clock accuracy value set with the value in the PML configuration</p></li>
<li><p>Qualification fix: converting keys to LSO format for EM crypto library</p></li>
<li><p>Correcting RF transmit ramp-up and path delay values in the PAL</p></li>
<li><p>Fixing pairing and radio gap issues</p></li>
<li><p>Fixing wrong TX output power and allow +6dBm</p></li>
<li><p>Updating copyright headers</p></li>
<li><p>Adapting to new CMake version</p></li>
<li><p>Correcting RX path delay for 2Mbits and Coded PHYs</p></li>
<li><p>Adding PAL baseband CTE support</p></li>
<li><p>Adding dynamic memory allocation in EM transport and EM system</p></li>
<li><p>Fixing PacketCraft update for HCI_LE_RECEIVE/TRANSMIT tests</p></li>
<li><p>Reordering field BbTimerBoundaryUsec</p></li>
<li><p>Fixing TXLen for CTE calculation</p></li>
<li><p>Changing Coded PHY delay value from 15us to 52us</p></li>
<li><p>Bringing up CTE Rx</p></li>
<li><p>Optimizing heap allocation</p></li>
<li><p>Adding fixes on mandatory features for BLE 5.3 qualification</p></li>
<li><p>Adding WSF IdleReady trigger for key generation</p></li>
<li><p>Refactoring function ’palCfgLoadBdAddress’</p></li>
<li><p>Adding support for buttons and LEDs</p></li>
<li><p>Integrating a new PacketCraft PAL library</p></li>
<li><p>Adding memory manager support for heap memory allocation</p></li>
<li><p>Removing uECC library from PacketCraft source</p></li>
<li><p>Remove LL transport resume after sleep if not initialized</p></li>
<li><p>Fixing MISRA sanity check failures</p></li>
<li><p>Splitting PacketCraft build system into core, ae, iso and CTE</p></li>
<li><p>Fixing controller core connection issue</p></li>
<li><p>Generating a peripheral &amp; broadcaster LL library to reduce NVM usage for FIT application</p></li>
<li><p>Changing BB_MAX_SWITCH_LEN (CTE) to 8</p></li>
<li><p>Adding HF XTAL clock activation in PAL initialization</p></li>
<li><p>Fixing packet interval calculation in DTM</p></li>
<li><p>Changing company ID from PacketCraft to EM in LL</p></li>
<li><p>Fixing broken links into PacketCraft documentation</p></li>
<li><p>Adding EMSRC_TransmitterTest and EMSRC_TransmitterTestEnd commands</p></li>
<li><p>Adding EMSRC_ReceiverTest and EMSRC_ReceiverTestEnd commands</p></li>
<li><p>Fixing missing SyncWord initializers for standard HCI DTM commands</p></li>
<li><p>Changing RX timeout from 2us to 3us on receive window</p></li>
<li><p>Reducing scanning stop delay when in shutdown state</p></li>
<li><p>Adding support for QP/C task creation and tast activation in WSF</p></li>
<li><p>Creating PRAM optimized advertizer</p></li>
<li><p>Applying SDK 1.0 bug fixes</p></li>
<li><p>Including support for +10dBm transmit output power</p></li>
<li><p>Adding scan report indicator event</p></li>
<li><p>Adding scan indication to 3K advertiser</p></li>
<li><p>Removing redundant call to RF_InitHW function in PAL layer</p></li>
<li><p>Completing documentation and standard libraries definition</p></li>
<li><p>Removing tags for DI specific HW libraries</p></li>
</ul>
</section>
<section id="version-1-1-0">
<h2>Version 1.1.0<a class="headerlink" href="#version-1-1-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Add command <code class="docutils literal notranslate"><span class="pre">Set_Rf_Power</span></code> to the list of EMB commands.</p></li>
</ul>
</section>
<section id="version-1-0-8">
<h2>Version 1.0.8<a class="headerlink" href="#version-1-0-8" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Update QPC version to v3.7.0</p></li>
</ul>
</section>
<section id="version-1-0-7">
<h2>Version 1.0.7<a class="headerlink" href="#version-1-0-7" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Add BLE build config that disables the automatic transmit power control feature.</p></li>
</ul>
</section>
<section id="version-1-0-6">
<h2>Version 1.0.6<a class="headerlink" href="#version-1-0-6" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Readded EMS Set Public Address command to the 7198 commands list and PC Command Parser</p></li>
</ul>
</section>
<section id="version-1-0-5">
<h2>Version 1.0.5<a class="headerlink" href="#version-1-0-5" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Fix race condition related to starting and stopping scanning where events would get lost causing application freezes.</p></li>
<li><p>Disable BLE Transmit Power Control from all BLE Stacks.</p></li>
</ul>
</section>
<section id="version-1-0-4">
<h2>Version 1.0.4<a class="headerlink" href="#version-1-0-4" title="Link to this heading"></a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>Updated the <code class="docutils literal notranslate"><span class="pre">lhciCmdVsExtInterfaceEM</span></code> implementation to allow registering of NULL callbacks, as some EM commands do not have a callback. The previous implementation would allow for arbitrary call of</dt><dd><p>the saved callback of the previous EM command.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="version-1-0-3">
<h2>Version 1.0.3<a class="headerlink" href="#version-1-0-3" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Updated the PoC version of the BLE stack to add support for peripheral device supporting connections, pairing, security and a custom sensor service,
consuming 7k of PRAM.</p></li>
</ul>
</section>
<section id="version-1-0-2">
<h2>Version 1.0.2<a class="headerlink" href="#version-1-0-2" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Packetcraft updated to version 22.10</p></li>
<li><p>Added a cut-down (or proof of concept) version of the BLE stack that supports only BLE advertisement using 3kB of PRAM.</p></li>
<li><p>Add support for +10 dBm transmit output power.</p></li>
</ol>
</section>
<section id="version-1-0-1">
<h2>Version 1.0.1<a class="headerlink" href="#version-1-0-1" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Packetcraft updated to version 22.06</p></li>
</ul>
</section>
<section id="version-1-0-0">
<h2>Version 1.0.0<a class="headerlink" href="#version-1-0-0" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Baseline of all drivers for 7198 at 1.0.0.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../printf/index.html" class="btn btn-neutral float-right" title="Tiny printf (printf)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>