<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bootloader example &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="EM System Application Specific (EMSAS) example" href="../nvm_emsas_example/index.html" />
    <link rel="prev" title="Boot Selector" href="../boot_selector/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Sample Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples/drivers.html">EM9305 Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/bluetooth.html">Bluetooth Sample Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/firmware_update.html">Firmware Update Sample Applications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples/misc.html">Miscellaneous Sample Applications</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../basic_app_tutorial/index.html">Basic Application Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boot_selector/index.html">Boot Selector</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Bootloader example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build">Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run">Run</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test">Test</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emsas_example/index.html">EM System Application Specific (EMSAS) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_qpc_example/index.html">QPC example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_unit_test/index.html">Unit test example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../printf_example/index.html">Printf Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Examples.html">Sample Applications</a></li>
          <li class="breadcrumb-item"><a href="../examples/misc.html">Miscellaneous Sample Applications</a></li>
      <li class="breadcrumb-item active">Bootloader example</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bootloader-example">
<h1>Bootloader example<a class="headerlink" href="#bootloader-example" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This sample application example shows how you can build your own customized bootloader in order to have a fine control over the device start-up process.</p>
<p>This example can be used as a baseline to extrapolate a custom bootloader that would fulfill different start-up requirements.</p>
<p>Moreover, this sample application has its own subset of commands. This can be reused as is or modified.</p>
<section id="emsystem-commands-available-in-the-bootloader">
<h3>EMSystem Commands available in the ‘Bootloader’<a class="headerlink" href="#emsystem-commands-available-in-the-bootloader" title="Link to this heading"></a></h3>
<p>The commands available in this sample application are listed below:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Bootloader Command Set</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EMSG_CpuReset</p></td>
<td><p>Issue a CPU reset</p></td>
</tr>
<tr class="row-odd"><td><p>EMSG_Read_Product_Information</p></td>
<td><p>Return some information about the device (RAW data)</p></td>
</tr>
<tr class="row-even"><td><p>EMSG_Set_Sleep_Options</p></td>
<td><p>Enable or disable sleep mode</p></td>
</tr>
<tr class="row-odd"><td><p>EMSG_Calculate_CRC32</p></td>
<td><p>Calculate the 32-bit CRC for the specified continuous address range</p></td>
</tr>
<tr class="row-even"><td><p>EMSG_Enter_Configuration_Mode</p></td>
<td><p>Enter Configuration Mode. A CPU reset operation is performed</p></td>
</tr>
<tr class="row-odd"><td><p>EMSG_Set_Boot_Mode_Flags</p></td>
<td><p>Set Boot Mode Flags</p></td>
</tr>
<tr class="row-even"><td><p>EMSG_Clear_Mode_Flags</p></td>
<td><p>Sets Boot Mode to default (bits are set to 0)</p></td>
</tr>
<tr class="row-odd"><td><p>EMSMM_Read_At_Address</p></td>
<td><p>Read one or more bytes at the given address</p></td>
</tr>
<tr class="row-even"><td><p>EMSMM_Read_Continue</p></td>
<td><p>Read one or more bytes beginning from where the previous read command ended</p></td>
</tr>
<tr class="row-odd"><td><p>EMSMM_Write_At_Address</p></td>
<td><p>Write one or more bytes at the given address</p></td>
</tr>
<tr class="row-even"><td><p>EMSMM_Write_Continue</p></td>
<td><p>Write one or more bytes beginning from where the previous write command ended</p></td>
</tr>
<tr class="row-odd"><td><p>EMSMM_NVM_Erase_Page</p></td>
<td><p>Perform a NVM Page Erase operation. It erases the page given in parameter</p></td>
</tr>
<tr class="row-even"><td><p>EMSMM_NVM_Get_Lock_Page</p></td>
<td><p>Get the lock status of a page in NVM</p></td>
</tr>
<tr class="row-odd"><td><p>EMSMM_NVM_Lock_Page</p></td>
<td><p>Lock a page in NVM</p></td>
</tr>
<tr class="row-even"><td><p>EMSMM_Write_At_Address_Without_Response</p></td>
<td><p>Write one or more bytes at the given address</p></td>
</tr>
<tr class="row-odd"><td><p>EMSMM_Write_Continue_Without_Response</p></td>
<td><p>rite one or more bytes beginning from where the previous write command ended</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Link to this heading"></a></h2>
<p>The build target of this example is:</p>
<ul class="simple">
<li><p><strong>bootloader</strong></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>bootloader
</pre></div>
</div>
</section>
<section id="run">
<h2>Run<a class="headerlink" href="#run" title="Link to this heading"></a></h2>
<p>To program and run the example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\b</span>ootloader<span class="se">\b</span>ootloader.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK.</p>
<p>Note that before going further and for being be able to execute this <cite>bootloader</cite>, the <cite>NVM_Bootloader</cite> shall be programmed at the beginning of the NVM if it has not already been done. This program is responsible to find and to verify the firmware images located in the NVM before actually running them.</p>
<p>To program the <cite>NVM_Bootloader</cite>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>../../emcore/bin/nvm_bootloader/nvm_bootloader_base.ihex
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be sure not to be confused between the sample application <cite>bootloader</cite> and the start-up application <cite>NVM_Bootloader</cite> even if both contain the same wording <em>bootloader</em> in their respective names. The <cite>NVM_Bootloader</cite> application is always needed to start any customer application and is always located at the beginning of the NVM. Its goal is to scan the NVM content to find valid firmware images, and then to execute one of them depending on the startup configuration.</p>
</div>
</section>
<section id="test">
<h2>Test<a class="headerlink" href="#test" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>--debug
</pre></div>
</div>
<p>With YY = the COM port number of your DVK.</p>
<p>Should see the ENTER_BOOTLOADER_MODE event when the BEN button on the DVK is pressed.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../boot_selector/index.html" class="btn btn-neutral float-left" title="Boot Selector" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nvm_emsas_example/index.html" class="btn btn-neutral float-right" title="EM System Application Specific (EMSAS) example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>