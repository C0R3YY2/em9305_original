<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heart Rate Service (HRS) example &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Resolvable Private Address (RPA) example" href="../nvm_emb_rpa/index.html" />
    <link rel="prev" title="FIT example" href="../nvm_emb_fit/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Sample Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples/drivers.html">EM9305 Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples/bluetooth.html">Bluetooth Sample Applications</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_controller/index.html">Bluetooth controller example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_datatransfer_server/index.html">EM EMB Data Transfer Server service Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_datatransfer_client/index.html">EM EMB Data Transfer Service Client Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_fit/index.html">FIT example</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Heart Rate Service (HRS) example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build">Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#program">Program</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test">Test</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_rpa/index.html">Resolvable Private Address (RPA) example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_tag/index.html">TagConnected example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_assettag/index.html">Asset Tag example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_ancs_client/index.html">ANCS Client Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_power_control/index.html">Tx Power Control Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_ext_adv/index.html">EM EMB Extended Advertisement Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_lite_hrs/index.html">Heart Rate Service EMB Lite Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_audio_control/index.html">LE Audio Control example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/firmware_update.html">Firmware Update Sample Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc.html">Miscellaneous Sample Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Examples.html">Sample Applications</a></li>
          <li class="breadcrumb-item"><a href="../examples/bluetooth.html">Bluetooth Sample Applications</a></li>
      <li class="breadcrumb-item active">Heart Rate Service (HRS) example</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="heart-rate-service-hrs-example">
<h1>Heart Rate Service (HRS) example<a class="headerlink" href="#heart-rate-service-hrs-example" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This sample application sets up the EM9305 as a heart rate monitor that periodically displays a simulated heart rate.</p>
<p>It exposes the following services:</p>
<ul class="simple">
<li><p>Heart Rate Service</p></li>
<li><p>Device Information Service</p></li>
<li><p>Battery Service</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This application has configurable SMP parameters <cite>smpCfg_t</cite> where <cite>minKeyLen</cite> can be specified. Reducing this value from 16 to 7 (minimum) reduces the entropy of the encryption key making the device less secure.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sample application also has added a feature which can be used for power optimization or to have control over exact count of advertisements that will be transmitted.
The feature enables an event back from the EM Bleu stack when each individual advertisement has occured. This can be enabled by changing the macro definition EN_ADV_COMPLETE_IND from 0 to 1.
The LL_ADV_COMPLETE_IND event gets routed from the stack to the BLE_HciVsEvtCback function.
When using the advDuration to set advertising duration, the EMB stack will trigger another wakeup to stop advertising after the advertising duration has expired.
Using this new event indication, the application can count specific number of advertisements and stop advertising as soon as the exact count of advertisements matches the total number that will be sent during the advDuration period.</p>
<p>There are no calls to support BLE security, thus no pairing or bonding. If you would like sample code that does include this, please refer to the nvm_emb_fit project.</p>
</div>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Link to this heading"></a></h2>
<p>The build target of this example is: <strong>nvm_emb_hrs</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>nvm_emb_hrs
</pre></div>
</div>
</section>
<section id="program">
<h2>Program<a class="headerlink" href="#program" title="Link to this heading"></a></h2>
<p>To program and run the example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\n</span>vm_emb_hrs<span class="se">\n</span>vm_emb_hrs.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK (optional if you set it in the file <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\tools\blengine\config.cfg</span></code>).</p>
</section>
<section id="test">
<h2>Test<a class="headerlink" href="#test" title="Link to this heading"></a></h2>
<p>To connect to the device, you need a smartphone with a BLE app installed. Typically, the LightBlue application is used for
the rest of this page.</p>
<p>When installed, open the application and start a BLE scan.
Find your device which name should be ‘EM9305_HRS’.</p>
<p>The following picture shows the HRS beacon among many other devices.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_scan.jpg"><img alt="HRS - Scan" class="align-center" src="../../_images/LightBlue_scan.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>Click on the device name. This shows up detailed information on the device.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_properties.jpg"><img alt="HRS - Properties" class="align-center" src="../../_images/LightBlue_properties.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>Click on CONNECT to connect to the device.
When connected, you can read some device informations and enable the notifications of some services.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_connected.jpg"><img alt="HRS - Connected" class="align-center" src="../../_images/LightBlue_connected.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>Once connected, scroll down until you see the Heart Rate service.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_heartrate.jpg"><img alt="HRS - Heartrate service" class="align-center" src="../../_images/LightBlue_heartrate.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>Then click on the ‘Heart Rate Measurement’ menu entry. This will give access to the underneath properties.
Thus, a ‘Subscribe’ button is displayed.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_subscription.jpg"><img alt="HRS - Subscription to heart rate service" class="align-center" src="../../_images/LightBlue_subscription.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>By clicking on this button, you can instruct the device to send the heart rate value on a periodic basis. The application
will then display this value each time it is updated.</p>
<a class="reference internal image-reference" href="../../_images/LightBlue_subscribed.jpg"><img alt="HRS - Receiving heart rate values" class="align-center" src="../../_images/LightBlue_subscribed.jpg" style="width: 256.0px; height: 568.0px;" /></a>
<p>In this application, the sent value is a fake one. It is just a counter that is incremented every second. But it helps showing
things up and running.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../nvm_emb_fit/index.html" class="btn btn-neutral float-left" title="FIT example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nvm_emb_rpa/index.html" class="btn btn-neutral float-right" title="Resolvable Private Address (RPA) example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>