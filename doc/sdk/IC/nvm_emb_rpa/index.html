<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resolvable Private Address (RPA) example &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="TagConnected example" href="../nvm_emb_tag/index.html" />
    <link rel="prev" title="Heart Rate Service (HRS) example" href="../nvm_emb_hrs/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Sample Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../examples/drivers.html">EM9305 Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../examples/bluetooth.html">Bluetooth Sample Applications</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_controller/index.html">Bluetooth controller example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_datatransfer_server/index.html">EM EMB Data Transfer Server service Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_datatransfer_client/index.html">EM EMB Data Transfer Service Client Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_fit/index.html">FIT example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_hrs/index.html">Heart Rate Service (HRS) example</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Resolvable Private Address (RPA) example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build">Build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#program-and-run">Program and Run</a></li>
<li class="toctree-l4"><a class="reference internal" href="#erase-the-bonding-database">Erase the Bonding Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test">Test</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_tag/index.html">TagConnected example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_assettag/index.html">Asset Tag example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_ancs_client/index.html">ANCS Client Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_power_control/index.html">Tx Power Control Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_ext_adv/index.html">EM EMB Extended Advertisement Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_lite_hrs/index.html">Heart Rate Service EMB Lite Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nvm_emb_audio_control/index.html">LE Audio Control example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/firmware_update.html">Firmware Update Sample Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/misc.html">Miscellaneous Sample Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sections/Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Examples.html">Sample Applications</a></li>
          <li class="breadcrumb-item"><a href="../examples/bluetooth.html">Bluetooth Sample Applications</a></li>
      <li class="breadcrumb-item active">Resolvable Private Address (RPA) example</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="resolvable-private-address-rpa-example">
<h1>Resolvable Private Address (RPA) example<a class="headerlink" href="#resolvable-private-address-rpa-example" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This example is designed to demostrate RPA functionality with device in peripheral role supporting connections, pairing, and security.
The application begins by advertising its identity address. After bonding, it advertises using an RPA (Resolvable Private Address).
The peripheral automatically requests the central to initiate bonding. Only one device is stored in the bonding database at a time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some versions of Android show the pairing dialog twice. This is due to a problem in Android when handling SMP Security Requests from a peripheral.</p>
</div>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Link to this heading"></a></h2>
<p>The build target of this example is: <strong>nvm_emb_rpa</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>nvm_emb_rpa
</pre></div>
</div>
</section>
<section id="program-and-run">
<h2>Program and Run<a class="headerlink" href="#program-and-run" title="Link to this heading"></a></h2>
<p>To program and run the example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\n</span>vm_emb_rpa<span class="se">\n</span>vm_emb_rpa.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK (optional if you set it in the file <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\tools\blengine\config.cfg</span></code>), and</p>
</section>
<section id="erase-the-bonding-database">
<h2>Erase the Bonding Database<a class="headerlink" href="#erase-the-bonding-database" title="Link to this heading"></a></h2>
<p>To erase the bonding database in NVM:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>send<span class="w"> </span>DVK_TARGET_HARD_RESET<span class="w"> </span>--mode<span class="o">=</span><span class="m">1</span>
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="w"> </span>COMYY<span class="w"> </span>send<span class="w"> </span>EMSMM_NVM_ERASE_PAGE<span class="w"> </span>--Area<span class="o">=</span><span class="m">1</span><span class="w"> </span>--Page<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="test">
<h2>Test<a class="headerlink" href="#test" title="Link to this heading"></a></h2>
<p>Program the firmware on a test device (DUT) in the <cite>Run</cite> step above. The DUT
will immediately start connectable advertising using a complete local name
as <cite>EM9305_RPA</cite>. Using a smartphone with the nrf connect app, the DUT
can be seen in the scanner tab in the image below.</p>
<p>The peer device can scan this device as shown in the image below,</p>
<a class="reference internal image-reference" href="../../_images/nrf_scanner.jpg"><img alt="nrf connect app on smartphone showing T9305_RPA DUT advertising :align: center" src="../../_images/nrf_scanner.jpg" style="width: 324.0px; height: 720.0px;" /></a>
<p>After a connection is made user can request for bonding.</p>
<a class="reference internal image-reference" href="../../_images/nrf_initiateBond.jpg"><img alt="nrf connect app on smartphone RPA Initiate bond :align: center" src="../../_images/nrf_initiateBond.jpg" style="width: 324.0px; height: 720.0px;" /></a>
<p>At this point the central may initiate just works pairing with the DUT.</p>
<a class="reference internal image-reference" href="../../_images/nrf_pairing.jpg"><img alt="nrf connect app pairing confirmation :align: center" src="../../_images/nrf_pairing.jpg" style="width: 324.0px; height: 720.0px;" /></a>
<p>Screenshot image after pairing has completed and services are discovered.</p>
<a class="reference internal image-reference" href="../../_images/nrf_services.jpg"><img alt="nrf connect app showing discovered services :align: center" src="../../_images/nrf_services.jpg" style="width: 324.0px; height: 720.0px;" /></a>
<p>Discovered services can be refreshed.</p>
<a class="reference internal image-reference" href="../../_images/nrf_refreshservices.jpg"><img alt="nrf connect app how to refresh discovered services :align: center" src="../../_images/nrf_refreshservices.jpg" style="width: 324.0px; height: 720.0px;" /></a>
<p>At this point, if the devices are disconnected, the DUT will use an RPA when
advertising again. Only the device who has the IRK exchanged during pairing is
able to resolve the DUT’s address. By default, the RPA will refresh every 5
minutes providing privacy against tracking by Bluetooth address.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../nvm_emb_hrs/index.html" class="btn btn-neutral float-left" title="Heart Rate Service (HRS) example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nvm_emb_tag/index.html" class="btn btn-neutral float-right" title="TagConnected example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>