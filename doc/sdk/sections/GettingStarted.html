<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; EM9305 4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=665bc78d" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=0cd558ae"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Migration guide" href="MigrationGuide.html" />
    <link rel="prev" title="emb Release Notes" href="../ReleaseNotes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo_h_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ReleaseNotes.html">emb Release Notes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design-iterations-di">Design iterations (di)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synopsys-metaware-installation">Synopsys MetaWare Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-setup">Hardware setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build">Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dvk-programming-monolithic-binary-image">DVK programming - Monolithic binary image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dvk-programming-em-core-and-user-application-binary-images">DVK programming - EM-Core and User application binary images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-the-debugger">Use the debugger</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MigrationGuide.html">Migration guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="IDEIntegration.html">MetaWare IDE Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMakeBuild.html">CMake and build procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="rom.html">ROM Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bluetooth.html">Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IC/emcore/index.html">EM-Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="FirmwareUpdate.html">Firmware Update</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lifecycle.html">EM9305 Lifecycle Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IC/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IC/Examples.html">Sample Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="Links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="ApplicationNotes.html">Application Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="HowTo.html">How to</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Limitations.html">Known limitations &amp; constraints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EM9305</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h1>
<p>This section provides the first level of information the user needs to get started on how
to use the SDK to design and to develop his own end application running on the EM9305 chip.</p>
<p>It covers the following topics:</p>
<ul class="simple">
<li><p>the list of tools and their installation</p></li>
<li><p>the hardware setup and some recommendations on the DVK</p></li>
<li><p>how to build an application example</p></li>
<li><p>how to program and run an application example on the DVK</p></li>
</ul>
<p>This SDK’s documentation comes along with the <a class="reference external" href="../../app_notes/EM9305_SoC_ImplementersGuide_v2.1.pdf">Implementer’s Guide</a> document. Both provide comprehensive technical detailed information that help the end user to get started.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h2>
<p><strong>Platform</strong></p>
<p>The SDK is designed to be installed on a 64 bits Windows© 10 or newer host computer.</p>
<p><strong>Software:</strong></p>
<ul class="simple">
<li><p>CMake 3.19 or later version</p></li>
<li><p>Python 3.8 to 3.11 (64 bit ONLY)</p></li>
<li><p>For debugging: Digilent Adept for using the Digilent JTAG</p></li>
<li><p>Metaware Synopsys toolchain for ARC EM7D</p></li>
<li><p>BLEngine tool (refer to <a class="reference external" href="../../blengine/index.html">BLEngine documentation</a>)</p></li>
<li><p>ccache (optional) Speeds up local builds and used automatically if it is on the PATH. For more information, see <a class="reference external" href="https://ccache.dev/">https://ccache.dev/</a>.</p></li>
</ul>
<p><strong>Hardware:</strong></p>
<ul class="simple">
<li><p>DVK full</p></li>
<li><p>Reference design with SMA antenna or with PCB antenna</p></li>
<li><p>Digilent JTAG (optional, for debugging purpose)</p></li>
</ul>
</section>
<section id="design-iterations-di">
<h2>Design iterations (di)<a class="headerlink" href="#design-iterations-di" title="Link to this heading"></a></h2>
<p>The EM9305 IC is improved over the time. This results in the creation of new design
iterations for one or more of the following reasons occur:</p>
<ul class="simple">
<li><p>silicon bug fix</p></li>
<li><p>function improvement in the silicon</p></li>
<li><p>new added function</p></li>
<li><p>new ROM version</p></li>
</ul>
<p>By default, the SDK builds an application for the latest design iteration.</p>
<p>For backward compatibility, this SDK can also be used to build for earlier design iterations (di04, di03). In this case, the correct design iteration must be specified when building the application. See the Implementer’s Guide for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The design iteration refers to a particular version of the silicon. A new design iteration may be issued to fix existing bugs and/or to add new hardware features. Thus, a design iteration integrates a ROM containing the startup code. This code may evolve over the time as bug fixes and/or new features are added. When this happens, a new design iteration is issued.
Consequently, ROM versions and design iterations are linked in such a way that a new ROM version means a new design iteration. However, a new design iteration does not always mean a new ROM version.</p>
</div>
</section>
<section id="synopsys-metaware-installation">
<h2>Synopsys MetaWare Installation<a class="headerlink" href="#synopsys-metaware-installation" title="Link to this heading"></a></h2>
<p>To be able to compile and debug software for the EM9305, you will need to install MetaWare Development Toolkit
for ARC processor cores ⩾ 2019.09.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently the full MetaWare license is necessary. The size of some examples exceeds the limit of MetaWare Lite.</p>
</div>
<p>EM-Microelectronic is also providing a dedicated version based on the 2022.09 version coming along with its own
customized licence. This version does not have any limitation on the size of the compiled code and does not need
to setup a dedicated license server.
To get this version, please contact your EM-Microelectronic representative.</p>
<p>You can order and download a limited Metaware toolchain version here:</p>
<p><a class="reference external" href="https://www.synopsys.com/dw/ipdir.php?ds=sw_metaware">MetaWare Development Toolkit</a></p>
<p>During the installation, you will be asked what you would like to install:</p>
<a class="reference internal image-reference" href="../_images/MW_install.png"><img alt="MetaWare Installation" class="align-center" src="../_images/MW_install.png" style="width: 501.2px; height: 198.79999999999998px;" /></a>
<p>Select the 3 first components:</p>
<ul class="simple">
<li><p>DesignWare ARC MetaWare Compiler</p></li>
<li><p>DesignWare ARC MetaWare Debugger</p></li>
<li><p>DesignWare ARC MetaWare Development Toolkit</p></li>
</ul>
</section>
<section id="hardware-setup">
<h2>Hardware setup<a class="headerlink" href="#hardware-setup" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your DVK is likely already programmed! You can skip this step unless you wish
to update the DVK firmware. Current firmware is found under
<code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\tools\dvk\EM9305_DVK_v1.4.0.bin</span></code></p>
</div>
<p>The picture below shows the DVK equipped with an EM9305 chip mounted on a reference design.
It also shows the jumpers configuration that shall be set to ensure that the DVK is properly working.
This picture also shows where to connect the mini-USB type connector and how the JTAG connector shall
be also connected on its dedicated port (if available and for debug purpose only).</p>
<p>On central connector (GPIO connector), connect at least jumpers 00 to 05 (SPI slave interface + configuration mode entry) and EN.</p>
<a class="reference internal image-reference" href="../_images/EM9305_DVK_v002.jpg"><img alt="EM9305 DVK" class="align-left" src="../_images/EM9305_DVK_v002.jpg" style="width: 604.8px; height: 453.59999999999997px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The D+(07) and D-(06) jumpers need to be connected to use GPIO6 and GPIO7.
The antenna is not connected on the picture.</p>
</div>
<p>The configuration is step-down.</p>
<p>The DVK has to be programmed and needs to be switched to programming mode.
To do so, maintain the ISP button pressed and click on the RESET button.
A new disk is now available on your computer.
You can now copy/paste the BIN file (EM9305_DVK_v1.4.0.bin) located in <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\tools\dvk</span></code> to this disk.</p>
<p>Then click the RESET button to go back to standard mode.</p>
</section>
<section id="build">
<h2>Build<a class="headerlink" href="#build" title="Link to this heading"></a></h2>
<p>Once the SDK has been installed, the next step is to create the build environment by executing the <code class="docutils literal notranslate"><span class="pre">init.bat</span></code>
script from a terminal (for example Windows PowerShell, Cmder, MobaXterm, Terminus, …). This process shall be
done at least once on a fresh SDK installation and relies on the use of CMake tool.</p>
<p>For having this process easier, a dedicated script is provided:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.<span class="se">\i</span>nit.bat
</pre></div>
</div>
<p>When run, this script creates a <code class="docutils literal notranslate"><span class="pre">build</span></code> folder, initializes the cmake build system and generates all the files
needed to build any application. All the generated files are stored within this <code class="docutils literal notranslate"><span class="pre">build</span></code> folder.</p>
<p>Then to build any target, the built process shall be done from inside the generated <code class="docutils literal notranslate"><span class="pre">build</span></code> folder.</p>
<p>By default, the CMake process will automatically try to find the path to the Metaware toolchain. For that, it
looks for the <code class="docutils literal notranslate"><span class="pre">ccac</span></code> (Linux) or <code class="docutils literal notranslate"><span class="pre">ccac.exe</span></code> (Windows) in the <code class="docutils literal notranslate"><span class="pre">PATH</span></code> variable which is user or system wide.
If a version of the Metaware toolchain has previously been installed, the process should be able to find it.</p>
<p>In order to compile all the examples (all the targets):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>all
</pre></div>
</div>
<p>If you want to compile one example only, you can run the cmake command with the specified target.</p>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>printf_example
</pre></div>
</div>
<p>For a comprehensive list of targets:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span><span class="nb">help</span>
</pre></div>
</div>
<p>It is possible to redirect the list of targets into a file like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\b</span>uild
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span><span class="nb">help</span><span class="w"> </span>&gt;<span class="w"> </span>targets_list.txt
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the targets using the transport, if no extension is given (no _uart) the SPI transport is used.</p>
</div>
<p>Once this is built, in the folder <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\build\projects\printf_example</span></code>, an Intel hex file corresponding to the target binary
should be present (printf_example.ihex). This file is the one to be programmed in the NVM.</p>
</section>
<section id="dvk-programming-monolithic-binary-image">
<h2>DVK programming - Monolithic binary image<a class="headerlink" href="#dvk-programming-monolithic-binary-image" title="Link to this heading"></a></h2>
<p>You first need to connect the DVK full and check which COM port is opened.</p>
<p>A python script is available in <code class="docutils literal notranslate"><span class="pre">tools\blengine</span></code> to program the previously generated hex file to the EM9305 flash.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\p</span>rintf_example<span class="se">\p</span>rintf_example.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">EM9305</span> <span class="pre">Lifecycle</span> <span class="pre">Control</span></code> tab for information about all lifecycle operations.
It describes mechanisms to program NVM memory as well as NVM Info Pages.
It also describes a mechanism to reboot in various modes</p>
</div>
<p>After the execution of this script, the EM9305 is reset and the program should be running.
In this example (printf_example), the GPIO7 should print the value of a counter every seconds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>printf_example</cite> will use GPIO7 as a UART transmit pin with a default baudrate of 115,200 baud. You will need to
connect a 3.3V UART TTL adapter to the UART header Pin #2. There is no need to connect to the UART receive pin #3
given that the UART since in this example, any incoming character on this pin is discarded.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your application uses GPIO 0-5 not for SPI slave communication, the DVK SPI transport has to be disabled.
It’s possible to do that automatically after programming by using the <code class="docutils literal notranslate"><span class="pre">--spi_disable</span></code> option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\p</span>rintf_example<span class="se">\p</span>rintf_example.ihex<span class="w"> </span>--progress<span class="w"> </span>--spi_disable
</pre></div>
</div>
</div>
</section>
<section id="dvk-programming-em-core-and-user-application-binary-images">
<h2>DVK programming - EM-Core and User application binary images<a class="headerlink" href="#dvk-programming-em-core-and-user-application-binary-images" title="Link to this heading"></a></h2>
<p>Unlike the monolithic binary image that was programmed above, another option is to program an EM-Core binary image into NVM,
which provides all EM software functions for a customer application. The customer application is linked against the EM-Core
symbol file. Thus, the customer application will be much smaller in size compared to the monolithic binary image.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The customer application must link to the desired EM-Core symbol table. And the EM-Core binary image must be programmed into the EM9305 NVM.</p>
</div>
<p>You first need to connect the DVK full and check which COM port is opened.</p>
<p>Prior to programming this EM-Core, the <cite>NVM_bootloader</cite> image shall be programmed first if not already done. This can be achieved by issuing the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\e</span>mcore<span class="se">\b</span>in<span class="se">\n</span>vm_bootloader<span class="se">\n</span>vm_bootloader_base.ihex
</pre></div>
</div>
<p>This small firmware is programmed at the beginning of the NVM and fits in the first NVM page. It is directly called by the
device boot sequence at startup or when resuming from a sleep period.
This NVM-Bootloader is responsible for starting up any available firmware images stored in the NVM by checking these
images integrity through a CRC check and by starting the right image based on the device configuration.</p>
<p>Then the EM-Core ihex file can be programmed in flash memory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\e</span>mcore<span class="se">\b</span>in<span class="se">\v</span>A.B.C<span class="se">\s</span>tandard<span class="se">\e</span>mcore_standard.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK and A.B.C = the version of EM-Core.</p>
<p>Note that the location from which the two above mentionned commands are issued is the folder where the Python script blengine_cli.py resides.</p>
<p>In the following example, the DVK can be accessed through the com port COM5:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COM5<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\e</span>mcore<span class="se">\b</span>in<span class="se">\v</span>A.B.C<span class="se">\s</span>tandard<span class="se">\e</span>mcore_standard.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>The next step is to program the end user application, or an application example. In the following example, the EMB FIT application example is programmed
into the NVM by using the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\b</span>lengine
python<span class="w"> </span>blengine_cli.py<span class="w"> </span>--port<span class="o">=</span>COMYY<span class="w"> </span>run<span class="w"> </span>emsystem_prog<span class="w"> </span>..<span class="se">\.</span>.<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\n</span>vm_emb_fit<span class="se">\n</span>vm_emb_fit_emcore.ihex<span class="w"> </span>--progress
</pre></div>
</div>
<p>With YY = the COM port number of your DVK.</p>
<p>Note that the application used as an example here is named <code class="docutils literal notranslate"><span class="pre">nvm_emb_fit_emcore.ihex</span></code>. This application precludes that the
version of EM-Core against which it has been linked is already programmed in the NVM. The iHex file does neither embed any
version of EM-Core nor any low level driver already part of the pre-installed EM-Core image. The file name containing ’emcore’
means that this application has been built and linked against EM-Core, not that it embeds a version of EM-Core.</p>
<p>After the execution of this script, the EM9305 is reset and the program starts running.</p>
</section>
<section id="use-the-debugger">
<h2>Use the debugger<a class="headerlink" href="#use-the-debugger" title="Link to this heading"></a></h2>
<p>Compile and program the software you want to debug. Then connect the JTAG connector on the JTAG socket.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The sleep mode must be disabled to be able to debug.
At top of the <cite>nvm_main.c</cite> file, you need to include the global PML Configuration data structure as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;pml.h&quot;</span><span class="c1">;</span>
</pre></div>
</div>
<p>In NVM_ConfigModules function, switching to the sleep mode can be disabled by setting the corresponding flag:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">NVM_ConfigModules</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="c1">// Prevent the system from switching to sleep mode</span>
<span class="w">  </span><span class="n">gPML_Config</span><span class="p">.</span><span class="n">sleepModeForbiden</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The JTAG must be enabled to be able to debug (by default it is disabled).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">NVM_ConfigModules</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="c1">// Enable JTAG.</span>
<span class="w">  </span><span class="n">GPIO_EnableJtag4Wires</span><span class="p">();</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>A batch script let you start the debugger:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;sdk&gt;<span class="se">\t</span>ools<span class="se">\d</span>ebug
.<span class="se">\d</span>ebug.bat<span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>sdk&gt;<span class="se">\b</span>uild<span class="se">\p</span>rojects<span class="se">\p</span>rintf_example<span class="se">\p</span>rintf_example.elf
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameter (path to the elf file) can be a relative path. However, on some installation, this might not work.
In such a case, the absolute path shall be provided (<code class="docutils literal notranslate"><span class="pre">C:\SDK\…</span></code>).</p>
</div>
<p>You should then be able to set breakpoints and run the program in the debugger.</p>
<p>Since it is unfortunately not possible to use the debugger when the sleep mode is enabled, debugging while this mode shall be kept enabled can be done by using the printf library to send debug messages over the serial line at application runtime (refer to <code class="docutils literal notranslate"><span class="pre">&lt;sdk&gt;\projects\printf_example</span></code> for detailed information).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When connecting to the device using the debugger through the JTAG probe, one might experience a
connection failure. If this happens, repeat this operation. It should work then.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ReleaseNotes.html" class="btn btn-neutral float-left" title="emb Release Notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MigrationGuide.html" class="btn btn-neutral float-right" title="Migration guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, EM Microelectronic.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>